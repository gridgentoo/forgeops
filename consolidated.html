<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ForgeOps Documentation :: ForgeRock DevOps Documentation</title>
    <link rel="canonical" href="https://ea.forgerock.com/docs/forgeops/forgeops/consolidated.html">
    <meta name="generator" content="Antora 2.3.1">
    <link rel="stylesheet" href="https://cdn.forgerock.com/docs-ui/adoc/dev/vendor.antora-styles.css">
    <link rel="stylesheet" href="https://cdn.forgerock.com/docs-ui/adoc/dev/forgerock.antora-styles.css">
  </head>
  <body class="article">
<backstage-site-header active-item="docs"></backstage-site-header>
<div class="body">
<div class="nav-container" data-component="forgeops" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">ForgeOps</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-text  nav-item-toggle">Read This First</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    
    <a class="nav-link" href="start/start-here.html">Start Here</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    
    <a class="nav-link" href="start/start-here-skills.html">Assess Your Skill Level</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="forgeops.html">About the <code>forgeops</code> Repository (Pre-Release)</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <span class="nav-text  nav-item-toggle">Cloud Developer's Kit (CDK)</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="cdk/overview.html">Overview</a>
    
  </li>
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="cdk/intro.html">About the CDK</a>
    
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text  nav-item-toggle">CDK Architecture</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    
    <a class="nav-link" href="cdk/minikube/concepts.html">On Minikube</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    
    <a class="nav-link" href="cdk/cloud/concepts.html">On a Shared Cluster</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text  nav-item-toggle">Environment Setup</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-item-toggle">
    <a class="nav-link" href="cdk/minikube/setup/overview.html">Minikube</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    
    <a class="nav-link" href="cdk/minikube/setup/forgeops.html"><code>forgeops</code> Repository</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    
    <a class="nav-link" href="cdk/minikube/setup/sw.html">Third-Party Software</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    
    <a class="nav-link" href="cdk/minikube/setup/vm.html">Minikube Virtual Machine</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    
    <a class="nav-link" href="cdk/minikube/setup/namespace.html">Namespace</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    
    <a class="nav-link" href="cdk/minikube/setup/hostname.html">Hostname Resolution</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    
    <a class="nav-link" href="cdk/minikube/setup/docker.html">Minikube&#8217;s Docker Engine</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-item-toggle">
    <a class="nav-link" href="cdk/cloud/setup/overview.html">Shared Cluster</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <span class="nav-text  nav-item-toggle">GKE</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/gke/forgeops.html"><code>forgeops</code> Repository</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/gke/sw.html">Third-Party Software</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/gke/clusterinfo.html">Cluster Details</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/gke/context.html">Context for the Shared Cluster</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/gke/namespace.html">Namespace</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/gke/hostname.html">Hostname Resolution</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/gke/docker.html"><code>docker push</code> Setup</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text  nav-item-toggle">EKS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/eks/forgeops.html"><code>forgeops</code> Repository</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/eks/sw.html">Third-Party Software</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/eks/clusterinfo.html">Cluster Details</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/eks/context.html">Context for the Shared Cluster</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/eks/namespace.html">Namespace</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/eks/hostname.html">Hostname Resolution</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/eks/docker.html"><code>docker push</code> Setup</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text  nav-item-toggle">AKS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/aks/forgeops.html"><code>forgeops</code> Repository</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/aks/sw.html">Third-Party Software</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/aks/clusterinfo.html">Cluster Details</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/aks/context.html">Context for the Shared Cluster</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/aks/namespace.html">Namespace</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/aks/hostname.html">Hostname Resolution</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdk/cloud/setup/aks/docker.html"><code>docker push</code> Setup</a>
    
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="cdk/deploy.html">Deployment</a>
    
  </li>
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="cdk/access.html">UI and API Access</a>
    
  </li>
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="cdk/develop.html">Custom Docker Image Development</a>
    
  </li>
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="cdk/troubleshoot.html">CDK Troubleshooting</a>
    
  </li>
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="cdk/shutdown.html">Shutdown and Removal</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <span class="nav-text  nav-item-toggle">Cloud Deployment Model (CDM)</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="cdm/overview.html">Overview</a>
    
  </li>
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="cdm/intro.html">About the CDM</a>
    
  </li>
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="cdm/architecture.html">CDM Architecture</a>
    
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text  nav-item-toggle">CDM Cookbook</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-text  nav-item-toggle">Environment Setup</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <span class="nav-item-toggle">
    <a class="nav-link" href="cdm/gke/setup/setup-env.html">GKE</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/gke/setup/sw.html">Third-Party Software</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/gke/setup/project.html">Google Cloud Project Setup</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/gke/setup/forgeops.html"><code>forgeops</code> Repository</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/gke/setup/cluster.html">Kubernetes Cluster Creation</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/gke/setup/secret-agent.html">Secret Agent Operator</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/gke/setup/nginx.html">NGINX Ingress Controller</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/gke/setup/cert-manager.html">Certificate Manager</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/gke/setup/prometheus.html">Prometheus, Grafana, and Alertmanager</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/gke/setup/push.html"><span class="command"><code>docker push</code></span> Setup</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-item-toggle">
    <a class="nav-link" href="cdm/eks/setup/setup-env.html">EKS</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/eks/setup/architecture.html">Architecture Overview</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/eks/setup/sw.html">Third-Party Software</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/eks/setup/aws-env.html">AWS Environment Setup</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/eks/setup/forgeops.html"><code>forgeops</code> Repository</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/eks/setup/cluster.html">Kubernetes Cluster Creation</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/eks/setup/secret-agent.html">Secret Agent Operator</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/eks/setup/nginx.html">NGINX Ingress Controller</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/eks/setup/cert-manager.html">Certificate Manager</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/eks/setup/prometheus.html">Prometheus, Grafana, and Alertmanager</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/eks/setup/push.html"><span class="command"><code>docker push</code></span> Setup</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-item-toggle">
    <a class="nav-link" href="cdm/aks/setup/setup-env.html">AKS</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/aks/setup/sw.html">Third-Party Software</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/aks/setup/subscription.html">Azure Subscription Setup</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/aks/setup/forgeops.html"><code>forgeops</code> Repository</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/aks/setup/cluster.html">Kubernetes Cluster Creation</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/aks/setup/secret-agent.html">Secret Agent Operator</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/aks/setup/nginx.html">NGINX Ingress Controller</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/aks/setup/cert-manager.html">Certificate Manager</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/aks/setup/prometheus.html">Prometheus, Grafana, and Alert Manager</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    
    <a class="nav-link" href="cdm/aks/setup/push.html"><span class="command"><code>docker push</code></span> Setup</a>
    
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    
    <a class="nav-link" href="cdm/deploy.html">CDM Deployment</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    
    <a class="nav-link" href="cdm/access.html">UI and API Access</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text  nav-item-toggle">CDM Removal</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    
    <a class="nav-link" href="cdm/gke/remove.html">GKE</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    
    <a class="nav-link" href="cdm/eks/remove.html">EKS</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    
    <a class="nav-link" href="cdm/aks/remove.html">AKS</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    
    <a class="nav-link" href="cdm/next-steps.html">Next Steps</a>
    
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <span class="nav-text  nav-item-toggle">Deployment Topics</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="deployment/overview.html">Overview</a>
    
  </li>
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="deployment/base-docker-images.html">Base Docker Images</a>
    
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text  nav-item-toggle">Backup and Restore</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    
    <a class="nav-link" href="deployment/backup-restore.html">Overview</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text  nav-item-toggle">Cloud Storage Setup</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    
    <a class="nav-link" href="deployment/backup/gcs-backup.html">On Google Cloud</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    
    <a class="nav-link" href="deployment/backup/aws-backup.html">On AWS</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    
    <a class="nav-link" href="deployment/backup/azure-backup.html">On Azure</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    
    <a class="nav-link" href="deployment/backup/backup-schedule.html">Enable DS Backup Schedules</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    
    <a class="nav-link" href="deployment/backup/backup-restore.html">CDM Automatic Restore</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="deployment/monitoring.html">Monitoring</a>
    
  </li>
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="deployment/security.html">Security</a>
    
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text  nav-item-toggle">CDM Benchmarks</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    
    <a class="nav-link" href="deployment/benchmark/overview.html">Overview</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    
    <a class="nav-link" href="deployment/benchmark/intro.html">About CDM Benchmarking</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    
    <a class="nav-link" href="deployment/benchmark/sw.html">Third-Party Software</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    
    <a class="nav-link" href="deployment/benchmark/testusers.html">Test User Generation</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    
    <a class="nav-link" href="deployment/benchmark/authrate.html">Authentication Rate</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    
    <a class="nav-link" href="deployment/benchmark/oauth2.html">OAuth 2.0 Authorization Code Flow</a>
    
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="rn/rn.html">DevOps Release Notes</a>
    
  </li>
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="glossary.html">Glossary</a>
    
  </li>
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="support.html">Support From ForgeRock</a>
    
  </li>
  <li class="nav-item" data-depth="1">
    
    <a class="nav-link" href="legal.html">Legal Notices</a>
    
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">ForgeOps</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">ForgeOps</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">

  <div class="content">
<article class="doc">
<h1 class="page">ForgeOps Documentation</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>ForgeRock provides a number of resources to help you get started in the cloud.
These resources demonstrate how to deploy the ForgeRock Identity Platform on Kubernetes.</p>
</div>
<div class="paragraph">
<p>The ForgeRock Identity Platform serves as the basis for our simple and comprehensive
identity and access management solution. We help our customers deepen their
relationships with their customers, and improve the productivity and
connectivity of their employees and partners. For more information about
ForgeRock and about the platform, see <a href="https://www.forgerock.com" class="bare">https://www.forgerock.com</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="start_here"><a class="anchor" href="#start_here"></a>Start Here</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ForgeRock provides several resources to help you get started in the cloud. These
resources demonstrate how to deploy the ForgeRock Identity Platform on Kubernetes. Before
you proceed, review the following precautions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deploying ForgeRock software in a containerized environment requires advanced
proficiency in many technologies.
See <a href="start/start-here-skills.html" class="page">Assess Your Skill Level</a> for details.</p>
</li>
<li>
<p>If you don&#8217;t have experience with complex Kubernetes deployments, then either
engage a certified ForgeRock consulting partner or deploy the platform on
traditional architecture.</p>
</li>
<li>
<p>Don&#8217;t deploy ForgeRock software in Kubernetes in production until you have
successfully deployed and tested the software in a non-production Kubernetes
environment.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For information about obtaining support for ForgeRock Identity Platform software,
see <a href="support.html" class="page">Support From ForgeRock</a>.</p>
</div>
<div class="sect2">
<h3 id="introducing_the_cdk_and_cdm"><a class="anchor" href="#introducing_the_cdk_and_cdm"></a>Introducing the CDK and CDM</h3>
<div class="paragraph">
<p>The <a href="https://github.com/ForgeRock/forgeops.git">forgeops repository</a> and DevOps
documentation address a range of our customers' typical business needs. The
repository contains artifacts for two primary resources to help you with cloud
deployment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Cloud Developer&#8217;s Kit (CDK)</strong>. The CDK is a minimal sample deployment
for development purposes. Developers deploy the CDK, and then access
AM&#8217;s and IDM&#8217;s GUI consoles and REST APIs to configure the
platform and build customized Docker images for the platform.</p>
</li>
<li>
<p><strong>Cloud Deployment Model (CDM)</strong>. The CDM is a reference implementation
for ForgeRock cloud deployments. You can get a sample ForgeRock Identity Platform deployment
up and running in the cloud quickly using the CDM. After deploying the
CDM, you can use it to explore how you might configure your Kubernetes
cluster before you deploy the platform in production.</p>
<div class="paragraph">
<p>The CDM is a robust sample deployment for demonstration and exploration
purposes only. <em>It is not a production deployment</em>.</p>
</div>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">CDK</th>
<th class="tableblock halign-left valign-top">CDM</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Fully integrated AM, IDM, and DS installations</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&#x2714;</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&#x2714;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Randomly generated secrets</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&#x2714;</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&#x2714;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Resource requirement</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Namespace in a GKE, EKS, AKS, or Minikube cluster</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Dedicated GKE, EKS, or AKS cluster</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Can run on Minikube</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&#x2714;</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Multi-zone high availability</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&#x2714;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Replicated directory services</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&#x2714;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Ingress configuration</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&#x2714;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Certificate management</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&#x2714;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Prometheus monitoring, Grafana reporting, and alert management</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&#x2714;</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>ForgeRock&#8217;s DevOps documentation helps you deploy the CDK and CDM:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><a href="cdk/overview.html" class="page">Cloud Developer&#8217;s Kit Documentation</a></strong>.
Tells you how to install the CDK, modify the AM and IDM
configurations, and create customized Docker images for the ForgeRock Identity Platform.</p>
</li>
<li>
<p><strong><a href="cdm/overview.html" class="page">Cloud Deployment Model Documentation</a></strong>.
Tells you how to quickly create a Kubernetes cluster on Google Cloud, Amazon
Web Services (AWS), or Microsoft Azure, install the ForgeRock Identity Platform, and access
components in the deployment.</p>
</li>
<li>
<p><strong><a href="deployment/overview.html" class="page">Deployment Topics Documentation</a></strong>.
Contains how-tos for customizing monitoring, setting alerts, backing up and
restoring directory data, modifying CDM&#8217;s default security configuration,
and running lightweight benchmarks to test DS, AM, and IDM
performance.</p>
</li>
<li>
<p><strong><a href="rn/rn.html" class="page">DevOps Release Notes</a></strong>.
Keeps you up-to-date with the latest changes to the <code>forgeops</code> repository.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="poc"><a class="anchor" href="#poc"></a>Try Out the CDK and the CDM</h3>
<div class="paragraph">
<p>Before you start planning a production deployment, deploy either the CDK
or the CDM&#x2014;or both. If you&#8217;re new to Kubernetes, or new to the
ForgeRock Identity Platform, deploying these resources is a great way to learn. When
you&#8217;ve finished deploying them, you&#8217;ll have sandboxes suitable for exploring
ForgeRock cloud deployment.</p>
</div>
<div class="sect3">
<h4 id="deploy_the_cdk"><a class="anchor" href="#deploy_the_cdk"></a>Deploy the CDK</h4>
<div class="imageblock">
<div class="content">
<img src="_images/start-cdk.png" alt="Illustrates the major tasks performed to get the ${cdk.abbr} running as a sample environment.">
</div>
</div>
<div class="paragraph">
<p>The CDK is a minimal sample deployment of the ForgeRock Identity Platform. If you
have access to a cluster on Google Cloud, EKS, or AKS, you can install the
CDK in a namespace on your cluster. But even if you don&#8217;t have access to
a cloud-based cluster, you can still deploy the CDK on a local computer
running Minikube, and when you&#8217;re done, you&#8217;ll have a namespace on a local
Kubernetes cluster with the ForgeRock Identity Platform.</p>
</div>
<div class="paragraph">
<p>Prerequisite technologies and skills:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="start/start-here-skills.html#skills-git" class="page">Git</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-docker" class="page">Docker</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-cdk-kubernetes" class="page">Kubernetes, running on Google Cloud, AWS, or Azure</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="cdk/overview.html" class="page">Cloud Developer&#8217;s Kit Documentation</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="cdm-sandbox"><a class="anchor" href="#cdm-sandbox"></a>Deploy the CDM</h4>
<div class="imageblock">
<div class="content">
<img src="_images/start-cdm.png" alt="Illustrates the major tasks performed to deploy the ${cdm.abbr}.">
</div>
</div>
<div class="paragraph">
<p>Deploy the CDM on Google Cloud, AWS, or Microsoft Azure to quickly spin
up the platform for demonstration purposes. You&#8217;ll get a feel for what
it&#8217;s like to deploy the platform on a Kubernetes cluster in the cloud.
When you&#8217;re done, you won&#8217;t have a production-quality deployment. But you will
have a robust, reference implementation of the platform.</p>
</div>
<div class="paragraph">
<p>After you get the CDM up and running, you can use it to test
deployment customizations&#x2014;options that you might want to use in production,
but are not part of the CDM. Examples include, but are not limited to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Running lightweight benchmark tests</p>
</li>
<li>
<p>Making backups of CDM data, and restoring the data</p>
</li>
<li>
<p>Securing SSL with a certificate that&#8217;s dynamically obtained from Let&#8217;s Encrypt</p>
</li>
<li>
<p>Using an ingress controller other than the NGINX ingress controller</p>
</li>
<li>
<p>Resizing the cluster to meet your business requirements</p>
</li>
<li>
<p>Configuring Alert Manager to issue alerts when usage thresholds have been
reached</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Prerequisite technologies and skills:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="start/start-here-skills.html#skills-git" class="page">Git</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-cdm-cloud-provider" class="page">Google Cloud, AWS, or Azure</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-cdk-kubernetes" class="page">Kubernetes, running on Google Cloud, AWS, or Azure</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="cdm/overview.html" class="page">Cloud Deployment Model Documentation</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="build_your_own_service"><a class="anchor" href="#build_your_own_service"></a>Build Your Own Service</h3>
<div class="imageblock">
<div class="content">
<img src="_images/dg-start-overview.png" alt="Illustrates the major tasks performed when building a production deployment of ${platform.name} in the cloud.">
</div>
</div>
<div class="paragraph">
<p>Perform the following activities to customize, deploy, and maintain a production
ForgeRock Identity Platform implementation in the cloud:</p>
</div>
<div class="sect3">
<h4 id="planning"><a class="anchor" href="#planning"></a>Create a Project Plan</h4>
<div class="imageblock">
<div class="content">
<img src="_images/start-plan.png" alt="Illustrates the major tasks performed when planning a production deployment of ${platform.name} in the cloud.">
</div>
</div>
<div class="paragraph">
<p>After you&#8217;ve spent some time <a href="#poc">exploring the CDK and CDM</a>,
you&#8217;re ready to define requirements for your production deployment.
<em>Remember, the CDM is not a production deployment</em>.
Use the CDM to explore deployment customizations, and incorporate the
lessons you&#8217;ve learned as you build your own production service.</p>
</div>
<div class="paragraph">
<p>Analyze your business requirements and define how the ForgeRock Identity Platform needs to
be configured to meet your needs. Identify systems to be integrated with the
platform, such as identity databases and applications, and plan to perform
those integrations. Assess and specify your deployment infrastructure requirements,
such as backup, system monitoring, Git repository management, CI/CD, quality
assurance, security, and load testing.</p>
</div>
<div class="paragraph">
<p>Prerequisite technologies and skills:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="start/start-here-skills.html#skills-proj-plan" class="page">Project planning and management</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-git" class="page">Git</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-docker" class="page">Docker</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-prod-cloud-provider" class="page">Google Cloud, AWS, or Azure</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-prod-kubernetes" class="page">Kubernetes, running on Google Cloud, AWS, or Azure</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-platform" class="page">ForgeRock Identity Platform</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-integration" class="page">Applications and databases that you plan to integrate
with ForgeRock Identity Platform</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-cicd" class="page">CI/CD for a production deployment in the cloud</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-integration-test" class="page">Integration testing</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-security" class="page">Deployment hardening and security</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-benchmarking" class="page">Benchmarking and load testing</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-sr" class="page">Site reliability</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="index.html" class="page">All the DevOps documentation</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="configure-platform"><a class="anchor" href="#configure-platform"></a>Configure the Platform</h4>
<div class="imageblock">
<div class="content">
<img src="_images/start-config-platform.png" alt="Illustrates the major tasks performed to configure the ${platform.name} before deploying in production.">
</div>
</div>
<div class="paragraph">
<p>With your <a href="#planning">project plan defined</a>, you&#8217;re
ready to configure the ForgeRock Identity Platform to meet the plan&#8217;s requirements.
Install the CDK on your developers' computers. Configure AM
and IDM. If needed, include integrations with external applications in
the configuration. Iteratively unit test your configuration as you modify it.
Build customized Docker images that contain the configuration.</p>
</div>
<div class="paragraph">
<p>Prerequisite technologies and skills:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="start/start-here-skills.html#skills-platform" class="page">ForgeRock Identity Platform</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-git" class="page">Git</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-prod-kubernetes" class="page">Kubernetes, running on Google Cloud, AWS, or Azure</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-docker" class="page">Docker</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="cdk/overview.html" class="page">Cloud Developer&#8217;s Kit Documentation</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="configure-cluster"><a class="anchor" href="#configure-cluster"></a>Configure Your Cluster</h4>
<div class="imageblock">
<div class="content">
<img src="_images/start-config-cluster.png" alt="Illustrates the major tasks performed to configure the cluster before deploying in production.">
</div>
</div>
<div class="paragraph">
<p>With your <a href="#planning">project plan defined</a>, you&#8217;re ready to
configure a Kubernetes cluster that meets the requirements defined in the plan.
Install the platform using the customized Docker images developed in
<a href="#configure-platform">Configure the Platform</a>.
Provision the ForgeRock identity repository with users, groups, and other
identity data. Load test your deployment, and then size your cluster to meet
service level agreements. Perform integration tests. Harden your deployment.
Set up CI/CD for your deployment. Create monitoring alerts so that your site
reliability engineers are notified when the system reaches thresholds that affect
your SLAs. Implement database backup and test database restore. Simulate failures
while under load to make sure your deployment can handle them.</p>
</div>
<div class="paragraph">
<p>Prerequisite technologies and skills:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="start/start-here-skills.html#skills-prod-cloud-provider" class="page">Google Cloud, AWS, or Azure</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-git" class="page">Git</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-prod-kubernetes" class="page">Kubernetes, running on Google Cloud, AWS, or Azure</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-platform" class="page">ForgeRock Identity Platform</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-cicd" class="page">CI/CD for a production deployment in the cloud</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-integration-test" class="page">Integration testing</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-security" class="page">Deployment hardening and security</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-benchmarking" class="page">Benchmarking and load testing</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-sr" class="page">Site reliability</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="deployment/overview.html" class="page">Deployment Topics Documentation</a></p>
</li>
<li>
<p><a href="cdm/overview.html" class="page">Cloud Deployment Model Documentation</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="stay_up_and_running"><a class="anchor" href="#stay_up_and_running"></a>Stay Up and Running</h4>
<div class="imageblock">
<div class="content">
<img src="_images/start-sr.png" alt="Illustrates the major tasks performed to keep a ${platform.name} deployment up and running in production.">
</div>
</div>
<div class="paragraph">
<p>By now, you&#8217;ve <a href="#configure-platform">configured the platform</a>,
<a href="#configure-cluster">configured a Kubernetes cluster,
and deployed the platform with your customized configuration</a>.
Run your ForgeRock Identity Platform deployment in your cluster, continually monitoring it
for performance and reliability. Take backups as needed.</p>
</div>
<div class="paragraph">
<p>Prerequisite technologies and skills:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="start/start-here-skills.html#skills-git" class="page">Git</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-prod-cloud-provider" class="page">Google Cloud, AWS, or Azure</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-prod-kubernetes" class="page">Kubernetes, running on Google Cloud, AWS, or Azure</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-platform" class="page">ForgeRock Identity Platform</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-cicd" class="page">CI/CD for a production deployment in the cloud</a></p>
</li>
<li>
<p><a href="start/start-here-skills.html#skills-sr" class="page">Site reliability</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="deployment/overview.html" class="page">Deployment Topics Documentation</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assess_your_skill_level"><a class="anchor" href="#assess_your_skill_level"></a>Assess Your Skill Level</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="skills-benchmarking"><a class="anchor" href="#skills-benchmarking"></a>Benchmarking and Load Testing</h3>
<div class="paragraph">
<p>I can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Write performance tests, using tools such as Gatling and Apache JMeter, to
ensure that the system meets required performance thresholds and service level
agreements (SLAs).</p>
</li>
<li>
<p>Resize a Kubernetes cluster, taking into account performance test results,
thresholds, and SLAs.</p>
</li>
<li>
<p>Run Linux performance monitoring utilities, such as <span class="command"><code>top</code></span>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="skills-cicd"><a class="anchor" href="#skills-cicd"></a>CI/CD for Cloud Deployments</h3>
<div class="paragraph">
<p>I have experience:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Designing and implementing a CI/CD process for a cloud-based deployment
running in production.</p>
</li>
<li>
<p>Using a cloud CI/CD tool, such as Tekton, Google Cloud Build, Codefresh,
AWS CloudFormation, or Jenkins, to implement a CI/CD process for a cloud-based
deployment running in production.</p>
</li>
<li>
<p>Integrating GitOps into a CI/CD process.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="skills-docker"><a class="anchor" href="#skills-docker"></a>Docker</h3>
<div class="paragraph">
<p>I know how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Write Dockerfiles.</p>
</li>
<li>
<p>Create Docker images, and push them to a private Docker registry.</p>
</li>
<li>
<p>Pull and run images from a private Docker registry.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>I understand:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The concepts of Docker layers, and building images based on other Docker
images using the <span class="command"><code>FROM</code></span> instruction.</p>
</li>
<li>
<p>The difference between the <span class="command"><code>COPY</code></span> and <span class="command"><code>ADD</code></span>
instructions in a Dockerfile.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="skills-git"><a class="anchor" href="#skills-git"></a>Git</h3>
<div class="paragraph">
<p>I know how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use a Git repository collaboration framework, such as GitHub, GitLab, or
Bitbucket Server.</p>
</li>
<li>
<p>Perform common Git operations, such as cloning and forking repositories,
branching, committing changes, submitting pull requests, merging, viewing logs,
and so forth.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="skills-integration"><a class="anchor" href="#skills-integration"></a>External Application and Database Integration</h3>
<div class="paragraph">
<p>I have expertise in:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>AM policy agents.</p>
</li>
<li>
<p>Configuring AM policies.</p>
</li>
<li>
<p>Synchronizing and reconciling identity data using IDM.</p>
</li>
<li>
<p>Managing cloud databases.</p>
</li>
<li>
<p>Connecting ForgeRock Identity Platform components to cloud databases.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="skills-platform"><a class="anchor" href="#skills-platform"></a>ForgeRock Identity Platform</h3>
<div class="paragraph">
<p>I have:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Attended ForgeRock University training courses.</p>
</li>
<li>
<p>Deployed the ForgeRock Identity Platform in production, and kept the deployment highly
available.</p>
</li>
<li>
<p>Configured DS replication.</p>
</li>
<li>
<p>Passed the ForgeRock Certified Access Management and ForgeRock Certified
Identity Management exams (highly recommended).</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="skills-cdm-cloud-provider"><a class="anchor" href="#skills-cdm-cloud-provider"></a>Google Cloud, AWS, or Azure (Basic)</h3>
<div class="paragraph">
<p>I can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the graphical user interface for Google Cloud, AWS, or Azure to navigate,
browse, create, and remove Kubernetes clusters.</p>
</li>
<li>
<p>Use the cloud provider&#8217;s tools to monitor a Kubernetes cluster.</p>
</li>
<li>
<p>Use the command user interface for Google Cloud, AWS, or Azure.</p>
</li>
<li>
<p>Administer cloud storage.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="skills-prod-cloud-provider"><a class="anchor" href="#skills-prod-cloud-provider"></a>Google Cloud, AWS, or Azure (Expert)</h3>
<div class="paragraph">
<p>In addition to the <a href="#skills-cdm-cloud-provider">basic skills for Google Cloud,
AWS, or Azure</a>, I can</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Read the cluster creation shell scripts in the <code>forgeops</code> repository to see
how the CDM cluster is configured.</p>
</li>
<li>
<p>Create and manage a Kubernetes cluster using an infrastructure-as-code tool
such as Terraform, AWS CloudFormation, or Pulumi.</p>
</li>
<li>
<p>Configure multi-zone and multi-region Kubernetes clusters.</p>
</li>
<li>
<p>Configure cloud-provider identity and access management (IAM).</p>
</li>
<li>
<p>Configure virtual private clouds (VPCs) and VPC networking.</p>
</li>
<li>
<p>Manage keys in the cloud using a service such as Google Key Management Service
(KMS), Amazon KMS, or Azure Key Vault.</p>
</li>
<li>
<p>Configure and manage DNS domains on Google Cloud, AWS, or Azure.</p>
</li>
<li>
<p>Troubleshoot a deployment running in the cloud using the cloud provider&#8217;s
tools, such as Google Stackdriver, Amazon CloudWatch, or Azure Monitor.</p>
</li>
<li>
<p>Integrate a deployment with certificate management tools, such as cert-manager
and Let&#8217;s Encrypt.</p>
</li>
<li>
<p>Integrate a deployment with monitoring and alerting tools, such as Prometheus
and Alertmanager.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>I have obtained one of the following certifications (highly recommended):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Google Certified Associate Cloud Engineer Certification.</p>
</li>
<li>
<p>AWS professional-level or associate-level certifications (multiple).</p>
</li>
<li>
<p>Azure Administrator.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="skills-integration-test"><a class="anchor" href="#skills-integration-test"></a>Integration Testing</h3>
<div class="paragraph">
<p>I can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Automate QA testing using a test automation framework.</p>
</li>
<li>
<p>Design a chaos engineering test for a cloud-based deployment running in
production.</p>
</li>
<li>
<p>Use chaos engineering testing tools, such as Chaos Monkey.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="skills-cdk-kubernetes"><a class="anchor" href="#skills-cdk-kubernetes"></a>Kubernetes (Basic)</h3>
<div class="paragraph">
<p>I&#8217;ve gone through the tutorials at kubernetes.io, and am able to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the <span class="command"><code>kubectl</code></span> command to determine the status of all the pods
in a namespace, and to determine whether pods are operational.</p>
</li>
<li>
<p>Use the <span class="command"><code>kubectl describe pod</code></span> command to perform basic
troubleshooting on pods that are not operational.</p>
</li>
<li>
<p>Use the <span class="command"><code>kubectl</code></span> command to obtain information about namespaces,
secrets, deployments, and stateful sets.</p>
</li>
<li>
<p>Use the <span class="command"><code>kubectl</code></span> command to manage persistent volumes and
persistent volume claims.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="skills-prod-kubernetes"><a class="anchor" href="#skills-prod-kubernetes"></a>Kubernetes (Expert)</h3>
<div class="paragraph">
<p>In addition to the <a href="#skills-cdk-kubernetes">basic skills for Kubernetes</a>, I
have:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configured role-based access to cloud resources.</p>
</li>
<li>
<p>Configured Kubernetes objects, such as deployments and stateful sets.</p>
</li>
<li>
<p>Configured Kubernetes ingresses.</p>
</li>
<li>
<p>Passed the Cloud Native Certified Kubernetes Administrator exam (highly
recommended).</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="skills-proj-plan"><a class="anchor" href="#skills-proj-plan"></a>Project Planning and Management for Cloud Deployments</h3>
<div class="paragraph">
<p>I have planned and managed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A production deployment in the cloud.</p>
</li>
<li>
<p>A production deployment of ForgeRock Identity Platform.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="skills-security"><a class="anchor" href="#skills-security"></a>Security and Hardening for Cloud Deployments</h3>
<div class="paragraph">
<p>I can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Harden a ForgeRock Identity Platform deployment.</p>
</li>
<li>
<p>Configure TLS, including mutual TLS, for a multi-tiered cloud deployment.</p>
</li>
<li>
<p>Configure cloud identity and access management and role-based access control
for a production deployment.</p>
</li>
<li>
<p>Configure encryption for a cloud deployment.</p>
</li>
<li>
<p>Configure Kubernetes pod security and network security policies.</p>
</li>
<li>
<p>Configure private Kubernetes networks, deploying bastion servers as needed.</p>
</li>
<li>
<p>Undertake threat modeling exercises.</p>
</li>
<li>
<p>Scan Docker images to ensure container security.</p>
</li>
<li>
<p>Configure and use private Docker container registries.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="skills-sr"><a class="anchor" href="#skills-sr"></a>Site Reliability Engineering for Cloud Deployments</h3>
<div class="paragraph">
<p>I can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Manage multi-zone and multi-region deployments.</p>
</li>
<li>
<p>Implement DS backup and restore in order to recover from a database
failure.</p>
</li>
<li>
<p>Manage cloud disk availability issues.</p>
</li>
<li>
<p>Analyze monitoring output and alerts, and respond should a failure occur.</p>
</li>
<li>
<p>Obtain logs from all the software components in my deployment.</p>
</li>
<li>
<p>Follow the cloud provider&#8217;s recommendations for patching and upgrading
software in my deployment.</p>
</li>
<li>
<p>Implement an upgrade scheme, such as blue/green or rolling upgrades, in my
deployment.</p>
</li>
<li>
<p>Create a Site Reliability Runbook for the deployment, documenting all the
procedures to be followed and other relevant information.</p>
</li>
<li>
<p>Follow all the procedures in the project&#8217;s Site Reliability Runbook, and
revise the runbook if it becomes out-of-date.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="about_the_forgeops_repository_pre_release"><a class="anchor" href="#about_the_forgeops_repository_pre_release"></a>About the <code>forgeops</code> Repository (Pre-Release)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use ForgeRock&#8217;s <a href="https://github.com/ForgeRock/forgeops.git"><code>forgeops</code> repository</a>
to customize and deploy the ForgeRock Identity Platform on a Kubernetes cluster.</p>
</div>
<div class="paragraph">
<p>The repository contains files needed for customizing and deploying the
ForgeRock Identity Platform on a Kubernetes cluster:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Files used to build Docker images for the ForgeRock Identity Platform:</p>
<div class="ulist">
<ul>
<li>
<p>Dockerfiles</p>
</li>
<li>
<p>Scripts and configuration files incorporated into ForgeRock&#8217;s Docker images</p>
</li>
<li>
<p>Canonical configuration profiles for the platform</p>
</li>
</ul>
</div>
</li>
<li>
<p>Kustomize bases and overlays</p>
</li>
<li>
<p>Skaffold configuration files</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, the repository contains numerous utility scripts and sample files.
The scripts and samples are useful for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deploying ForgeRock&#8217;s CDM quickly and easily</p>
</li>
<li>
<p>Exploring monitoring, alerts, and security customization</p>
</li>
<li>
<p>Modeling a CI/CD solution for cloud deployment</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#forgeops-reference">Repository Reference</a> for information about the files in the repository,
recommendations about how to work with them, and the support status for the
files.</p>
</div>
<div class="sect2">
<h3 id="forgeops-updates"><a class="anchor" href="#forgeops-updates"></a>Repository Updates</h3>
<div class="paragraph">
<p>From time to time, ForgeRock tags the <code>forgeops</code> repository. Each tag marks a
new release of the repository, with enhancements and bug fixes.</p>
</div>
<div class="paragraph">
<p>The current release tag is <code>2020.10.28-AlSugoDiNoci</code>.</p>
</div>
<div class="paragraph">
<p>When you start working with the <code>forgeops</code> repository:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone the <code>forgeops</code> repository.</p>
<div class="paragraph">
<p>Depending on your organization&#8217;s setup, you&#8217;ll clone the repository either from
ForgeRock&#8217;s public repository on GitHub, or from a fork. See
<a href="#forgeops-fork">Git Clone or Git Fork?</a> for more information.</p>
</div>
</li>
<li>
<p>Check out the current release tag and create a branch based on the tag. For
example:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout tags/2020.10.28-AlSugoDiNoci -b <em>my-working-branch</em></strong></pre>
</div>
</div>
</li>
<li>
<p>Start watching the repository on GitHub, so that you&#8217;ll receive notifications
about new releases.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>ForgeRock recommends that you regularly incorporate changes from newer release
tags into your working branch. When GitHub notifies you that a new release is
available:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Read the <a href="https://github.com/ForgeRock/forgeops/releases">Release Notes</a>, which
contain information about the new release tag.</p>
</li>
<li>
<p>Use the <span class="command"><code>git fetch --tags</code></span> command to fetch new <code>forgeops</code>
repository tags into your clone.</p>
</li>
<li>
<p>Create a new branch based on the new release tag:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout tags/<em>new-release-tag</em> -b releases/<em>new-release-tag</em></strong></pre>
</div>
</div>
</li>
<li>
<p>Rebase the commits from the new branch into your working branch in your
<code>forgeops</code> repository clone.</p>
<div class="paragraph">
<p>If you like, you can remove the branch based on the new release tag when you&#8217;ve
finished rebasing.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>It&#8217;s important to understand the impact of rebasing changes from a new release
tag from ForgeRock into your branches. <a href="#forgeops-reference">Repository Reference</a> provides advice
about which files in the <code>forgeops</code> repository to change, which files not to
change, and what to look out for when you rebase. Follow the advice in
<a href="#forgeops-reference">Repository Reference</a> to reduce merge conflicts, and to better understand
how to resolve them when you rebase changes from a new release tag.</p>
</div>
</div>
<div class="sect2">
<h3 id="forgeops-reference"><a class="anchor" href="#forgeops-reference"></a>Repository Reference</h3>
<div class="sect3">
<h4 id="directories"><a class="anchor" href="#directories"></a>Directories</h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><span class="path"><code>bin</code></span></dt>
<dd>
<p>Example scripts you can use or model for a variety of deployment tasks.</p>
<div class="paragraph">
<p>Recommendation: Don&#8217;t modify the files in this directory. If you want to add
your own scripts to the <code>forgeops</code> repository, create a subdirectory under
<span class="path"><code>bin</code></span>, and store your scripts there.</p>
</div>
<div class="paragraph">
<p>Support Status: Sample files.
<a href="support.html#commercial-support" class="page">Not supported by ForgeRock.</a></p>
</div>
</dd>
<dt class="hdlist1"><span class="path"><code>cicd</code></span></dt>
<dd>
<p>Example files for working with several CI/CD systems, including Tekton and
Google Cloud Build.</p>
<div class="paragraph">
<p>Recommendation: Don&#8217;t modify the files in this directory. If you want to add
your own CI/CD support files to the <code>forgeops</code> repository, create a subdirectory
under <span class="path"><code>cicd</code></span>, and store your files there.</p>
</div>
<div class="paragraph">
<p>Support Status: Sample files.
<a href="support.html#commercial-support" class="page">Not supported by ForgeRock.</a></p>
</div>
</dd>
<dt class="hdlist1"><span class="path"><code>cluster</code></span></dt>
<dd>
<p>Example scripts and artifacts that automate cluster creation.</p>
<div class="paragraph">
<p>Recommendation: Don&#8217;t modify the files in this directory. If you want to add
your own cluster creation support files to the <code>forgeops</code> repository, create a
subdirectory under <span class="path"><code>cluster</code></span>, and store your files there.</p>
</div>
<div class="paragraph">
<p>Support Status: Sample files.
<a href="support.html#commercial-support" class="page">Not supported by ForgeRock.</a></p>
</div>
</dd>
<dt class="hdlist1"><span class="path"><code>config</code></span></dt>
<dd>
<p>Configuration profiles, including the canonical <code>cdk</code> profile from ForgeRock and
user-customized profiles.</p>
<div class="paragraph">
<p>Recommendation: Add your own profiles to this directory using the
<span class="command"><code>config.sh</span></code> command. Do not modify the canonical <code>cdk</code> profile.</p>
</div>
<div class="paragraph">
<p>Support Status: Configuration profiles.
<a href="support.html#commercial-support" class="page">Support is available from
ForgeRock for the canonical <code>cdk</code> configuration profile, but not for customized
configuration profiles you&#8217;ve added to the <code>config</code> directory</a>.</p>
</div>
</dd>
<dt class="hdlist1"><span class="path"><code>docker</code></span></dt>
<dd>
<p>Dockerfiles and other support files needed to build Docker images for version
7.0 of the ForgeRock Identity Platform.</p>
<div class="paragraph">
<p>Recommendation: When customizing ForgeRock&#8217;s default deployments, you&#8217;ll need to
add files under the <span class="path"><code>docker/7.0</code></span>
directory. For example, to customize the AM WAR file, you might need to
add plugin JAR files, user interface customization files, or image files.</p>
</div>
<div class="paragraph">
<p>If you only add new files under the <span class="path"><code>docker/7.0</code></span>
directory, you should not encounter merge conflicts when you rebase changes from
a new release tag into your branches. However, if you need to modify any files
from ForgeRock, you might encounter merge conflicts. Be sure to track changes
you&#8217;ve made to any files in the <span class="path"><code>docker</code></span> directory, so that you&#8217;re
prepared to resolve merge conflicts after a rebase.</p>
</div>
<div class="paragraph">
<p>Support Status: Dockerfiles and other files needed to build Docker images for
the ForgeRock Identity Platform.
<a href="support.html#commercial-support" class="page">Support is available from ForgeRock.</a></p>
</div>
</dd>
<dt class="hdlist1"><span class="path"><code>etc</code></span></dt>
<dd>
<p>Files used to support several examples, including the CDM.</p>
<div class="paragraph">
<p>Recommendation: Don&#8217;t modify the files in this directory (or its subdirectories).
If you want to use CDM automated cluster creation as a model or starting
point for your own automated cluster creation, then create your own
subdirectories under <span class="path"><code>etc</code></span>, and copy the files you want to model into
the subdirectories.</p>
</div>
<div class="paragraph">
<p>Support Status: Sample files.
<a href="support.html#commercial-support" class="page">Not supported by ForgeRock.</a></p>
</div>
</dd>
<dt class="hdlist1"><span class="path"><code>jenkins-scripts</code></span></dt>
<dd>
<p>For ForgeRock internal use only. Do not modify or use.</p>
</dd>
<dt class="hdlist1"><span class="path"><code>kustomize</code></span></dt>
<dd>
<p>Artifacts for orchestrating the ForgeRock Identity Platform using Kustomize.</p>
<div class="paragraph">
<p>Recommendation: Common deployment customizations, such as changing the
deployment namespace and providing a customized FQDN, require modifications to
files in the <span class="path"><code>kustomize/7.0</code></span> directory. You&#8217;ll probably
change, at minimum, the
<span class="path"><code>kustomize/7.0/all/kustomization.yaml</code></span> file.</p>
</div>
<div class="paragraph">
<p>Expect to encounter merge conflicts when you rebase changes from a new release
tag into your branches. Be sure to track changes you&#8217;ve made to files in the
<span class="path"><code>kustomize</code></span> directory, so that you&#8217;re prepared to resolve merge
conflicts after a rebase.</p>
</div>
<div class="paragraph">
<p>Support Status: Kustomize bases and overlays.
<a href="support.html#commercial-support" class="page">Support is available from ForgeRock.</a></p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="files_in_the_top_level_directory"><a class="anchor" href="#files_in_the_top_level_directory"></a>Files in the Top-Level Directory</h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><span class="path"><code>.gcloudignore</code></span>, <span class="path"><code>.gitchangelog.rc</code></span>, <span class="path"><code>.gitignore</code></span></dt>
<dd>
<p>For ForgeRock internal use only. Do not modify.</p>
</dd>
<dt class="hdlist1"><span class="path"><code>cloudbuild.yaml</code></span></dt>
<dd>
<p>Example files for working with Google Cloud Build.</p>
<div class="paragraph">
<p>Recommendation: Don&#8217;t modify this file. If you want to add your own Cloud Build
configuration to the <code>forgeops</code> repository, use a different file name.</p>
</div>
<div class="paragraph">
<p>Support Status: Sample file.
<a href="support.html#commercial-support" class="page">Not supported by ForgeRock.</a></p>
</div>
</dd>
<dt class="hdlist1"><span class="path"><code>LICENSE</code></span></dt>
<dd>
<p>Software license for artifacts in the <code>forgeops</code> repository. Do not modify.</p>
</dd>
<dt class="hdlist1"><span class="path"><code>Makefile</code></span></dt>
<dd>
<p>For ForgeRock internal use only. Do not modify.</p>
</dd>
<dt class="hdlist1"><span class="path"><code>notifications.json</code></span></dt>
<dd>
<p>For ForgeRock internal use only. Do not modify.</p>
</dd>
<dt class="hdlist1"><span class="path"><code>README.md</code></span></dt>
<dd>
<p>The top-level <code>forgeops</code> repository README file. Do not modify.</p>
</dd>
<dt class="hdlist1"><span class="path"><code>skaffold.yaml</code></span></dt>
<dd>
<p>The declarative configuration for running Skaffold to deploy version
7.0 of the ForgeRock Identity Platform.</p>
<div class="paragraph">
<p>Recommendation: If you need to customize the
<span class="path"><code>skaffold.yaml</code></span> file, you might encounter merge conflicts when you
rebase changes from a new release tag into your branches. Be sure to track
changes you&#8217;ve made to this file, so that you&#8217;re prepared to resolve merge
conflicts after a rebase.</p>
</div>
<div class="paragraph">
<p>Support Status: Skaffold configuration file.
<a href="support.html#commercial-support" class="page">Support is available from ForgeRock.</a></p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="forgeops-fork"><a class="anchor" href="#forgeops-fork"></a>Git Clone or Git Fork?</h3>
<div class="paragraph">
<p>For the simplest use cases&#x2014;a single user in an organization installing
the CDK or CDM for a proof of concept, or exploration of the
platform&#x2014;cloning ForgeRock&#8217;s public <code>forgeops</code> repository from
GitHub provides a quick and adequate way to access the repository.</p>
</div>
<div class="paragraph">
<p>If, however, your use case is more complex, you might want to fork the
<code>forgeops</code> repository, and use the fork as your common upstream repository. For
example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Multiple users in your organization need to access a common version of the
repository and share changes made by other users.</p>
</li>
<li>
<p>Your organization plans to incorporate <code>forgeops</code> repository changes from
ForgeRock.</p>
</li>
<li>
<p>Your organization wants to use pull requests when making repository updates.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you&#8217;ve forked the <code>forgeops</code> repository:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You&#8217;ll need to synchronize your fork with ForgeRock&#8217;s public repository on
GitHub when ForgeRock releases a new release tag.</p>
</li>
<li>
<p>Your users will need to clone your fork before they start working instead of
cloning the public <code>forgeops</code> repository on GitHub. Because procedures in the
<a href="cdk/overview.html" class="page">Cloud Developer&#8217;s Kit Documentation</a> and the <a href="cdm/overview.html" class="page">Cloud Deployment Model Documentation</a> tell users
to clone the public repository, you&#8217;ll need to make sure your users follow
different procedures to clone the forks instead.</p>
</li>
<li>
<p>The steps for initially obtaining and updating your repository clone will
differ from the steps provided in the documentation. You&#8217;ll need to let users
know how to work with the fork as the upstream instead of following the steps in
the documentation.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cloud_developers_kit_documentation"><a class="anchor" href="#cloud_developers_kit_documentation"></a>Cloud Developer&#8217;s Kit Documentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The CDK is a minimal sample deployment of the ForgeRock Identity Platform. If you
have access to a cluster on Google Cloud, EKS, or AKS, you can install the
CDK in a namespace on your cluster. But even if you dont have access to
a cloud-based cluster, you can still deploy the CDK locally in a
standalone environment called Minikube, and when youre done, youll have a
local Kubernetes cluster with the platform installed on it.</p>
</div>
<div class="sect2">
<h3 id="cdk_checklist"><a class="anchor" href="#cdk_checklist"></a>CDK Checklist</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/intro.html" class="page">Become familiar with the CDK</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Understand CDK architecture (<a href="cdk/minikube/concepts.html" class="page">Minikube</a>|<a href="cdk/cloud/concepts.html" class="page">Shared Cluster</a>)</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Set up your local environment (<a href="cdk/minikube/setup/overview.html" class="page">Minikube</a>|<a href="cdk/cloud/setup/overview.html" class="page">Shared Cluster</a>)</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/deploy.html" class="page">Deploy the platform</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/access.html" class="page">Access platform UIs and APIs</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/develop.html" class="page">Develop custom Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="about_the_cloud_developers_kit"><a class="anchor" href="#about_the_cloud_developers_kit"></a>About the Cloud Developer's Kit</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The CDK is a minimal sample deployment for development purposes. It
includes fully integrated AM, IDM, and DS installations,
and randomly generated secrets. Developers deploy the CDK, and then
access AM&#8217;s and IDM&#8217;s GUI consoles and REST APIs to configure
the platform and build customized Docker images for the platform.</p>
</div>
<div class="paragraph">
<p>This documentation describes how to use the CDK to stand up the platform
in your developer environment, then create and test customized Docker images
containing your custom AM and IDM configurations:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/start-config-platform.png" alt="Illustrates the major configuration tasks performed before deploying in production.">
</div>
</div>
<div class="paragraph">
<p>Customizing the platform using the CDK is one of the major activities
required before deploying the platform in production. To better understand how
this activity fits in to the overall deployment process, see
<a href="start/start-here.html#configure-platform" class="page">Configure the Platform</a>.</p>
</div>
<div class="sect2">
<h3 id="containerization"><a class="anchor" href="#containerization"></a>Containerization</h3>
<div class="paragraph">
<p>The CDK uses <a href="https://www.docker.com">Docker</a> for containerization. The
CDK leverages the following Docker capabilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>File-Based Representation of Containers</strong>. Docker <em>images</em> contain a file
system and run-time configuration information. Docker <em>containers</em> are running
instances of Docker images.</p>
</li>
<li>
<p><strong>Modularization</strong>. Docker images are based on other Docker images. For
example, an AM image is based on a Tomcat image that is itself based on
an OpenJDK JRE image. In this example, the AM container has AM
software, Tomcat software, and the OpenJDK JRE.</p>
</li>
<li>
<p><strong>Collaboration</strong>. Public and private Docker registries let users collaborate
by providing cloud-based access to Docker images. Continuing with the example,
the public Docker registry at <a href="https://hub.docker.com/" class="bare">https://hub.docker.com/</a> has Docker images for
Tomcat and the OpenJDK JRE that any user can download. You build Docker images
for the ForgeRock Identity Platform based on the Tomcat and OpenJDK JRE images in the public
Docker registry. You can then push the Docker images to a private Docker
registry that other users in your organization can access.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>ForgeRock provides a set of unsupported, evaluation-only base images for the
ForgeRock Identity Platform. These images are available in ForgeRock&#8217;s public Docker
registry.</p>
</div>
<div class="paragraph">
<p>Developers working with the CDK use the base images from ForgeRock to
build customized Docker images for a fully-configured ForgeRock Identity Platform
deployment:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/containerization-dev.svg" alt="Brief overview of containers for developers.">
</div>
</div>
<div class="paragraph">
<p>Users working with the CDM also use the base images from ForgeRock to
perform proof-of-concept deployments.</p>
</div>
<div class="paragraph">
<p>The base images from ForgeRock are evaluation-only. <em>They are unsupported for
production use.</em> Because of this, you must build your own base images before
you deploy in production:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/containerization-prod.svg" alt="Brief overview of containers in production.">
</div>
</div>
<div class="paragraph">
<p>For information about how to build base images for deploying the ForgeRock Identity Platform
in production,
see <a href="deployment/base-docker-images.html" class="page">Base Docker Images</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="orchestration"><a class="anchor" href="#orchestration"></a>Orchestration</h3>
<div class="paragraph">
<p>The CDK uses <a href="https://kubernetes.io">Kubernetes</a> for container
orchestration. The CDK has been tested on the following Kubernetes
implementations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Single-node deployments suitable for proofs of concept and development:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://kubernetes.io/docs/setup/learning-environment/minikube/">Minikube</a></p>
</li>
<li>
<p><a href="https://www.redhat.com/sysadmin/learn-openshift-minishift">Minishift</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Cloud-based Kubernetes orchestration frameworks. These are suitable for both
development and production deployment of the platform:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://cloud.google.com/container-engine/">Google Kubernetes Engine (GKE)</a></p>
</li>
<li>
<p><a href="https://aws.amazon.com/eks/">Amazon Elastic Kubernetes Service (Amazon EKS)</a></p>
</li>
<li>
<p><a href="https://azure.microsoft.com/en-us/services/kubernetes-service/">Azure Kubernetes Service (AKS)</a></p>
</li>
<li>
<p><a href="https://www.openshift.com">Red Hat OpenShift</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<h3 id="next_step" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/intro.html" class="page">Become familiar with the CDK</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark>Understand CDK architecture (<a href="cdk/minikube/concepts.html" class="page">Minikube</a>|<a href="cdk/cloud/concepts.html" class="page">Shared Cluster</a>)</mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Set up your local environment (<a href="cdk/minikube/setup/overview.html" class="page">Minikube</a>|<a href="cdk/cloud/setup/overview.html" class="page">Shared Cluster</a>)</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/deploy.html" class="page">Deploy the platform</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/access.html" class="page">Access platform UIs and APIs</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/develop.html" class="page">Develop custom Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdk_architecture_minikube"><a class="anchor" href="#cdk_architecture_minikube"></a>CDK Architecture: Minikube</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The CDK uses Skaffold to trigger Docker image builds and Kubernetes
orchestration. Here&#8217;s what Skaffold does:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Calls the Docker client on the local computer to build and tag their
customized Docker images for the ForgeRock Identity Platform. The customized images are
based on Docker images in ForgeRock&#8217;s public Docker
registry, <code>gcr.io/forgerock-io</code>.</p>
</li>
<li>
<p>Pushes the Docker images to the Docker engine that&#8217;s part of the Minikube VM.</p>
</li>
<li>
<p>Calls Kustomize to orchestrate the ForgeRock Identity Platform in your namespace.
Kustomize uses the Docker images that Skaffold pushed to your Docker registry.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following diagram illustrates how the CDK uses Skaffold to build and
orchestrate Docker images on Minikube:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/minikube.svg" alt="CDM clusters have three zones and two node pools. The node pools have six nodes each.">
</div>
</div>
<div class="paragraph">
<p>After deploying the ForgeRock Identity Platform, you&#8217;ll see the following pods running in
your namespace:</p>
</div>
<div id="minikube-pods" class="imageblock">
<div class="content">
<img src="_images/deployment.svg" alt="Diagram of the deployed ${cdk.abbr}.">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>am</code></dt>
<dd>
<p>The <code>am</code> pod runs AM.</p>
<div class="paragraph">
<p>When AM starts, it obtains its
<a href="cdk/develop.html#configuration-data" class="page">configuration</a> from the
<span class="path"><code>/home/forgerock/openam/config</code></span> directory
<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>After the <code>am</code> pod has started, an Amster job is triggered. This
job populates AM&#8217;s
<a href="cdk/develop.html#run-time-data" class="page">run-time data</a>.</p>
</div>
</dd>
<dt class="hdlist1"><code>ds-cts-0</code></dt>
<dd>
<p>The <code>ds-cts-0</code> pod runs the directory service used by the AM Core Token
Service.</p>
</dd>
<dt class="hdlist1"><code>ds-idrepo-0</code></dt>
<dd>
<p>The <code>ds-idrepo-0</code> pod runs the following directory services:</p>
<div class="ulist">
<ul>
<li>
<p>Identity repository shared by AM and IDM</p>
</li>
<li>
<p>IDM repository</p>
</li>
<li>
<p>AM application and policy store</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>idm-0</code></dt>
<dd>
<p>The <code>idm-0</code> pod runs IDM.</p>
<div class="paragraph">
<p>When IDM starts, it obtains its
<a href="cdk/develop.html#configuration-data" class="page">configuration</a>
from the <span class="path"><code>/opt/openidm/conf</code></span> directory
<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>In containerized deployments, IDM must retrieve its configuration from
the file system and not from the IDM repository. The default values for
the <code>openidm.fileinstall.enabled</code> and <code>openidm.config.repo.enabled</code> properties
in the CDK&#8217;s <span class="path"><code>system.properties</code></span> file ensure that IDM
retrieves its configuration from the file system. Do not override the default
values for these properties.</p>
</div>
</dd>
<dt class="hdlist1">UI pods</dt>
<dd>
<p>Several pods provide access to ForgeRock common user interfaces:</p>
<div class="ulist">
<ul>
<li>
<p><code>admin-ui</code></p>
</li>
<li>
<p><code>end-user-ui</code></p>
</li>
<li>
<p><code>login-ui</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>In addition to these pods, you&#8217;ll see that two jobs that load data into the
environment have run to completion:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>amster</code> job, which  loads application data, such as OAuth 2.0 client
definitions, to the <code>idrepo</code> DS instance.</p>
</li>
<li>
<p>The <code>ldif-importer</code> job, which  loads policy data required by AM to the
the <code>idrepo</code> DS instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The CDK also requires two other services that are external to your
namespace:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Minikube&#8217;s ingress controller plugin, for providing external access to
services in the Minikube cluster.</p>
</li>
<li>
<p>ForgeRock&#8217;s Secret Agent operator, for generating and managing Kubernetes
secrets.</p>
</li>
</ul>
</div>
<h3 id="next_step_2" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/intro.html" class="page">Become familiar with the CDK</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Understand CDK architecture (<a href="cdk/minikube/concepts.html" class="page">Minikube</a>|<a href="cdk/cloud/concepts.html" class="page">Shared Cluster</a>)</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark>Set up your local environment (<a href="cdk/minikube/setup/overview.html" class="page">Minikube</a>|<a href="cdk/cloud/setup/overview.html" class="page">Shared Cluster</a>)</mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/deploy.html" class="page">Deploy the platform</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/access.html" class="page">Access platform UIs and APIs</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/develop.html" class="page">Develop custom Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdk_architecture_shared_cloud_cluster"><a class="anchor" href="#cdk_architecture_shared_cloud_cluster"></a>CDK Architecture: Shared Cloud Cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A shared cluster lets multiple developers deploy and configure the
ForgeRock Identity Platform on a single cloud-based Kubernetes cluster. A Kubernetes
administrator sets up the shared cluster, then provides details to the
developers so that they can access the cluster. Each developer then works in
their own isolated environment within the cluster, called a <em>namespace</em>.</p>
</div>
<div class="paragraph">
<p>The CDK uses Skaffold to trigger Docker image builds and Kubernetes
orchestration. Here&#8217;s what Skaffold does:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Calls the Docker client on the local computer to build and tag their
customized Docker images for the ForgeRock Identity Platform. The customized images are
based on Docker images in ForgeRock&#8217;s public Docker registry,
<code>gcr.io/forgerock-io</code>.</p>
</li>
<li>
<p>Pushes the Docker images to a Docker registry accessible to the shared
cluster.</p>
</li>
<li>
<p>Calls Kustomize to orchestrate the ForgeRock Identity Platform in your namespace.
Kustomize uses the Docker images that Skaffold pushed to your Docker registry.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following diagram illustrates how the CDK uses Skaffold to build
Docker images locally, push them to a shared registry, and orchestrate them in a
shared cluster:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/cloud.svg" alt="Diagram of a development environment that uses a shared cluster.">
</div>
</div>
<div class="paragraph">
<p>After deploying the ForgeRock Identity Platform, you&#8217;ll see the following pods running in
your namespace:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/deployment.svg" alt="Diagram of the deployed CDK.">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>am</code></dt>
<dd>
<p>The <code>am</code> pod runs AM.</p>
<div class="paragraph">
<p>When AM starts, it obtains its
<a href="cdk/develop.html#configuration-data" class="page">configuration</a> from the
<span class="path"><code>/home/forgerock/openam/config</code></span> directory
<sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>After the <code>am</code> pod has started, an Amster job is triggered. This
job populates AM&#8217;s
<a href="cdk/develop.html#run-time-data" class="page">run-time data</a>.</p>
</div>
</dd>
<dt class="hdlist1"><code>ds-cts-0</code></dt>
<dd>
<p>The <code>ds-cts-0</code> pod runs the directory service used by the AM Core Token
Service.</p>
</dd>
<dt class="hdlist1"><code>ds-idrepo-0</code></dt>
<dd>
<p>The <code>ds-idrepo-0</code> pod runs the following directory services:</p>
<div class="ulist">
<ul>
<li>
<p>Identity repository shared by AM and IDM</p>
</li>
<li>
<p>IDM repository</p>
</li>
<li>
<p>AM application and policy store</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>idm-0</code></dt>
<dd>
<p>The <code>idm-0</code> pod runs IDM.</p>
<div class="paragraph">
<p>When IDM starts, it obtains its
<a href="cdk/develop.html#configuration-data" class="page">configuration</a>
from the <span class="path"><code>/opt/openidm/conf</code></span> directory
<sup class="footnote">[<a id="_footnoteref_4" class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>In containerized deployments, IDM must retrieve its configuration from
the file system and not from the IDM repository. The default values for
the <code>openidm.fileinstall.enabled</code> and <code>openidm.config.repo.enabled</code> properties
in the CDK&#8217;s <span class="path"><code>system.properties</code></span> file ensure that IDM
retrieves its configuration from the file system. Do not override the default
values for these properties.</p>
</div>
</dd>
<dt class="hdlist1">UI pods</dt>
<dd>
<p>Several pods provide access to ForgeRock common user interfaces:</p>
<div class="ulist">
<ul>
<li>
<p><code>admin-ui</code></p>
</li>
<li>
<p><code>end-user-ui</code></p>
</li>
<li>
<p><code>login-ui</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>In addition to these pods, you&#8217;ll see that two jobs that load data into the
environment have run to completion:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>amster</code> job, which  loads application data, such as OAuth 2.0 client
definitions, to the <code>idrepo</code> DS instance.</p>
</li>
<li>
<p>The <code>ldif-importer</code> job, which  loads policy data required by AM to the
the <code>idrepo</code> DS instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The CDK also requires three other services that are external to your
namespace. These services must be installed by your cluster administrator before
you attempt to install the CDK in your shared cluster:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An NGINX ingress controller, for providing external access to services in the
shared cluster.</p>
</li>
<li>
<p>Certificate manager, for obtaining and installing security certificates.</p>
</li>
<li>
<p>ForgeRock&#8217;s Secret Agent operator, for generating and managing Kubernetes
secrets.</p>
</li>
</ul>
</div>
<h3 id="next_step_3" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/intro.html" class="page">Become familiar with the CDK</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Understand CDK architecture (<a href="cdk/minikube/concepts.html" class="page">Minikube</a>|<a href="cdk/cloud/concepts.html" class="page">Shared Cluster</a>)</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark>Set up your local environment (<a href="cdk/minikube/setup/overview.html" class="page">Minikube</a>|<a href="cdk/cloud/setup/overview.html" class="page">Shared Cluster</a>)</mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/deploy.html" class="page">Deploy the platform</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/access.html" class="page">Access platform UIs and APIs</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/develop.html" class="page">Develop custom Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="environment_setup_minikube"><a class="anchor" href="#environment_setup_minikube"></a>Environment Setup: Minikube</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before deploying the CDK, you must set up your local environment with
a Minikube cluster.</p>
</div>
<div class="paragraph">
<p></p>
</div>
<details>
<summary>
Windows users
</summary>
<div class="paragraph">
<p>ForgeRock supports deploying the CDK and CDM using macOS and
Linux. If you have a Windows computer, you&#8217;ll need to create a Linux VM. We
tested using the following configurations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hypervisor: Hyper-V, VMWare Player, or VMWare Workstation</p>
</li>
<li>
<p>Guest OS: Ubuntu 19.10 with 12 GB memory and 60 GB disk space</p>
</li>
<li>
<p>Nested virtualization enabled in the Linux VM.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Perform all the procedures in this documentation within the Linux VM. In this
documentation, the local computer refers to the Linux VM for Windows users.</strong></p>
</div>
</details>
<div class="sect2">
<h3 id="environment_setup_checklist"><a class="anchor" href="#environment_setup_checklist"></a>Environment Setup Checklist</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/minikube/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/minikube/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/minikube/setup/vm.html" class="page">Create the Minikube VM</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/minikube/setup/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/minikube/setup/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/minikube/setup/docker.html" class="page">Use Minikube&#8217;s Docker engine</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After you&#8217;ve completed all of these environment setup tasks, you&#8217;ll be ready to
<a href="cdk/deploy.html" class="page">deploy the ForgeRock Identity Platform on your new Minikube
cluster</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="forgeops_repository"><a class="anchor" href="#forgeops_repository"></a><code>forgeops</code> Repository</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you can deploy the CDK or the CDM, you must first get the
<code>forgeops</code> repository:<sup class="footnote" id="_footnote_release-tag">[<a id="_footnoteref_5" class="footnote" href="#_footnotedef_5" title="View footnote.">5</a>]</sup></p>
</div>
<div class="openblock procedure">
<div class="title">Obtain the forgeops Repository</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone the <code>forgeops</code> repository:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git clone <a href="https://github.com/ForgeRock/forgeops.git" class="bare">https://github.com/ForgeRock/forgeops.git</a></strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>forgeops</code> repository is a public Git repository. You do not need
credentials to clone it.</p>
</div>
</li>
<li>
<p>Check out the <code>2020.10.28-AlSugoDiNoci</code> release tag, creating a branch named
<code><em>my-branch</em></code>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd forgeops</strong>
$ <strong>git checkout tags/2020.10.28-AlSugoDiNoci -b <em>my-branch</em></strong>
Switched to a new branch <em>'my-branch'</em></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_4" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/minikube/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/minikube/setup/sw.html" class="page">Install third-party software</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/minikube/setup/vm.html" class="page">Create the Minikube VM</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/minikube/setup/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/minikube/setup/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/minikube/setup/docker.html" class="page">Use Minikube&#8217;s Docker engine</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="third_party_software"><a class="anchor" href="#third_party_software"></a>Third-Party Software</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before installing the CDK, you must obtain non-ForgeRock software and
install it on your local computer.</p>
</div>
<div class="paragraph">
<p>ForgeRock recommends that you install third-party software using
<a href="https://brew.sh/">Homebrew</a> on macOS and Linux.</p>
</div>
<div class="paragraph">
<p>The versions listed in the following table have been validated for building
custom Docker images for the ForgeRock Identity Platform. Earlier and later versions will
<em>probably</em> work. If you want to try using versions that are not in the tables,
it is your responsibility to validate them.</p>
</div>
<div class="paragraph">
<p>Install all of the following third-party software:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Software</th>
<th class="tableblock halign-left valign-top">Version</th>
<th class="tableblock halign-left valign-top">Homebrew package</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker Desktop<sup class="footnote" id="_footnote_docker">[<a id="_footnoteref_6" class="footnote" href="#_footnotedef_6" title="View footnote.">6</a>]</sup>
</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.3.0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker</code> (cask)<sup class="footnote" id="_footnote_linuxbrew">[<a id="_footnoteref_7" class="footnote" href="#_footnotedef_7" title="View footnote.">7</a>]</sup>
</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes client (<span class="command"><code>kubectl</code></span>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.19.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubernetes-cli</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Skaffold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.14.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skaffold</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kustomize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.8.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kustomize</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes context switcher (<span class="command"><code>kubectx</code></span>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubectx</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VirtualBox</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.1.14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>virtualbox</code> (cask)<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_7" title="View footnote.">7</a>]</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minikube</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.13.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minikube</code></p></td>
</tr>
</tbody>
</table>
<h3 id="next_step_5" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/minikube/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/minikube/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/minikube/setup/vm.html" class="page">Create the Minikube VM</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/minikube/setup/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/minikube/setup/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/minikube/setup/docker.html" class="page">Use Minikube&#8217;s Docker engine</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="minikube_virtual_machine"><a class="anchor" href="#minikube_virtual_machine"></a>Minikube Virtual Machine</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Minikube is a tool that runs a single-node Kubernetes cluster in a virtual
machine.</p>
</div>
<div class="paragraph">
<p>The following configuration has been validated for building custom Docker images
for the ForgeRock Identity Platform using Minikube:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Kubernetes version: 1.17.4</p>
</li>
<li>
<p>Memory: 12 GB or more</p>
</li>
<li>
<p>Disk space: 40 GB or more</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Perform the following procedure to set up Minikube:</p>
</div>
<div class="openblock procedure">
<div class="title">Set up Minikube</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use the <span class="command"><code>minikube start</code></span> command to create a Minikube VM. In this
example, the Minikube VM is created with a Kubernetes cluster suitable for
building custom Docker images for the ForgeRock Identity Platform:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>minikube start --memory=12288 --cpus=3 --disk-size=40g --cni=true \
 --vm-driver=virtualbox --bootstrapper kubeadm --kubernetes-version=1.17.4 </strong>
&#x1f604;  minikube v1.13.1 on Darwin 10.15.6
&#x1F195;  Kubernetes 1.19.2 is now available. If you would like to upgrade, specify: --kubernetes-version=v1.19.0
&#x2728;  Using the virtualbox driver based on user configuration
&#x1f44d;  Starting control plane node minikube in cluster minikube
&#x1f525;  Creating virtualbox VM (CPUs=3, Memory=12288MB, Disk=40960MB) &#8230;&#8203;
&#x1f433;  Preparing Kubernetes v1.17.4 on Docker 19.03.12 &#8230;&#8203;
&#x1f517;  Configuring CNI (Container Networking Interface) &#8230;&#8203;
&#x1F50E;  Verifying Kubernetes components&#8230;&#8203;
&#x1f31f;  Enabled addons: default-storageclass, storage-provisioner

&#x1f3c4;  Done! kubectl is now configured to use "minikube" by default</pre>
</div>
</div>
</li>
<li>
<p>Run the following command to enable the ingress controller plugin built into
Minikube:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>minikube addons enable ingress</strong>
&#x1F50E;  Verifying ingress addon&#8230;&#8203;
&#x1f31f;  The 'ingress' addon is enabled</pre>
</div>
</div>
</li>
<li>
<p>Install the Secret Agent operator:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl apply -f https://github.com/ForgeRock/secret-agent/releases/latest/download/secret-agent.yaml</strong>
namespace/secret-agent-system created
customresourcedefinition.apiextensions.k8s.io/secretagentconfigurations.secret-agent.secrets.forgerock.io created
mutatingwebhookconfiguration.admissionregistration.k8s.io/secret-agent-mutating-webhook-configuration created
serviceaccount/secret-agent-manager-service-account created
role.rbac.authorization.k8s.io/secret-agent-leader-election-role created
clusterrole.rbac.authorization.k8s.io/secret-agent-manager-role created
rolebinding.rbac.authorization.k8s.io/secret-agent-leader-election-rolebinding created
clusterrolebinding.rbac.authorization.k8s.io/secret-agent-manager-rolebinding created
service/secret-agent-webhook-service created
deployment.apps/secret-agent-controller-manager created
validatingwebhookconfiguration.admissionregistration.k8s.io/secret-agent-validating-webhook-configuration created</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_6" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/minikube/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/minikube/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/minikube/setup/vm.html" class="page">Create the Minikube VM</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/minikube/setup/namespace.html" class="page">Create a Kubernetes namespace</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/minikube/setup/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/minikube/setup/docker.html" class="page">Use Minikube&#8217;s Docker engine</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="namespace"><a class="anchor" href="#namespace"></a>Namespace</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Create a namespace in your new cluster.</p>
</div>
<div class="paragraph">
<p>ForgeRock recommends that you deploy the ForgeRock Identity Platform in a namespace other
than the default namespace. Deploying to a non-default namespace lets you
separate workloads in a cluster. Separating a workload into a namespace lets you
delete the workload easily; just delete the namespace.</p>
</div>
<div class="paragraph">
<p>Perform the following procedure to create a namespace:</p>
</div>
<div class="openblock procedure">
<div class="title">Create a Namespace</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a namespace in your Kubernetes cluster:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl create namespace <em>my-namespace</em></strong>
namespace/my-namespace created</pre>
</div>
</div>
</li>
<li>
<p>Make the new namespace your active namespace:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubens <em>my-namespace</em></strong>
Context "my-context" modified.
Active namespace is "my-namespace".</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_7" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/minikube/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/minikube/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/minikube/setup/vm.html" class="page">Create the Minikube VM</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/minikube/setup/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/minikube/setup/hostname.html" class="page">Set up hostname resolution</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/minikube/setup/docker.html" class="page">Use Minikube&#8217;s Docker engine</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="hostname_resolution"><a class="anchor" href="#hostname_resolution"></a>Hostname Resolution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Set up hostname resolution for the ForgeRock Identity Platform servers you&#8217;ll deploy in your
namespace.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the <span class="command"><code>minikube ip</code></span> command to get the Minikube ingress
controller&#8217;s IP address:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>minikube ip</strong>
111.222.33.44</pre>
</div>
</div>
</li>
<li>
<p>Add an entry similar to the following to the <span class="path"><code>/etc/hosts</code></span> file:</p>
<div class="listingblock">
<div class="content">
<pre><em>minikube-ip-address</em> <em>my-namespace</em>.iam.example.com</pre>
</div>
</div>
</li>
</ol>
</div>
<h3 id="next_step_8" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/minikube/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/minikube/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/minikube/setup/vm.html" class="page">Create the Minikube VM</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/minikube/setup/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/minikube/setup/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/minikube/setup/docker.html" class="page">Use Minikube&#8217;s Docker engine</a></mark></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="minikubes_docker_engine"><a class="anchor" href="#minikubes_docker_engine"></a>Minikube&#8217;s Docker Engine</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Set up your local environment to execute <span class="command"><code>docker</code></span> commands on
Minikube&#8217;s Docker engine.</p>
</div>
<div class="paragraph">
<p>ForgeRock recommends using the built-in Docker engine when developing custom
Docker images using Minikube. When you use Minikube&#8217;s engine, you don&#8217;t have to
build Docker images on a local engine and then push the images to a local or
cloud-based Docker registry. Instead, you build images using the same Docker
engine that Minikube uses. This streamlines development.</p>
</div>
<div class="paragraph">
<p>Set up your local computer to use Minikube&#8217;s Docker engine as follows:</p>
</div>
<div class="openblock procedure">
<div class="title">Set Up Your Local Computer to Use Minikube&#8217;s Docker Engine</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the <span class="command"><code>docker-env</code></span> command in your shell:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>eval $(minikube docker-env)</strong></pre>
</div>
</div>
</li>
<li>
<p>Stop Skaffold from pushing Docker images to a remote Docker registry
<sup class="footnote">[<a id="_footnoteref_8" class="footnote" href="#_footnotedef_8" title="View footnote.">8</a>]</sup>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>skaffold config set --kube-context minikube local-cluster true</strong>
set value local-cluster to true for context minikube</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>For more information about using Minikube&#8217;s built-in Docker engine, see
<a href="https://kubernetes.io/docs/setup/learning-environment/minikube/#use-local-images-by-re-using-the-docker-daemon">Use local images by re-using the Docker daemon</a>
in the Minikube documentation.</p>
</div>
<h3 id="next_step_9" class="discrete">Next Step</h3>
<div class="paragraph">
<p>You&#8217;ve completed all the setup tasks for Minikube. Now you&#8217;re ready to deploy
the platform in the Minikube cluster:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/intro.html" class="page">Become familiar with the CDK</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Understand CDK architecture (<a href="cdk/minikube/concepts.html" class="page">Minikube</a>|<a href="cdk/cloud/concepts.html" class="page">Shared Cluster</a>)</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Set up your local environment (<a href="cdk/minikube/setup/overview.html" class="page">Minikube</a>|<a href="cdk/cloud/setup/overview.html" class="page">Shared Cluster</a>)</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/deploy.html" class="page">Deploy the platform</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/access.html" class="page">Access platform UIs and APIs</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/develop.html" class="page">Develop custom Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="environment_setup_shared_cloud_cluster"><a class="anchor" href="#environment_setup_shared_cloud_cluster"></a>Environment Setup: Shared Cloud Cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before deploying the CDK, you must set up your local environment to
communicate with the shared cluster.</p>
</div>
<div class="paragraph">
<p></p>
</div>
<details>
<summary>
Windows users
</summary>
<div class="paragraph">
<p>ForgeRock supports deploying the CDK and CDM using macOS and
Linux. If you have a Windows computer, you&#8217;ll need to create a Linux VM. We
tested using the following configurations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hypervisor: Hyper-V, VMWare Player, or VMWare Workstation</p>
</li>
<li>
<p>Guest OS: Ubuntu 19.10 with 12 GB memory and 60 GB disk space</p>
</li>
<li>
<p>Nested virtualization enabled in the Linux VM.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Perform all the procedures in this documentation within the Linux VM. In this
documentation, the local computer refers to the Linux VM for Windows users.</strong></p>
</div>
</details>
<div class="sect2">
<h3 id="environment_setup_checklists"><a class="anchor" href="#environment_setup_checklists"></a>Environment Setup Checklists</h3>
<div class="paragraph">
<p>Perform the tasks in the checklist <em>for your cloud provider only.</em></p>
</div>
<div class="sect3">
<h4 id="gke_shared_cluster"><a class="anchor" href="#gke_shared_cluster"></a>GKE Shared Cluster</h4>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/clusterinfo.html" class="page">Get details about the shared GKE cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="eks_shared_cluster"><a class="anchor" href="#eks_shared_cluster"></a>EKS Shared Cluster</h4>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/clusterinfo.html" class="page">Get details about the shared EKS cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="aks_shared_cluster"><a class="anchor" href="#aks_shared_cluster"></a>AKS Shared Cluster</h4>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/clusterinfo.html" class="page">Get details about the shared AKS cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After you&#8217;ve completed these environment setup tasks, you&#8217;re ready to
<a href="cdk/deploy.html" class="page">deploy the ForgeRock Identity Platform in your namespace on the
shared cluster</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="forgeops_repository_2"><a class="anchor" href="#forgeops_repository_2"></a><code>forgeops</code> Repository</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you can deploy the CDK or the CDM, you must first get the
<code>forgeops</code> repository:<sup class="footnote" id="_footnote_release-tag">[<a id="_footnoteref_9" class="footnote" href="#_footnotedef_9" title="View footnote.">9</a>]</sup></p>
</div>
<div class="openblock procedure">
<div class="title">Obtain the forgeops Repository</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone the <code>forgeops</code> repository:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git clone <a href="https://github.com/ForgeRock/forgeops.git" class="bare">https://github.com/ForgeRock/forgeops.git</a></strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>forgeops</code> repository is a public Git repository. You do not need
credentials to clone it.</p>
</div>
</li>
<li>
<p>Check out the <code>2020.10.28-AlSugoDiNoci</code> release tag, creating a branch named
<code><em>my-branch</em></code>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd forgeops</strong>
$ <strong>git checkout tags/2020.10.28-AlSugoDiNoci -b <em>my-branch</em></strong>
Switched to a new branch <em>'my-branch'</em></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_10" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/gke/sw.html" class="page">Install third-party software</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/clusterinfo.html" class="page">Get details about the shared GKE cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="third_party_software_2"><a class="anchor" href="#third_party_software_2"></a>Third-Party Software</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before installing the CDK, you must obtain non-ForgeRock software and
install it on your local computer.</p>
</div>
<div class="paragraph">
<p>ForgeRock recommends that you install third-party software using
<a href="https://brew.sh/">Homebrew</a> on macOS and Linux.</p>
</div>
<div class="paragraph">
<p>The versions listed in the tables below have been validated for building custom
Docker images for the ForgeRock Identity Platform. Earlier and later versions will
<em>probably</em> work. If you want to try using versions that are not in the tables,
it is your responsibility to validate them.</p>
</div>
<div class="paragraph">
<p>Install the following third-party software:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Software</th>
<th class="tableblock halign-left valign-top">Version</th>
<th class="tableblock halign-left valign-top">Homebrew package</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker Desktop<sup class="footnote" id="_footnote_docker">[<a id="_footnoteref_10" class="footnote" href="#_footnotedef_10" title="View footnote.">10</a>]</sup>
</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.3.0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker</code> (cask)<sup class="footnote" id="_footnote_linuxbrew">[<a id="_footnoteref_11" class="footnote" href="#_footnotedef_11" title="View footnote.">11</a>]</sup>
</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes client (<span class="command"><code>kubectl</code></span>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.19.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubernetes-cli</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Skaffold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.14.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skaffold</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kustomize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.8.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kustomize</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes context switcher (<span class="command"><code>kubectx</code></span>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubectx</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Google Cloud SDK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">311.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>google-cloud-sdk</code> (cask)<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_7" title="View footnote.">7</a>]</sup></p></td>
</tr>
</tbody>
</table>
<h3 id="next_step_11" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/gke/clusterinfo.html" class="page">Get details about the shared GKE cluster</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cluster_details"><a class="anchor" href="#cluster_details"></a>Cluster Details</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You&#8217;ll need to get some information about the cluster from your cluster
administrator. You&#8217;ll provide this information as you perform various tasks to
access the cluster.</p>
</div>
<div class="paragraph">
<p>Obtain the following cluster details:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The name of the Google Cloud project that contains the cluster.</p>
</li>
<li>
<p>The cluster name.</p>
</li>
<li>
<p>The Google Cloud zone in which the cluster resides.</p>
</li>
<li>
<p>The IP address of your cluster&#8217;s ingress controller.</p>
</li>
<li>
<p>The location of the Docker registry from which your cluster will obtain images
for the ForgeRock Identity Platform.</p>
</li>
</ul>
</div>
<h3 id="next_step_12" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/clusterinfo.html" class="page">Get details about the shared GKE cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/gke/context.html" class="page">Create a Kubernetes context</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="context_for_the_shared_cluster"><a class="anchor" href="#context_for_the_shared_cluster"></a>Context for the Shared Cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Kubernetes uses contexts to access Kubernetes clusters. Before you can access
the shared cluster, you must create a context on your local computer if it&#8217;s not
already present.</p>
</div>
<div class="paragraph">
<p>Perform the following procedure to create a context for the shared cluster:</p>
</div>
<div class="openblock procedure">
<div class="title">Create a Context for a GKE Cluster</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command and review the output. The current
Kubernetes context is highlighted:</p>
<div class="ulist">
<ul>
<li>
<p>If the current context references the shared cluster, there is nothing
further to do. Proceed to <a href="cdk/cloud/setup/gke/namespace.html" class="page">Namespace</a>.</p>
</li>
<li>
<p>If the context of the shared cluster is present in the <span class="command"><code>kubectx</code></span>
command output, set the context as follows:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectx my-context</strong>
Switched to context "my-context".</pre>
</div>
</div>
<div class="paragraph">
<p>After you have set the context, proceed to
<a href="cdk/cloud/setup/gke/namespace.html" class="page">Namespace</a>.</p>
</div>
</li>
<li>
<p>If the context of the shared cluster is not present in the
<span class="command"><code>kubectx</code></span> command output, continue to the next step in this
procedure.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Configure the Google Cloud SDK standard component to use your Google account.
Run the following command:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>gcloud auth login</strong></pre>
</div>
</div>
</li>
<li>
<p>A browser window prompts you to log in to Google. Log in using your Google
account.</p>
<div class="paragraph">
<p>A second screen requests several permissions. Select Allow.</p>
</div>
<div class="paragraph">
<p>A third screen should appear with the heading, "You are now authenticated with
the Google Cloud SDK!"</p>
</div>
</li>
<li>
<p>Return to the terminal window and run the following command. Use the cluster
name, zone, and project name you
<a href="cdk/cloud/setup/gke/clusterinfo.html" class="page">obtained from your cluster administrator</a>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>gcloud container clusters \
 get-credentials <em>cluster-name</em> --zone <em>google-zone</em> --project <em>google-project</em></strong>
Fetching cluster endpoint and auth data.
kubeconfig entry generated for <em>cluster-name</em>.</pre>
</div>
</div>
</li>
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command again and verify that the context for
our Kubernetes cluster is now the current context.</p>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_13" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/clusterinfo.html" class="page">Get details about the shared GKE cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/gke/namespace.html" class="page">Create a Kubernetes namespace</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="namespace_2"><a class="anchor" href="#namespace_2"></a>Namespace</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Create a namespace in the shared cluster. Namespaces let you isolate your
deployments from other developers' deployments.</p>
</div>
<div class="paragraph">
<p>ForgeRock recommends that you deploy the ForgeRock Identity Platform in a namespace other
than the <code>default</code> namespace. Deploying to a non-default namespace lets you
separate workloads in a cluster. Separating a workload into a namespace lets you
 delete the workload easily; just delete the namespace.</p>
</div>
<div class="paragraph">
<p>Perform the following procedure to create a namespace:</p>
</div>
<div class="openblock procedure">
<div class="title">Create a Namespace</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a namespace in your Kubernetes cluster:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl create namespace <em>my-namespace</em></strong>
namespace/my-namespace created</pre>
</div>
</div>
</li>
<li>
<p>Make the new namespace your current namespace:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubens <em>my-namespace</em></strong>
Context "my-context" modified.
Active namespace is "my-namespace".</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_14" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/clusterinfo.html" class="page">Get details about the shared GKE cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/gke/hostname.html" class="page">Set up hostname resolution</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/gke/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="hostname_resolution_2"><a class="anchor" href="#hostname_resolution_2"></a>Hostname Resolution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You might need to set up hostname resolution for the ForgeRock Identity Platform servers
you&#8217;ll deploy in your namespace.</p>
</div>
<div class="paragraph">
<p>Take the following actions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Determine whether DNS resolves the hostname,
<code><em>my-namespace</em>.iam.example.com</code>.</p>
</li>
<li>
<p>If DNS does not resolve the hostname, add an entry to the
<span class="path"><code>/etc/hosts</code></span> file similar to the following:</p>
<div class="listingblock">
<div class="content">
<pre><code><em>ingress-ip-address</em> <em>my-namespace</em>.iam.example.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <code><em>ingress-ip-address</em></code>, specify the IP address of your cluster&#8217;s ingress
controller that you
<a href="cdk/cloud/setup/gke/clusterinfo.html" class="page">obtained from your cluster administrator</a>.</p>
</div>
</li>
</ol>
</div>
<h3 id="next_step_15" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/clusterinfo.html" class="page">Get details about the shared GKE cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/gke/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/gke/docker.html" class="page">Prepare to push Docker images</a></mark></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="docker_push_setup"><a class="anchor" href="#docker_push_setup"></a><code>docker push</code> Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the environment you&#8217;re setting up, Skaffold builds Docker images using the
Docker software you&#8217;ve installed on your local computer. After it builds the
images, Skaffold pushes them to a Docker registry available to your GKE cluster.
With the images on the remote Docker registry, Skaffold can orchestrate the
ForgeRock Identity Platform, creating containers from the Docker images.</p>
</div>
<div class="paragraph">
<p>For Skaffold to be able to push the Docker images:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Docker must be running on your local computer.</p>
</li>
<li>
<p>Your local computer needs credentials that let Skaffold push the images to the
Docker registry available to your cluster.</p>
</li>
<li>
<p>Skaffold needs to know the location of the Docker registry.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Perform the following procedure:</p>
</div>
<div class="openblock procedure">
<div class="title">Set up Your Local Computer to Push Docker Images</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If it&#8217;s not already running, start Docker on your local computer. For more
information, see the Docker documentation.</p>
</li>
<li>
<p>Set up a Docker credential helper:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>gcloud auth configure-docker</strong></pre>
</div>
</div>
</li>
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command to obtain the Kubernetes context.</p>
</li>
<li>
<p>Configure Skaffold with the Docker registry location you
<a href="cdk/cloud/setup/gke/clusterinfo.html" class="page">obtained from your cluster administrator</a>
and the Kubernetes context you obtained in
<a href="cdk/cloud/setup/gke/context.html" class="page">Context for the Shared Cluster</a>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>skaffold config set default-repo <em>my-docker-registry</em> -k <em>my-kubernetes-context</em></strong></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_16" class="discrete">Next Step</h3>
<div class="paragraph">
<p>You&#8217;ve completed all the setup tasks required before deploying the
ForgeRock Identity Platform in a shared GKE cluster. Now you&#8217;re ready to deploy the
platform in your namespace on the shared cluster:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/intro.html" class="page">Become familiar with the CDK</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Understand CDK architecture (<a href="cdk/minikube/concepts.html" class="page">Minikube</a>|<a href="cdk/cloud/concepts.html" class="page">Shared Cluster</a>)</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Set up your local environment (<a href="cdk/minikube/setup/overview.html" class="page">Minikube</a>|<a href="cdk/cloud/setup/overview.html" class="page">Shared Cluster</a>)</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/deploy.html" class="page">Deploy the platform</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/access.html" class="page">Access platform UIs and APIs</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/develop.html" class="page">Develop custom Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="forgeops_repository_3"><a class="anchor" href="#forgeops_repository_3"></a><code>forgeops</code> Repository</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you can deploy the CDK or the CDM, you must first get the
<code>forgeops</code> repository:<sup class="footnote" id="_footnote_release-tag">[<a id="_footnoteref_12" class="footnote" href="#_footnotedef_12" title="View footnote.">12</a>]</sup></p>
</div>
<div class="openblock procedure">
<div class="title">Obtain the forgeops Repository</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone the <code>forgeops</code> repository:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git clone <a href="https://github.com/ForgeRock/forgeops.git" class="bare">https://github.com/ForgeRock/forgeops.git</a></strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>forgeops</code> repository is a public Git repository. You do not need
credentials to clone it.</p>
</div>
</li>
<li>
<p>Check out the <code>2020.10.28-AlSugoDiNoci</code> release tag, creating a branch named
<code><em>my-branch</em></code>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd forgeops</strong>
$ <strong>git checkout tags/2020.10.28-AlSugoDiNoci -b <em>my-branch</em></strong>
Switched to a new branch <em>'my-branch'</em></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_17" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/eks/sw.html" class="page">Install third-party software</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/clusterinfo.html" class="page">Get details about the shared EKS cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="third_party_software_3"><a class="anchor" href="#third_party_software_3"></a>Third-Party Software</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before installing the CDK, you must obtain non-ForgeRock software and
install it on your local computer.</p>
</div>
<div class="paragraph">
<p>ForgeRock recommends that you install third-party software using
<a href="https://brew.sh/">Homebrew</a> on macOS and Linux.</p>
</div>
<div class="paragraph">
<p>The versions listed in the tables below have been validated for building custom
Docker images for the ForgeRock Identity Platform. Earlier and later versions will
<em>probably</em> work. If you want to try using versions that are not in the tables,
it is your responsibility to validate them.</p>
</div>
<div class="paragraph">
<p>Install the following third-party software:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Software</th>
<th class="tableblock halign-left valign-top">Version</th>
<th class="tableblock halign-left valign-top">Homebrew package</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker Desktop<sup class="footnote" id="_footnote_docker">[<a id="_footnoteref_13" class="footnote" href="#_footnotedef_13" title="View footnote.">13</a>]</sup>
</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.3.0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker</code> (cask)<sup class="footnote" id="_footnote_linuxbrew">[<a id="_footnoteref_14" class="footnote" href="#_footnotedef_14" title="View footnote.">14</a>]</sup>
</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes client (<span class="command"><code>kubectl</code></span>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.19.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubernetes-cli</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Skaffold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.14.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skaffold</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kustomize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.8.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kustomize</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes context switcher (<span class="command"><code>kubectx</code></span>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubectx</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Amazon AWS Command Line Interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.0.53</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>awscli</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AWS IAM Authenticator for Kubernetes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>aws-iam-authenticator</code></p></td>
</tr>
</tbody>
</table>
<h3 id="next_step_18" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/eks/clusterinfo.html" class="page">Get details about the shared EKS cluster</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cluster_details_2"><a class="anchor" href="#cluster_details_2"></a>Cluster Details</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You&#8217;ll need to get some information about the cluster from your cluster
administrator. You&#8217;ll provide this information as you perform various tasks to
access the cluster.</p>
</div>
<div class="paragraph">
<p>Obtain the following cluster details:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Your AWS access key ID.</p>
</li>
<li>
<p>Your AWS secret access key.</p>
</li>
<li>
<p>The AWS region in which the cluster resides.</p>
</li>
<li>
<p>The cluster name.</p>
</li>
<li>
<p>The IP address of your cluster&#8217;s ingress controller.</p>
</li>
<li>
<p>The location of the Docker registry from which your cluster will obtain images
for the ForgeRock Identity Platform.</p>
</li>
</ul>
</div>
<h3 id="next_step_19" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/clusterinfo.html" class="page">Get details about the shared EKS cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/eks/context.html" class="page">Create a Kubernetes context</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="context_for_the_shared_cluster_2"><a class="anchor" href="#context_for_the_shared_cluster_2"></a>Context for the Shared Cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Kubernetes uses contexts to access Kubernetes clusters. Before you can access
the shared cluster, you must create a context on your local computer if it&#8217;s not
already present.</p>
</div>
<div class="paragraph">
<p>Perform the following procedure to create a context for the shared cluster:</p>
</div>
<div class="openblock procedure">
<div class="title">Create a Context for an EKS Cluster</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command and review the output. The current
Kubernetes context is highlighted:</p>
<div class="ulist">
<ul>
<li>
<p>If the current context references the shared cluster, there is nothing
further to do. Proceed to <a href="cdk/cloud/setup/eks/namespace.html" class="page">Namespace</a>.</p>
</li>
<li>
<p>If the context of the shared cluster is present in the
<span class="command"><code>kubectx</code></span> command output, set the context as follows:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectx <em>my-context</em></strong>
Switched to context "my-context".</pre>
</div>
</div>
<div class="paragraph">
<p>After you have set the context, proceed to
<a href="cdk/cloud/setup/eks/namespace.html" class="page">Namespace</a>.</p>
</div>
</li>
<li>
<p>If the context of the shared cluster is not present in the
<span class="command"><code>kubectx</code></span> command output, continue to the next step in this
procedure.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Run the <span class="command"><code>aws configure</code></span> command. This command logs you in to AWS
and sets the AWS region. Use the access key ID, secret access key, and region
you
<a href="cdk/cloud/setup/eks/clusterinfo.html" class="page">obtained from your cluster administrator</a>.
You do not need to specify a value for the default output
format:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>aws configure</strong>
AWS Access Key ID [None]:
AWS Secret Access Key [None]:
Default region name [None]:
Default output format [None]:</pre>
</div>
</div>
</li>
<li>
<p>Run the following command. Use the cluster name you
<a href="cdk/cloud/setup/eks/clusterinfo.html" class="page">obtained from your cluster administrator</a>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>aws eks update-kubeconfig --name <em>my-cluster</em></strong>
Added new context arn:aws:eks:us-east-1:813759318741:cluster/my-cluster
to /Users/my-user-name/.kube/config</pre>
</div>
</div>
</li>
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command again and verify that the context for
your Kubernetes cluster is now the current context.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>In Amazon EKS environments, the cluster owner must grant access to a user before
the user can access cluster resources. For details about how the cluster owner
can grant you access to the cluster, refer the cluster owner to
<a href="deployment/security.html#add-user-access" class="page">Cluster Access for Multiple AWS Users</a>.</p>
</div>
<h3 id="next_step_20" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/clusterinfo.html" class="page">Get details about the shared EKS cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/eks/namespace.html" class="page">Create a Kubernetes namespace</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="namespace_3"><a class="anchor" href="#namespace_3"></a>Namespace</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Create a namespace in the shared cluster. Namespaces let you isolate your
deployments from other developers' deployments.</p>
</div>
<div class="paragraph">
<p>ForgeRock recommends that you deploy the ForgeRock Identity Platform in a namespace other
than the <code>default</code> namespace. Deploying to a non-default namespace lets you
separate workloads in a cluster. Separating a workload into a namespace lets you
delete the workload easily; just delete the namespace.</p>
</div>
<div class="paragraph">
<p>Perform the following procedure to create a namespace:</p>
</div>
<div class="openblock procedure">
<div class="title">Create a Namespace</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a namespace in your Kubernetes cluster:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl create namespace <em>my-namespace</em></strong>
namespace/my-namespace created</pre>
</div>
</div>
</li>
<li>
<p>Make the new namespace your current namespace:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubens <em>my-namespace</em></strong>
Context "my-context" modified.
Active namespace is "my-namespace".</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_21" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/clusterinfo.html" class="page">Get details about the shared EKS cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/eks/hostname.html" class="page">Set up hostname resolution</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/eks/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="hostname_resolution_3"><a class="anchor" href="#hostname_resolution_3"></a>Hostname Resolution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You might need to set up hostname resolution for the ForgeRock Identity Platform servers
you&#8217;ll deploy in your namespace.</p>
</div>
<div class="paragraph">
<p>Take the following actions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Determine whether DNS resolves the hostname,
<code><em>my-namespace</em>.iam.example.com</code>.</p>
</li>
<li>
<p>If DNS does not resolve the hostname, add an entry to the
<span class="path"><code>/etc/hosts</code></span> file similar to the following:</p>
<div class="listingblock">
<div class="content">
<pre><code><em>ingress-ip-address</em> <em>my-namespace</em>.iam.example.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <code><em>ingress-ip-address</em></code>, specify the IP address of your cluster&#8217;s ingress
controller that you
<a href="cdk/cloud/setup/eks/clusterinfo.html" class="page">obtained from your cluster administrator</a>.</p>
</div>
</li>
</ol>
</div>
<h3 id="next_step_22" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/clusterinfo.html" class="page">Get details about the shared EKS cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/eks/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/eks/docker.html" class="page">Prepare to push Docker images</a></mark></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="docker_push_setup_2"><a class="anchor" href="#docker_push_setup_2"></a><code>docker push</code> Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the environment you&#8217;re setting up, Skaffold builds Docker images using the
Docker software you&#8217;ve installed on your local computer. After it builds the
images, Skaffold pushes them to a Docker registry available to your EKS cluster.
With the images on the remote Docker registry, Skaffold can orchestrate the
ForgeRock Identity Platform, creating containers from the Docker images.</p>
</div>
<div class="paragraph">
<p>For Skaffold to be able to push the Docker images:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Docker must be running on your local computer.</p>
</li>
<li>
<p>Your local computer needs credentials that let Skaffold push the images to the
Docker registry available to your cluster.</p>
</li>
<li>
<p>Skaffold needs to know the location of the Docker registry.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Perform the following procedure:</p>
</div>
<div class="openblock procedure">
<div class="title">Set up Your Local Computer to Push Docker Images</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If it&#8217;s not already running, start Docker on your local computer. For more
information, see the Docker documentation.</p>
</li>
<li>
<p>Log in to Amazon ECR. Use the Docker registry location you
<a href="cdk/cloud/setup/eks/clusterinfo.html" class="page">obtained from your cluster
administrator</a>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>aws ecr get-login-password | \
 docker login --username AWS --password-stdin <em>my-docker-registry</em></strong>
stdin my-docker-registry
Login Succeeded</pre>
</div>
</div>
<div class="paragraph">
<p>ECR login sessions expire after 12 hours. Because of this, you&#8217;ll need to
perform these steps again whenever your login session expires.<sup class="footnote">[<a id="_footnoteref_15" class="footnote" href="#_footnotedef_15" title="View footnote.">15</a>]</sup></p>
</div>
</li>
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command to obtain the Kubernetes context.</p>
</li>
<li>
<p>Configure Skaffold with the Docker registry location and the Kubernetes
context:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>skaffold config set default-repo <em>my-docker-registry</em> -k <em>my-kubernetes-context</em></strong></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_23" class="discrete">Next Step</h3>
<div class="paragraph">
<p>You&#8217;ve completed all the setup tasks required before deploying the
ForgeRock Identity Platform in a shared EKS cluster. Now you&#8217;re ready to deploy the
platform in your namespace on the shared cluster:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/intro.html" class="page">Become familiar with the CDK</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Understand CDK architecture (<a href="cdk/minikube/concepts.html" class="page">Minikube</a>|<a href="cdk/cloud/concepts.html" class="page">Shared Cluster</a>)</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Set up your local environment (<a href="cdk/minikube/setup/overview.html" class="page">Minikube</a>|<a href="cdk/cloud/setup/overview.html" class="page">Shared Cluster</a>)</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/deploy.html" class="page">Deploy the platform</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/access.html" class="page">Access platform UIs and APIs</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/develop.html" class="page">Develop custom Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="forgeops_repository_4"><a class="anchor" href="#forgeops_repository_4"></a><code>forgeops</code> Repository</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you can deploy the CDK or the CDM, you must first get the
<code>forgeops</code> repository:<sup class="footnote" id="_footnote_release-tag">[<a id="_footnoteref_16" class="footnote" href="#_footnotedef_16" title="View footnote.">16</a>]</sup></p>
</div>
<div class="openblock procedure">
<div class="title">Obtain the forgeops Repository</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone the <code>forgeops</code> repository:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git clone <a href="https://github.com/ForgeRock/forgeops.git" class="bare">https://github.com/ForgeRock/forgeops.git</a></strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>forgeops</code> repository is a public Git repository. You do not need
credentials to clone it.</p>
</div>
</li>
<li>
<p>Check out the <code>2020.10.28-AlSugoDiNoci</code> release tag, creating a branch named
<code><em>my-branch</em></code>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd forgeops</strong>
$ <strong>git checkout tags/2020.10.28-AlSugoDiNoci -b <em>my-branch</em></strong>
Switched to a new branch <em>'my-branch'</em></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_24" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/aks/sw.html" class="page">Install third-party software</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/clusterinfo.html" class="page">Get details about the shared AKS cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="third_party_software_4"><a class="anchor" href="#third_party_software_4"></a>Third-Party Software</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before installing the CDK, you must obtain non-ForgeRock software and
install it on your local computer.</p>
</div>
<div class="paragraph">
<p>ForgeRock recommends that you install third-party software using
<a href="https://brew.sh/">Homebrew</a> on macOS and Linux.</p>
</div>
<div class="paragraph">
<p>The versions listed in the tables below have been validated for building custom
Docker images for the ForgeRock Identity Platform. Earlier and later versions will
<em>probably</em> work. If you want to try using versions that are not in the tables,
it is your responsibility to validate them.</p>
</div>
<div class="paragraph">
<p>Install the following third-party software:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Software</th>
<th class="tableblock halign-left valign-top">Version</th>
<th class="tableblock halign-left valign-top">Homebrew package</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker Desktop<sup class="footnote" id="_footnote_docker">[<a id="_footnoteref_17" class="footnote" href="#_footnotedef_17" title="View footnote.">17</a>]</sup>
</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.3.0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker</code> (cask)<sup class="footnote" id="_footnote_linuxbrew">[<a id="_footnoteref_18" class="footnote" href="#_footnotedef_18" title="View footnote.">18</a>]</sup>
</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes client (<span class="command"><code>kubectl</code></span>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.19.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubernetes-cli</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Skaffold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.14.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skaffold</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kustomize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.8.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kustomize</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes context switcher (<span class="command"><code>kubectx</code></span>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubectx</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Azure Command Line Interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.11.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>azure-cli</code></p></td>
</tr>
</tbody>
</table>
<h3 id="next_step_25" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/aks/clusterinfo.html" class="page">Get details about the shared AKS cluster</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cluster_details_3"><a class="anchor" href="#cluster_details_3"></a>Cluster Details</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You&#8217;ll need to get some information about the cluster from your cluster
administrator. You&#8217;ll provide this information as you perform various tasks to
access the cluster.</p>
</div>
<div class="paragraph">
<p>Obtain the following cluster details:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The ID of the Azure subscription that contains the cluster. Be sure to obtain
the hexadecimal subscription ID, not the subscription name.</p>
</li>
<li>
<p>The name of the resource group that contains the cluster.</p>
</li>
<li>
<p>The cluster name.</p>
</li>
<li>
<p>The IP address of your cluster&#8217;s ingress controller.</p>
</li>
<li>
<p>The location of the Docker registry from which your cluster will obtain images
for the ForgeRock Identity Platform.</p>
</li>
</ul>
</div>
<h3 id="next_step_26" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/clusterinfo.html" class="page">Get details about the shared AKS cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/aks/context.html" class="page">Create a Kubernetes context</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="context_for_the_shared_cluster_3"><a class="anchor" href="#context_for_the_shared_cluster_3"></a>Context for the Shared Cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Kubernetes uses contexts to access Kubernetes clusters. Before you can access
the shared cluster, you must create a context on your local computer if it&#8217;s not
already present.</p>
</div>
<div class="paragraph">
<p>Perform the following procedure to create a context for the shared cluster:</p>
</div>
<div class="openblock procedure">
<div class="title">Create a Context for an AKS Cluster</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command and review the output. The current
Kubernetes context is highlighted:</p>
<div class="ulist">
<ul>
<li>
<p>If the current context references the shared cluster, there is nothing
further to do. Proceed to <a href="cdk/cloud/setup/aks/namespace.html" class="page">Namespace</a>.</p>
</li>
<li>
<p>If the context of the shared cluster is present in the <span class="command"><code>kubectx</code></span>
command output, set the context as follows:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectx <em>my-context</em></strong>
Switched to context "my-context".</pre>
</div>
</div>
<div class="paragraph">
<p>After you have set the context, proceed to
<a href="cdk/cloud/setup/aks/namespace.html" class="page">Namespace</a>.</p>
</div>
</li>
<li>
<p>If the context of the shared cluster is not present in the
<span class="command"><code>kubectx</code></span> command output, continue to the next step in this
procedure.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Configure the Azure CLI to use your Microsoft Azure. Run the following
command:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>az login</strong></pre>
</div>
</div>
</li>
<li>
<p>A browser window prompts you to log in to Azure. Log in using your Microsoft
account.</p>
<div class="paragraph">
<p>A second screen should appear with the message, "You have logged into Microsoft
Azure!"</p>
</div>
</li>
<li>
<p>Return to the terminal window and run the following command. Use the resource
group, cluster name, and subscription ID you
<a href="cdk/cloud/setup/aks/clusterinfo.html" class="page">obtained from your cluster administrator</a>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>az aks get-credentials \
 --resource-group my-fr-resource-group \
 --name my-fr-cluster \
 --subscription your subscription ID \
 --overwrite-existing</strong></pre>
</div>
</div>
</li>
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command again and verify that the context for
your Kubernetes cluster is now the current context.</p>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_27" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/clusterinfo.html" class="page">Get details about the shared AKS cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/aks/namespace.html" class="page">Create a Kubernetes namespace</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="namespace_4"><a class="anchor" href="#namespace_4"></a>Namespace</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Create a namespace in the shared cluster. Namespaces let you isolate your
deployments from other developers' deployments.</p>
</div>
<div class="paragraph">
<p>ForgeRock recommends that you deploy the ForgeRock Identity Platform in a namespace other
than the default namespace. Deploying to a non-default namespace lets you
separate workloads in a cluster. Separating a workload into a namespace lets you
delete the workload easily; just delete the namespace.</p>
</div>
<div class="paragraph">
<p>Perform the following procedure to create a namespace:</p>
</div>
<div class="openblock procedure">
<div class="title">Create a Namespace</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a namespace in your Kubernetes cluster:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl create namespace <em>my-namespace</em></strong>
namespace/my-namespace created</pre>
</div>
</div>
</li>
<li>
<p>Make the new namespace your current namespace:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubens <em>my-namespace</em></strong>
Context "my-context" modified.
Active namespace is "my-namespace".</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_28" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/clusterinfo.html" class="page">Get details about the shared AKS cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/aks/hostname.html" class="page">Set up hostname resolution</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/cloud/setup/aks/docker.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="hostname_resolution_4"><a class="anchor" href="#hostname_resolution_4"></a>Hostname Resolution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You might need to set up hostname resolution for the ForgeRock Identity Platform servers
you&#8217;ll deploy in your namespace.</p>
</div>
<div class="paragraph">
<p>Take the following actions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Determine whether DNS resolves the hostname,
<code><em>my-namespace</em>.iam.example.com</code>.</p>
</li>
<li>
<p>If DNS does not resolve the hostname, add an entry to the
<span class="path"><code>/etc/hosts</code></span> file similar to the following:</p>
<div class="listingblock">
<div class="content">
<pre><code><em>ingress-ip-address</em> <em>my-namespace</em>.iam.example.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <code><em>ingress-ip-address</em></code>, specify the IP address of your cluster&#8217;s ingress
controller that you
<a href="cdk/cloud/setup/aks/clusterinfo.html" class="page">obtained from your cluster administrator</a>.</p>
</div>
</li>
</ol>
</div>
<h3 id="next_step_29" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/clusterinfo.html" class="page">Get details about the shared AKS cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/context.html" class="page">Create a Kubernetes context</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/namespace.html" class="page">Create a Kubernetes namespace</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/cloud/setup/aks/hostname.html" class="page">Set up hostname resolution</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/cloud/setup/aks/docker.html" class="page">Prepare to push Docker images</a></mark></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="docker_push_setup_3"><a class="anchor" href="#docker_push_setup_3"></a><code>docker push</code> Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the environment you&#8217;re setting up, Skaffold builds Docker images using the
Docker software you&#8217;ve installed on your local computer. After it builds the
images, Skaffold pushes them to a Docker registry available to your AKS cluster.
With the images on the remote Docker registry, Skaffold can orchestrate the
ForgeRock Identity Platform, creating containers from the Docker images.</p>
</div>
<div class="paragraph">
<p>For Skaffold to be able to push the Docker images:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Docker must be running on your local computer.</p>
</li>
<li>
<p>Your local computer needs credentials that let Skaffold push the images to the
Docker registry available to your cluster.</p>
</li>
<li>
<p>Skaffold needs to know the location of the Docker registry.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Perform the following procedure:</p>
</div>
<div class="openblock procedure">
<div class="title">Set up Your Local Computer to Push Docker Images</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If it&#8217;s not already running, start Docker on your local computer. For more
information, see the Docker documentation.</p>
</li>
<li>
<p>Install the <a href="https://github.com/Azure/acr-docker-credential-helper">ACR Docker
Credential Helper</a>.</p>
</li>
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command to obtain the Kubernetes context.</p>
</li>
<li>
<p>Configure Skaffold with the Docker registry location you
<a href="cdk/cloud/setup/aks/clusterinfo.html" class="page">obtained from your cluster administrator</a>
and the Kubernetes context you obtained in
<a href="cdk/cloud/setup/aks/context.html" class="page">Context for the Shared Cluster</a>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>skaffold config set default-repo <em>my-docker-registry</em> -k <em>my-kubernetes-context</em></strong></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_30" class="discrete">Next Step</h3>
<div class="paragraph">
<p>You&#8217;ve completed all the setup tasks required before deploying the
ForgeRock Identity Platform in a shared AKS cluster. Now you&#8217;re ready to deploy the
platform in your namespace on the shared cluster:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/intro.html" class="page">Become familiar with the CDK</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Understand CDK architecture (<a href="cdk/minikube/concepts.html" class="page">Minikube</a>|<a href="cdk/cloud/concepts.html" class="page">Shared Cluster</a>)</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Set up your local environment (<a href="cdk/minikube/setup/overview.html" class="page">Minikube</a>|<a href="cdk/cloud/setup/overview.html" class="page">Shared Cluster</a>)</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/deploy.html" class="page">Deploy the platform</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/access.html" class="page">Access platform UIs and APIs</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/develop.html" class="page">Develop custom Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdk_deployment"><a class="anchor" href="#cdk_deployment"></a>CDK Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After you&#8217;ve set up your development environment, your next step is to deploy
the platform.</p>
</div>
<div class="paragraph">
<p>Perform the following procedure to deploy the ForgeRock Identity Platform in your namespace:</p>
</div>
<div class="openblock procedure">
<div class="title">Deploy the ForgeRock Identity Platform</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Change the deployment namespace for the <code>all</code> environment from the <code>default</code>
namespace to your namespace:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the directory containing the <code>all</code> environment:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/kustomize/overlay/7.0/all</strong></pre>
</div>
</div>
</li>
<li>
<p>Open the <span class="path"><code>kustomization.yaml</code></span> file.</p>
</li>
<li>
<p>Modify two lines in the file so that the platform is deployed in your
namespace:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Original Text</th>
<th class="tableblock halign-left valign-top">Revised Text</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>namespace: default</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>namespace: <em>my-namespace</em></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FQDN: "default.iam.example.com"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FQDN: "<em>my-namespace</em>.iam.example.com"</code></p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Save the updated <span class="path"><code>kustomization.yaml</code></span> file.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Initialize the staging area for configuration profiles with the canonical
CDK configuration profile for the ForgeRock Identity Platform:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/bin</strong>
$ <strong>./config.sh init --profile cdk --version 7.0</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <span class="command"><code>config.sh init</code></span> command copies the canonical CDK
configuration profile from the master directory for configuration profiles to
the staging area:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/config-sh.init.svg" alt="This diagram shows how the staging area is initialized from the canonical ${cdk.abbr} profile.">
</div>
</div>
<div class="paragraph">
<p>For more information about the management of ForgeRock Identity Platform configuration
profiles in the <code>forgeops</code> repository, see
<a href="cdk/develop.html#configuration-profiles" class="page">Configuration Profiles</a>.</p>
</div>
</li>
<li>
<p>Run Skaffold to build Docker images and deploy the ForgeRock Identity Platform:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops</strong>
$ <strong>skaffold run</strong></pre>
</div>
</div>
</li>
<li>
<p>In a separate terminal tab or window, run the <span class="command"><code>kubectl get pods</code></span>
command to monitor status of the deployment. Wait until all the pods are ready.</p>
<div class="paragraph">
<p>Your namespace should have the pods shown in
<a href="cdk/minikube/concepts.html#minikube-pods" class="page">this diagram</a>.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_31" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/intro.html" class="page">Become familiar with the CDK</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Understand CDK architecture (<a href="cdk/minikube/concepts.html" class="page">Minikube</a>|<a href="cdk/cloud/concepts.html" class="page">Shared Cluster</a>)</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Set up your local environment (<a href="cdk/minikube/setup/overview.html" class="page">Minikube</a>|<a href="cdk/cloud/setup/overview.html" class="page">Shared Cluster</a>)</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/deploy.html" class="page">Deploy the platform</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/access.html" class="page">Access platform UIs and APIs</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdk/develop.html" class="page">Develop custom Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ui_and_api_access"><a class="anchor" href="#ui_and_api_access"></a>UI and API Access</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that you&#8217;ve
<a href="cdk/deploy.html" class="page">deployed the ForgeRock Identity Platform</a>, you&#8217;ll need to know how
to access its administration tools. You&#8217;ll use these tools to build customized
Docker images for the platform.</p>
</div>
<div class="paragraph">
<p>This page shows you how to access the ForgeRock Identity Platform&#8217;s administrative
consoles and REST APIs.</p>
</div>
<div class="paragraph">
<p>You access AM and IDM services through the Kubernetes ingress
controller. Access components using their normal interfaces:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For AM, the console and REST APIs.</p>
</li>
<li>
<p>For IDM, the Admin UI and REST APIs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can&#8217;t access DS through the ingress controller, but you can use
Kubernetes methods to access the DS pods.</p>
</div>
<div class="paragraph">
<p>For more information about how AM and IDM are configured in the
CDK, see
<a href="https://github.com/ForgeRock/forgeops/blob/master/README.md#configuration">Configuration</a>
in the <code>forgeops</code> repository&#8217;s top-level README file.</p>
</div>
<div class="sect2">
<h3 id="am-services-cdk"><a class="anchor" href="#am-services-cdk"></a>AM Services</h3>
<div class="paragraph">
<p>Access the AM console and REST APIs as follows:</p>
</div>
<div class="openblock procedure">
<div class="title">Access the AM Console</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that your namespace is the current namespace:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubens <em>my-namespace</em></strong></pre>
</div>
</div>
</li>
<li>
<p>Obtain the <code>amadmin</code> user&#8217;s password:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/bin</strong>
$ <strong>./print-secrets.sh amadmin</strong>
<span class="cyan-hl">179rd8en9rffa82rcf1qap1z0gv1hcej</span></pre>
</div>
</div>
</li>
<li>
<p>Open a new window or tab in a web browser.</p>
</li>
<li>
<p>Go to https://<em>my-namespace</em>.iam.example.com/platform.</p>
<div class="paragraph">
<p>The Kubernetes ingress controller handles the request, routing it to the
<code>login-ui</code> pod.</p>
</div>
<div class="paragraph">
<p>The login UI prompts you to log in.</p>
</div>
</li>
<li>
<p>Log in as the <code>amadmin</code> user.</p>
<div class="paragraph">
<p>The ForgeRock Identity Platform UI appears in the browser.</p>
</div>
</li>
<li>
<p>Select Native Consoles &gt; Access Management.</p>
<div class="paragraph">
<p>The AM console appears in the browser.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="openblock procedure">
<div class="title">Access the AM REST APIs</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start a terminal window session.</p>
</li>
<li>
<p>Run a <span class="command"><code>curl</code></span> command to verify that you can access the REST APIs
through the ingress controller. For example:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>curl \
 --insecure \
 --request POST \
 --header "Content-Type: application/json" \
 --header "X-OpenAM-Username: amadmin" \
 --header "X-OpenAM-Password: <span class="cyan-hl">179rd8en9rffa82rcf1qap1z0gv1hcej</span>" \
 --header "Accept-API-Version: resource=2.0" \
 --data "{}" \
 "https://my-namespace.iam.example.com/am/json/realms/root/authenticate"</strong>
{
    "tokenId":"AQIC5wM2. . .TU3OQ*",
    "successUrl":"/am/console",
    "realm":"/"
}</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="idm-services"><a class="anchor" href="#idm-services"></a>IDM Services</h3>
<div class="paragraph">
<p>Access the IDM Admin UI and REST APIs as follows:</p>
</div>
<div class="openblock procedure">
<div class="title">Access the IDM Admin UI</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that your namespace is the current namespace:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubens <em>my-namespace</em></strong></pre>
</div>
</div>
</li>
<li>
<p>Obtain the <code>amadmin</code> user&#8217;s password:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/bin</strong>
$ <strong>./print-secrets.sh amadmin</strong>
<span class="cyan-hl">vr58qt11ihoa31zfbjsdxxrqryfw0s31</span></pre>
</div>
</div>
</li>
<li>
<p>Open a new window or tab in a web browser.</p>
</li>
<li>
<p>Go to https://<em>my-namespace</em>.iam.example.com/platform.</p>
<div class="paragraph">
<p>The Kubernetes ingress controller handles the request, routing it to the
<code>login-ui</code> pod.</p>
</div>
<div class="paragraph">
<p>The login UI prompts you to log in.</p>
</div>
</li>
<li>
<p>Log in as the <code>amadmin</code> user.</p>
<div class="paragraph">
<p>The ForgeRock Identity Platform UI appears in the browser.</p>
</div>
</li>
<li>
<p>Select Native Consoles &gt; Identity Management.</p>
<div class="paragraph">
<p>The IDM Admin UI appears in the browser.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="openblock procedure">
<div class="title">Access the IDM REST APIs</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start a terminal window session.</p>
</li>
<li>
<p>If you haven&#8217;t already done so, get the <code>amadmin</code> user&#8217;s password using the
<span class="command"><code>print-secrets.sh</code></span> command.</p>
</li>
<li>
<p>AM authorizes IDM REST API access using the
<a href="https://ea.forgerock.com/docs/am/oauth2-guide/oauth2-authz-grant.html">OAuth 2.0 authorization code
flow</a>. The CDK comes with the <code>idm-admin-ui</code> client,
which is configured to let you get a bearer token using this OAuth 2.0 flow.
You&#8217;ll use the bearer token in the next step to access the IDM REST API:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Get a session token for the <code>amadmin</code> user:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>curl \
 --request POST \
 --insecure \
 --header "Content-Type: application/json" \
 --header "X-OpenAM-Username: amadmin" \
 --header "X-OpenAM-Password: <span class="cyan-hl">vr58qt11ihoa31zfbjsdxxrqryfw0s31</span>" \
 --header "Accept-API-Version: resource=2.0, protocol=1.0" \
 "https://<em>my-namespace</em>.iam.example.com/am/json/realms/root/authenticate"</strong>
{
 "tokenId":"<span class="pink-hl">AQIC5wM. . .TU3OQ*</span>",
 "successUrl":"/am/console",
 "realm":"/"}</pre>
</div>
</div>
</li>
<li>
<p>Get an authorization code. Specify the ID of the session token that you
obtained in the previous step in the <code>--Cookie</code> parameter:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>curl \
 --dump-header - \
 --insecure \
 --request GET \
 --Cookie "iPlanetDirectoryPro=<span class="pink-hl">AQIC5wM. . .TU3OQ*</span>" \
 "https://<em>my-namespace</em>.iam.example.com/am/oauth2/realms/root/authorize?redirect_uri=https://<em>my-namespace</em>.iam.example.com/platform/appAuthHelperRedirect.html&amp;client_id=idm-admin-ui&amp;scope=openid%20fr:idm:*&amp;response_type=code&amp;state=abc123"</strong>
HTTP/2 302
server: nginx/1.17.10
date: Tue, 21 Jul 2020 16:54:20 GMT
content-length: 0
location: https://<em>my-namespace</em>.iam.example.com/platform/appAuthHelperRedirect.html
 ?code=<span class="green-hl">3cItL9G52DIiBdfXRngv2_dAaYM</span>&amp;iss=http://<em>my-namespace</em>.iam.example.com:80/am/oauth2&amp;state=abc123
 &amp;client_id=idm-admin-ui
set-cookie: route=1595350461.029.542.7328; Path=/am; Secure; HttpOnly
x-frame-options: SAMEORIGIN
x-content-type-options: nosniff
cache-control: no-store
pragma: no-cache
set-cookie: OAUTH_REQUEST_ATTRIBUTES=DELETED; Expires=Thu, 01 Jan 1970 00:00:00 GMT; Path=/; HttpOnly
strict-transport-security: max-age=15724800; includeSubDomains</pre>
</div>
</div>
</li>
<li>
<p>Exchange the authorization code for an access token. Specify the access code
that you obtained in the previous step in the <code>code</code> URL parameter:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>curl --request POST \
 --insecure \
 --data "grant_type=authorization_code" \
 --data "code=<span class="green-hl">3cItL9G52DIiBdfXRngv2_dAaYM</span>" \
 --data "client_id=idm-admin-ui" \
 --data "redirect_uri=https://<em>my-namespace</em>.iam.example.com/platform/appAuthHelperRedirect.html" \
 "https://<em>my-namespace</em>.iam.example.com/am/oauth2/realms/root/access_token" </strong>
{
 "access_token":"<span class="orange-hl">oPzGzGFY1SeP2RkI-ZqaRQC1cDg</span>",
 "scope":"openid fr:idm:*",
 "id_token":"eyJ0eXAiOiJKV
  . . .
  sO4HYqlQ",
 "token_type":"Bearer",
 "expires_in":239
}</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Run a <span class="command"><code>curl</code></span> command to verify that you can access the
<code>openidm/config</code> REST endpoint through the ingress controller. Use the
access token returned in the previous step as the bearer token in the
authorization header.</p>
<div class="paragraph">
<p>The following example command provides information about the IDM
configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>curl \
 --insecure \
 --request GET \
 --header "Authorization: Bearer <span class="orange-hl">oPzGzGFY1SeP2RkI-ZqaRQC1cDg</span>" \
 --data "{}" \
 https://<em>my-namespace</em>.iam.example.com/openidm/config</strong>
{
 "_id":"",
 "configurations":
  [
   {
    "_id":"ui.context/admin",
    "pid":"ui.context.4f0cb656-0b92-44e9-a48b-76baddda03ea",
    "factoryPid":"ui.context"
    },
    . . .
   ]
}</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="directory_services"><a class="anchor" href="#directory_services"></a>Directory Services</h3>
<div class="paragraph">
<p>The DS pods in the CDK are not exposed outside of the cluster. If
you need to access one of the DS pods, use a standard Kubernetes method:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Execute shell commands in DS pods using the <span class="command"><code>kubectl exec</code></span>
command.</p>
</li>
<li>
<p>Forward a DS pod&#8217;s LDAPS port (1636) to your local computer. Then, you
can run LDAP CLI commands like <span class="command"><code>ldapsearch</code></span>. You can also use an
LDAP editor such as Apache Directory Studio to access the directory.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For all CDM directory pods, the directory superuser DN is <code>uid=admin</code>.
Obtain this user&#8217;s password by running the <strong>print-secrets.sh dsadmin</strong> command.</p>
</div>
<h3 id="next_step_32" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/intro.html" class="page">Become familiar with the CDK</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Understand CDK architecture (<a href="cdk/minikube/concepts.html" class="page">Minikube</a>|<a href="cdk/cloud/concepts.html" class="page">Shared Cluster</a>)</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Set up your local environment (<a href="cdk/minikube/setup/overview.html" class="page">Minikube</a>|<a href="cdk/cloud/setup/overview.html" class="page">Shared Cluster</a>)</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/deploy.html" class="page">Deploy the platform</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdk/access.html" class="page">Access platform UIs and APIs</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdk/develop.html" class="page">Develop custom Docker images</a></mark></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="custom_docker_image_development"><a class="anchor" href="#custom_docker_image_development"></a>Custom Docker Image Development</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you can develop custom Docker images, you must have
<a href="cdk/deploy.html" class="page">deployed the ForgeRock Identity Platform</a> and
<a href="cdk/access.html" class="page">learned how to access its administration GUIs
and REST APIs</a>. Now you&#8217;re ready to configure the platform to meet your needs.
As you configure the platform, you can decide at any point to build new
custom Docker images that will incorporate the configuration changes you&#8217;ve
made.</p>
</div>
<div class="paragraph">
<p>When you develop custom Docker images, you iterate on the following process:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access AM and IDM running in the CDK, and customize them
using their GUIs and REST APIs.</p>
</li>
<li>
<p>Export your customizations from the CDK to a Git repository on your
local computer.</p>
</li>
<li>
<p>Rebuild the Docker images for the platform with your new
customizations.</p>
</li>
<li>
<p>Redeploy the platform on the CDK.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before you build customized Docker images for the platform, be sure
you&#8217;re familiar with the <a href="#fr-data">types of data used by the platform</a>.
This conceptual information helps you understand which type of data is included
in custom Docker images.</p>
</div>
<div class="paragraph">
<p>To develop customized Docker images, start with base images and a canonical
configuration profile from ForgeRock. Then, build up a configuration profile,
customizing the platform to meet your needs. The configuration profile is
integrated into the customized Docker image:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/containerization-dev.svg" alt="Brief overview of containers for developers.">
</div>
</div>
<div class="paragraph">
<p>Before you deploy the platform in production, you must change from using
ForgeRock&#8217;s evaluation-only base images to using base images you build yourself.
Building your own base images is covered in
<a href="deployment/base-docker-images.html" class="page">Base Docker Images</a>.</p>
</div>
<div class="sect2">
<h3 id="custom_images_for_am"><a class="anchor" href="#custom_images_for_am"></a>Custom Images for AM</h3>
<div class="paragraph">
<p>AM uses two Docker images, <code>am</code> and
<code>amster</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>am</code> image contains your custom AM
configuration.</p>
</li>
<li>
<p>The <code>amster</code> image contains your custom AM
run-time data.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With AM up and running, you can iteratively update the
<code>am</code> Docker image:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Customize AM&#8217;s configuration and run-time data using the console and
the REST APIs.</p>
</li>
<li>
<p>Capture changes to the AM configuration by synchronizing them from the
AM service running on Kubernetes back to the staging area and the master
directory for configuration profiles in your <code>forgeops</code> repository clone.</p>
</li>
<li>
<p>Run Skaffold to detect the changes, rebuild the <code>am</code>
Docker image, and restart AM. You can then test changes you&#8217;ve made to
the AM configuration based on the updated Docker image.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also iteratively update the
<code>amster</code> image:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Capture changes to AM run-time data by synchronizing the changes from
the AM service running on Kubernetes back to the staging area and the
master directory for configuration profiles in your <code>forgeops</code> repository clone.</p>
<div class="paragraph">
<p>AM run-time data includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>OAuth 2.0 clients</p>
</li>
<li>
<p>OpenID Connect 1.0 clients</p>
</li>
<li>
<p>IG, Web, Java, and SOAP STS agents</p>
</li>
<li>
<p>Policies</p>
</li>
<li>
<p>SAML v2.0 circles of trust and entities</p>
</li>
</ul>
</div>
</li>
<li>
<p>Run Skaffold to detect the changes and rebuild the
<code>amster</code> Docker image.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="am_image"><a class="anchor" href="#am_image"></a><code>am</code> Image</h4>
<div class="paragraph">
<p>The <code>am</code> Docker image contains the AM
configuration.</p>
</div>
<div class="paragraph">
<p>Perform the following procedure iteratively when developing a customized
<code>am</code> Docker image:</p>
</div>
<div class="openblock procedure">
<div class="title">Create a Customized <code>am</code> Docker Image</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Perform version control activities on your <code>forgeops</code> repository clone:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Run the <span class="command"><code>git status</code></span> command.</p>
</li>
<li>
<p>Review the state of the working directory and staging area.</p>
</li>
<li>
<p>(Optional) Run the <span class="command"><code>git commit</code></span> command to commit changes to files that
have been modified.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Modify the AM configuration using the AM console or the REST
APIs.</p>
<div class="paragraph">
<p>For information about how to access the AM Admin UI or REST APIs, see
<a href="cdk/access.html#am-services-cdk" class="page">AM Services</a>.</p>
</div>
</li>
<li>
<p>Export the changes you made to the AM configuration to your <code>forgeops</code>
repository clone:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/bin</strong>
$ <strong>./config.sh export --component am --version 7.0</strong>
Exporting AM configuration..

Any changed configuration files have been exported into
docker/7.0/am/config. Check any changed files before saving back to the config
folder to ensure correct formatting/functionality.</pre>
</div>
</div>
<div class="paragraph">
<p>The <span class="command"><code>config.sh export</code></span> command exports the modified parts of the
AM configuration from the running ForgeRock Identity Platform to the
<span class="path"><code>docker/7.0/am/config</code></span> directory.</p>
</div>
</li>
<li>
<p>Verify the changed files using the <span class="command"><code>config.sh diff -c am</code></span> command.</p>
<div class="paragraph">
<p>If any of the files contain hard-coded host names or passwords, replace them
with configuration expressions. AM resolves configuration expressions
when it starts up.</p>
</div>
<div class="paragraph">
<p>See <a href="#value-substitution">Property Value Substitution</a> for important information about
configuring values that vary at run-time, such as passwords and host names, in
containerized deployments.</p>
</div>
</li>
<li>
<p>After you&#8217;ve replaced all the hard-coded host names and passwords in exported
files with configuration expressions, copy the exported files to your
configuration profile.</p>
<div class="paragraph">
<p>For more information about the management of ForgeRock Identity Platform configurations in
the <code>forgeops</code> repository, see
<a href="#configuration-profiles">Configuration Profiles</a>.</p>
</div>
</li>
<li>
<p>Perform version control activities on your <code>forgeops</code> repository clone:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Run the <span class="command"><code>git status</code></span> command.</p>
</li>
<li>
<p>Review the state of the working directory and staging area.</p>
</li>
<li>
<p>(Optional) Run the <span class="command"><code>git commit</code></span> command to commit changes to
files that have been modified.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Reinitialize the staging area with your configuration profile:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/bin</strong>
$ <strong>./config.sh init --profile <em>my-profile</em> --component am --version 7.0</strong></pre>
</div>
</div>
</li>
<li>
<p>Execute the <span class="command"><code>skaffold run</code></span> command:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops</strong>
$ <strong>skaffold run</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Skaffold builds a new <code>am</code> Docker image and redeploys
AM.</p>
</div>
</li>
<li>
<p>To validate that AM has the expected configuration, start the console
and verify that your configuration changes are present.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="amster_image"><a class="anchor" href="#amster_image"></a><code>amster</code> Image</h4>
<div class="paragraph">
<p>The <code>amster</code> Docker image contains AM run-time
data.</p>
</div>
<div class="paragraph">
<p>Perform the following procedure iteratively when developing a customized
<code>amster</code> Docker image:</p>
</div>
<div class="openblock procedure">
<div class="title">Create a Customized <code>amster</code> Docker Image</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Perform version control activities on your <code>forgeops</code> repository clone:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Run the <span class="command"><code>git status</code></span> command.</p>
</li>
<li>
<p>Review the state of the working directory and staging area.</p>
</li>
<li>
<p>(Optional) Run the <span class="command"><code>git commit</code></span> command to commit changes to files that
have been modified.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Modify AM run-time data using the AM console or the REST APIs.</p>
<div class="paragraph">
<p>For information about how to access the AM console or REST APIs, see
<a href="cdk/access.html#am-services-cdk" class="page">AM Services</a>.</p>
</div>
<div class="paragraph">
<p>AM run-time data includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>OAuth 2.0 clients</p>
</li>
<li>
<p>OpenID Connect 1.0 clients</p>
</li>
<li>
<p>IG, Web, Java, and SOAP STS agents</p>
</li>
<li>
<p>Policies</p>
</li>
<li>
<p>SAML v2.0 circles of trust and entities</p>
</li>
</ul>
</div>
</li>
<li>
<p>Synchronize the changes you made to the AM configuration to your
configuration profile in your <code>forgeops</code> repository clone:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/bin</strong>
$ <strong>./config.sh sync --profile <em>my-profile</em> --component amster --version 7.0</strong>
Exporting Amster configuration&#8230;&#8203;

Skaffold is used to run the export job. Ensure your default-repo is set.

Removing any existing Amster jobs&#8230;&#8203;
job.batch "amster" deleted
Deploying Amster job&#8230;&#8203;
Waiting for Amster pod to come up.
No resources found in david namespace.
Amster job is responding..

Executing Amster export within the amster pod
kubectl exec [POD] [COMMAND] is DEPRECATED and will be removed in a future
version. Use kubectl kubectl exec [POD]&#8201;&#8212;&#8201;[COMMAND] instead.

Amster OpenAM Shell (7.0.0-SNAPSHOT build @build.number@, JVM: 11.0.8)
Type ':help' or ':h' for help.
-----------------------------------------------------------------------------
am&gt; :load /tmp/do_export.amster
Export completed successfully
Copying the export to the ./tmp directory
tar: Removing leading `/' from member names
Dynamic config exported

Shutting down Amster job&#8230;&#8203;

Saving Amster configuration..


<strong>* APPLYING FIXES </strong>*
Adding back amsterVersion placeholder &#8230;&#8203;
Adding back FQDN placeholder &#8230;&#8203;
Removing 'userpassword-encrypted' fields &#8230;&#8203;
Add back password placeholder with defaults

<strong>* The above fixes have been made to the Amster files. If you have exported new
files that should contain commons placeholders or passwords, please update the
rules in this script.</strong>*</pre>
</div>
</div>
<div class="paragraph">
<p>The <span class="command"><code>config.sh sync</code></span> command exports the modified AM
configuration profile from the running ForgeRock Identity Platform to the staging area.
Then, it saves the configuration profile as <code><em>my-profile</em></code> in the master
directory for configuration profiles:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/config-sh.sync.svg" alt="This diagram shows how the config.sh command synchronizes a configuration profile.">
</div>
</div>
<div class="paragraph">
<p>For more information about the management of ForgeRock Identity Platform configuration
profiles in the <code>forgeops</code> repository, see
<a href="#configuration-profiles">Configuration Profiles</a>.</p>
</div>
</li>
<li>
<p>Examine each JSON file that was written to your configuration profile.</p>
<div class="paragraph">
<p>If any of the files contain hard-coded host names or passwords, replace them
with configuration expressions. AM resolves configuration expressions
when it starts up.</p>
</div>
<div class="paragraph">
<p>See <a href="#value-substitution">Property Value Substitution</a> for important information about
configuring values that vary at run-time, such as passwords and host names, in
containerized deployments.</p>
</div>
</li>
<li>
<p>Perform version control activities on your <code>forgeops</code> repository clone:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Run the <span class="command"><code>git status</code></span> command.</p>
</li>
<li>
<p>Review the state of the working directory and staging area.</p>
</li>
<li>
<p>(Optional) Run the <span class="command"><code>git commit</code></span> command to commit changes to files that
have been modified.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Reinitialize the staging area with your configuration profile:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/bin</strong>
$ <strong>./config.sh init --profile <em>my-profile</em> --component amster --version 7.0</strong></pre>
</div>
</div>
</li>
<li>
<p>Shut down your ForgeRock Identity Platform deployment and delete PVCs used by the
deployment from your namespace. See
<a href="cdk/shutdown.html" class="page">CDK Shutdown and Removal</a> for details.</p>
</li>
<li>
<p>Redeploy the ForgeRock Identity Platform:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops</strong>
$ <strong>skaffold run</strong></pre>
</div>
</div>
</li>
<li>
<p>To validate that AM has the expected changes to run-time data, start
the console and verify that your changes are present.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="custom_images_for_idm"><a class="anchor" href="#custom_images_for_idm"></a>Custom Images for IDM</h3>
<div class="paragraph">
<p>With IDM up and running, you can iteratively:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Customize IDM&#8217;s configuration using the Admin UI and the REST APIs.</p>
</li>
<li>
<p>Capture your configuration changes by synchronizing them from the IDM
service running on Kubernetes back to the staging area and the master directory
for configuration profiles in your <code>forgeops</code> repository clone.</p>
</li>
<li>
<p>Run Skaffold to detect the changes, rebuild the <code>idm</code>
Docker image, and restart IDM. You can then test changes you&#8217;ve made to
the IDM configuration based on the updated Docker image.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="idm_image"><a class="anchor" href="#idm_image"></a><code>idm</code> Image</h4>
<div class="paragraph">
<p>The <code>idm</code> Docker image contains the IDM
configuration.</p>
</div>
<div class="paragraph">
<p>Perform the following procedure iteratively when developing a customized
<code>idm</code> Docker image:</p>
</div>
<div class="openblock procedure">
<div class="title">Create a Customized <code>idm</code> Docker Image</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Perform version control activities on your <code>forgeops</code> repository clone:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Run the <span class="command"><code>git status</code></span> command.</p>
</li>
<li>
<p>Review the state of the working directory and staging area.</p>
</li>
<li>
<p>(Optional) Run the <span class="command"><code>git commit</code></span> command to commit changes to files that
have been modified.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Modify the IDM configuration using the IDM Admin UI or the REST
APIs.</p>
<div class="paragraph">
<p>For information about how to access the IDM Admin UI or REST APIs, see
<a href="cdk/access.html#idm-services" class="page">IDM Services</a>.</p>
</div>
<div class="paragraph">
<p>When modifying the IDM configuration, use configuration expressions, not
hard-coded values, for all host names and passwords.</p>
</div>
<div class="paragraph">
<p>See <a href="#value-substitution">Property Value Substitution</a> for important information about
configuring values that vary at run-time, such as passwords and host names, in
containerized deployments.</p>
</div>
</li>
<li>
<p>Synchronize the changes you made to the IDM configuration to your
<code>forgeops</code> repository clone:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/bin</strong>
$ <strong>./config.sh sync --profile <em>my-profile</em> --component idm --version 7.0</strong>
tar: Removing leading `/' from member names</pre>
</div>
</div>
<div class="paragraph">
<p>The <span class="command"><code>config.sh sync</code></span> command exports the modified IDM
configuration from the running ForgeRock Identity Platform to the staging area. Then, it
saves the configuration profile as <code><em>my-profile</em></code> in the master directory
for configuration profiles:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/config-sh.sync.svg" alt="This diagram shows how the config.sh command synchronizes a configuration profile.">
</div>
</div>
<div class="paragraph">
<p>For more information about the management of ForgeRock Identity Platform configurations in
the <code>forgeops</code> repository, see
<a href="#configuration-profiles">Configuration Profiles</a>.</p>
</div>
</li>
<li>
<p>Execute the <span class="command"><code>skaffold run</code></span> command:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops</strong>
$ <strong>skaffold run</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Skaffold builds a new <code>idm</code> Docker image and redeploys
IDM.</p>
</div>
</li>
<li>
<p>Perform version control activities on your <code>forgeops</code> repository clone:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Run the <span class="command"><code>git status</code></span> command.</p>
</li>
<li>
<p>Review the state of the working directory and staging area.</p>
</li>
<li>
<p>(Optional) Run the <span class="command"><code>git commit</code></span> command to commit changes to files that
have been modified.</p>
</li>
</ol>
</div>
</li>
<li>
<p>To validate that IDM has the expected configuration, start the Admin
UI, and verify that your configuration changes are present.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="value-substitution"><a class="anchor" href="#value-substitution"></a>Property Value Substitution</h3>
<div class="paragraph">
<p>ForgeRock recommends using
<a href="https://ea.forgerock.com/docs/idm/setup-guide/using-property-substitution.html">property
value substitution</a> for all passwords in the ForgeRock Identity Platform configuration in
containerized deployments. Property value substitution eases promotion of the
ForgeRock Identity Platform configuration from a development environment to a test or
production environment.</p>
</div>
<div class="paragraph">
<p>You should also use property value substitution for host names and any other
configuration values that will change as you promote your deployment from a
development environment to a test or production environment.</p>
</div>
<div class="paragraph">
<p>To use property value substitution:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For AM, edit exported JSON files, replacing hard-coded values for
passwords, host names, and other fields with configuration expressions.</p>
</li>
<li>
<p>For IDM, specify values for passwords, host names, and other fields
using configuration expressions in the IDM Admin UI, or when using the
REST API.</p>
</li>
<li>
<p>Specify values for configuration expressions in the <code>data</code> section of the
config map in the
<span class="path"><code>/path/to/forgeops/kustomize/overlay/7.0/all/kustomization.yaml</code></span>
file. Use a key/value pair for each value to be substituted, specifying the
configuration expression as the key.</p>
</li>
</ul>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Specifying passwords as described in the preceding section is <em>extremely
insecure</em>. The passwords appear in cleartext in a Kubernetes config map.</p>
</div>
<div class="paragraph">
<p>It is expected that a future version of the platform will be able to
resolve configuration expressions for passwords from password management
systems; for example, HashiCorp Vault and Google Cloud Key Management System
(KMS). For more information, see
<a href="https://bugster.forgerock.org/jira/browse/OPENIDM-13262">IDM issue #13262</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="fr-data"><a class="anchor" href="#fr-data"></a>About Data Used by the Platform</h3>
<div class="paragraph">
<p>The ForgeRock Identity Platform uses two types of data:
<a href="#configuration-data">configuration data</a> and <a href="#run-time-data">run-time data</a>.</p>
</div>
<div class="sect3">
<h4 id="configuration-data"><a class="anchor" href="#configuration-data"></a>Configuration Data</h4>
<div class="paragraph">
<p>Configuration data consists of properties and settings used by the
ForgeRock Identity Platform. You update configuration data during the development phase of
ForgeRock Identity Platform implementation. You should not change configuration data during
the testing and production phases.</p>
</div>
<div class="paragraph">
<p>You change configuration data iteratively in a development environment. After
changing configuration data, you rebuild Docker images and restart
ForgeRock Identity Platform services when you&#8217;re ready to test sets of changes. If you make
incorrect changes to configuration data, the platform might become
inoperable. After testing modifications to configuration data, you promote your
changes to test and production environments.</p>
</div>
<div class="paragraph">
<p>Examples of configuration data include AM realms, AM
authentication trees, IDM social identity provider definitions, and
IDM data mapping models for reconciliation.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-profiles"><a class="anchor" href="#configuration-profiles"></a>Configuration Profiles</h4>
<div class="paragraph">
<p>A ForgeRock Identity Platform <em>configuration profile</em> is a named set of configuration data
that describes the operational characteristics of a running ForgeRock
deployment.</p>
</div>
<div class="paragraph">
<p>Configuration profiles reside in two locations in the <code>forgeops</code> repository:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>The master directory</strong>. Holds a
<a href="https://github.com/ForgeRock/forgeops/blob/master/README.md#configuration">canonical configuration profile for the CDK</a>
and user-customized configuration profiles. User-customized configuration
profiles in this directory are considered to be the <em>source of truth</em> for
ForgeRock Identity Platform deployments.</p>
<div class="paragraph">
<p>The master directory for configuration profiles is located at the path
<span class="path"><code>/path/to/forgeops/config/7.0</code></span>. You use Git to manage
the configuration profiles in this directory.</p>
</div>
</li>
<li>
<p><strong>The staging area</strong>. Holds a single configuration profile. You copy a profile
from the master directory to the staging area before building a customized
Docker image for the ForgeRock Identity Platform.</p>
<div class="paragraph">
<p>The staging area is located in subdirectories of the path,
<span class="path"><code>/path/to/forgeops/docker/7.0</code></span>. Configuration profiles
copied to the staging area are transient and are not managed with Git.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <span class="command"><code>config.sh</code></span> script lets you copy configuration profiles between
the master directory and the staging area. It also lets you copy profiles from
Kubernetes pods running ForgeRock Identity Platform components to the staging area.</p>
</div>
<div class="paragraph">
<p>You run this script before you build a customized Docker image for the
platform. The script lets you specify which configuration profile to copy
to the staging area. Skaffold uses this profile when it builds a Docker image.</p>
</div>
<div class="paragraph">
<p>For example, when you start developing customized images for the
platform, you run the <span class="command"><code>config.sh init</code></span> command to initialize
the staging area with the canonical CDK profile:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/config-sh.init.svg" alt="This diagram shows how the staging area is initialized from the canonical ${cdk.abbr} profile.">
</div>
</div>
<div class="paragraph">
<p>You run the <span class="command"><code>config.sh sync</code></span> command to synchronize configuration
changes you&#8217;ve made in a running deployment back to the staging area, and then
to the master directory:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/config-sh.sync.svg" alt="This diagram shows how the config.sh command synchronizes a configuration profile.">
</div>
</div>
<div class="paragraph">
<p>For more information about the <span class="command"><code>config.sh</code></span> script, see
<a href="https://github.com/ForgeRock/forgeops/blob/master/README.md#managing-configurations">Managing Configurations</a>
in the <code>forgeops</code> repository&#8217;s top-level README file.</p>
</div>
</div>
<div class="sect3">
<h4 id="run-time-data"><a class="anchor" href="#run-time-data"></a>Run-Time Data</h4>
<div class="paragraph">
<p>Run-time data consists of identities, policies, applications, and data objects
used by the ForgeRock Identity Platform. You might extract sample run-time data while
developing configuration data. Run-time data is volatile throughout
ForgeRock Identity Platform implementation. Expect it to change even when the
ForgeRock Identity Platform is in production.</p>
</div>
<div class="paragraph">
<p>You usually use sample data for run-time data. Run-time data that&#8217;s changed
during development is not typically promoted to test and production
environments. There&#8217;s no need to modify Docker images or restart ForgeRock Identity Platform
services when run-time data is modified.</p>
</div>
<div class="paragraph">
<p>Examples of run-time data include AM and IDM identities, AM
policies, AM OAuth 2.0 client definitions, and IDM relationships.</p>
</div>
<div class="paragraph">
<p>In the ForgeRock Identity Platform, run-time data is stored in databases and is not
file-based. For more information about how run-time data is stored in
AM and IDM, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://ea.forgerock.com/docs/am/install-guide/prepare-ext-stores.html">Preparing
External Stores</a> in the AM documentation.</p>
</li>
<li>
<p><a href="https://ea.forgerock.com/docs/idm/objects-guide/repository.html">Store Managed
Objects in the Repository</a> in the IDM documentation.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdk_troubleshooting"><a class="anchor" href="#cdk_troubleshooting"></a>CDK Troubleshooting</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Kubernetes deployments are multi-layered and often complex.</p>
</div>
<div class="paragraph">
<p>Errors and misconfigurations can crop up in a variety of places. Performing a
logical, systematic search for the source of a problem can be daunting.</p>
</div>
<div class="paragraph">
<p>This section contains some troubleshooting categories you can explore, to reolve
an issue.</p>
</div>
<div class="sect2">
<h3 id="third_party_software_versions"><a class="anchor" href="#third_party_software_versions"></a>Third-Party Software Versions</h3>
<div class="paragraph">
<p>ForgeRock recommends installing tested versions of third-party software in
environments where you&#8217;ll run the CDK.</p>
</div>
<div class="paragraph">
<p>See the tested versions of
third-party software in your corresponding environment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="cdk/minikube/setup/sw.html" class="page">Minikube</a></p>
</li>
<li>
<p><a href="cdk/cloud/setup/gke/sw.html" class="page">GKE</a></p>
</li>
<li>
<p><a href="cdk/cloud/setup/eks/sw.html" class="page">EKS</a></p>
</li>
<li>
<p><a href="cdk/cloud/setup/aks/sw.html" class="page">AKS</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you used Homebrew to install third-party software, you can use the following
commands to obtain software versions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Homebrew: <span class="command"><code>brew list --versions</code></span></p>
</li>
<li>
<p>Homebrew casks: <span class="command"><code>brew list --cask --versions</code></span></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="minikube_vm_configuration_minikube_deployments_only"><a class="anchor" href="#minikube_vm_configuration_minikube_deployments_only"></a>Minikube VM Configuration (Minikube deployments only)</h3>
<div class="paragraph">
<p>The <span class="command"><code>minikube start</code></span> command example in
<a href="cdk/minikube/setup/vm.html" class="page">Minikube Virtual Machine</a>
specifies the virtual hardware requirements for a Minikube VM.</p>
</div>
<div class="paragraph">
<p>Run the <span class="command"><code>VBoxManage showvminfo "minikube"</code></span> command to verify that
your Minikube VM meets the stated memory requirement (<code>Memory Size</code> in the
output), and to gather other information that might be of interest when
troubleshooting issues running the CDK in a Minikube environment.</p>
</div>
</div>
<div class="sect2">
<h3 id="sufficient_disk_space_minikube_deployments_only"><a class="anchor" href="#sufficient_disk_space_minikube_deployments_only"></a>Sufficient Disk Space (Minikube deployments only)</h3>
<div class="paragraph">
<p>When the Minikube VM runs low on disk space, it acts unpredictably. Unexpected
application errors can appear.</p>
</div>
<div class="paragraph">
<p>Verify that adequate disk space is available by logging in to the Minikube VM
and running a command to display free disk space:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>minikube ssh</strong>
$ <strong>df -h</strong>
Filesystem      Size  Used Avail Use% Mounted on
devtmpfs        3.9G     0  3.9G   0% /dev
tmpfs           3.9G     0  3.9G   0% /dev/shm
tmpfs           3.9G  383M  3.6G  10% /run
tmpfs           3.9G     0  3.9G   0% /sys/fs/cgroup
tmpfs           3.9G   64K  3.9G   1% /tmp
/dev/sda1        25G  7.7G   16G  33% /mnt/sda1
/Users          465G  219G  247G  48% /Users
$ <strong>exit</strong>
logout</pre>
</div>
</div>
<div class="paragraph">
<p>In the preceding example, 16 GB of disk space is available on the Minikube VM.</p>
</div>
</div>
<div class="sect2">
<h3 id="kubectl_shell_autocompletion"><a class="anchor" href="#kubectl_shell_autocompletion"></a><code>kubectl</code> Shell Autocompletion</h3>
<div class="paragraph">
<p>The <span class="command"><code>kubectl</code></span> shell autocompletion extension lets you extend the Tab key
completion feature of Bash and Zsh shells to the <span class="command"><code>kubectl</code></span> commands.
While not a troubleshooting tool, this extension can make troubleshooting easier,
because it lets you enter <span class="command"><code>kubectl</code></span> commands more easily.</p>
</div>
<div class="paragraph">
<p>For more information about the Kubernetes autocompletion extension, see
<a href="https://kubernetes.io/docs/tasks/kubectl/install/#enabling-shell-autocompletion">Enabling shell autocompletion</a>
in the Kubernetes documentation.</p>
</div>
<div class="paragraph">
<p>Note that to install the autocompletion extension in Bash, you must be running
version 4 or later of the Bash shell. To determine your bash shell version, run
the <span class="command"><code>bash --version</code></span> command.</p>
</div>
</div>
<div class="sect2">
<h3 id="expanded_kustomize_output"><a class="anchor" href="#expanded_kustomize_output"></a>Expanded Kustomize Output</h3>
<div class="paragraph">
<p>If you&#8217;ve modified any of the Kustomize bases and overlays that come with the
CDK, you might want to see how your changes affect CDK deployment.
 Use the <span class="command"><code>kustomize build</code></span> command to see how Kustomize expands
 your bases and overlays into YAML files.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/kustomize/overlay/7.0</strong>
$ <strong>kustomize build all</strong>
2020/10/02 11:07:53 well-defined vars that were never replaced: DOMAIN,DSBACKUP_DIRECTORY,DSBACKUP_HOSTS,NAMESPACE,SUBDOMAIN,AUTORESTORE_FROM_DSBACKUP
apiVersion: v1
data:
  IDM_ENVCONFIG_DIRS: /opt/openidm/resolver
  LOGGING_PROPERTIES: /var/run/openidm/logging/logging.properties
  OPENIDM_ANONYMOUS_PASSWORD: anonymous
  OPENIDM_CLUSTER_REMOVE_OFFLINE_NODE_STATE: "true"
  OPENIDM_CONFIG_REPO_ENABLED: "false"
  PROJECT_HOME: /opt/openidm
kind: ConfigMap
metadata:
  labels:
    app: idm
    app.kubernetes.io/name: forgerock
    component: idm
    tier: middle
    vendor: forgerock
  name: idm
  namespace: prod
---
apiVersion: v1
data:
  logging.properties: |
    # Properties file that configures the operation of the JDK
    # logging facility.
    # The system will look for this configuration file, first using
    # a System property specified at startup:
    #
    # &gt;java -Djava.util.logging.config.file=myLoggingConfigFilePath
    #
. . .</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="skaffold_issues"><a class="anchor" href="#skaffold_issues"></a>Skaffold Issues</h3>
<div class="paragraph">
<p>Skaffold provides different levels of debug logging information. When you
encounter issues deploying the platform with Skaffold, you can set the
logging verbosity to display more messages. The additional messages might help
you identify problems.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops</strong>
$ <strong>skaffold dev -v debug</strong>
INFO[0000] starting gRPC server on port 50051
INFO[0000] starting gRPC HTTP server on port 50052
INFO[0000] Skaffold &amp;{Version:v0.38.0 ConfigVersion:skaffold/v1beta14 GitVersion: GitCommit:1012d7339d0055ab93d7f88e95b7a89292ce77f6 GitTreeState:clean BuildDate:2020-09-13T02:16:09Z GoVersion:go1.13 Compiler:gc Platform:darwin/amd64}
DEBU[0000] config version (skaffold/v1beta12) out of date: upgrading to latest (skaffold/v1beta14)
DEBU[0000] found config for context "minikube"
DEBU[0000] Defaulting build type to local build
DEBU[0000] validating yamltags of struct SkaffoldConfig
DEBU[0000] validating yamltags of struct Metadata
. . .</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pods"><a class="anchor" href="#pods"></a>Pod Descriptions and Container Logs</h3>
<div class="paragraph">
<p>Look at pod descriptions and container log files for irregularities that
indicate problems.</p>
</div>
<div class="paragraph">
<p><em>Pod descriptions</em> contain information about active Kubernetes pods, including
their configuration, status, containers (including containers that have finished
running), volume mounts, and pod-related events.</p>
</div>
<div class="paragraph">
<p><em>Container logs</em> contain startup and run-time messages that might indicate
problem areas. Each Kubernetes container has its own log that contains all
output written to <code>stdout</code> by the application running in the container. The <code>am</code>
container logs are especially important for troubleshooting AM issues in
Kubernetes deployments. AM writes its debug logs to <code>stdout</code>.
Therefore, the <code>am</code> container logs include all the AM debug logs.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of how you can use pod descriptions and container logs to
troubleshoot. Events in the pod description indicate that Kubernetes was
unsuccessful in pulling a Docker image required to run a container. You can
review your Docker registry&#8217;s configuration to determine whether a
misconfiguration caused the problem.</p>
</div>
<div class="paragraph">
<p>The <span class="command"><code>debug-logs.sh</code></span> script generates the following HTML-formatted
output, which you can view in a browser:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Descriptions of all the Kubernetes pods running the ForgeRock Identity Platform in your
namespace</p>
</li>
<li>
<p>Logs for all of the containers running in these pods</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Perform the following procedure to run the <span class="command"><code>debug-logs.sh</code></span> script
and then view the output in a browser:</p>
</div>
<div class="openblock procedure">
<div class="title">Run the debug-logs.sh Script</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that your namespace is the current namespace in your Kubernetes
context.</p>
</li>
<li>
<p>Make sure you&#8217;ve checked out the master branch of the <code>forgeops</code>
repository.</p>
</li>
<li>
<p>Change to the <span class="path"><code>/path/to/forgeops/bin</code></span> directory in your <code>forgeops</code>
repository clone.</p>
</li>
<li>
<p>Run the <span class="command"><code>debug-logs.sh</code></span> script:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>./debug-logs.sh</strong>
Generating debug log for namespace prod
Generating admin-ui-5b6dcf78fd-pq4fs logs
Generating am-695fdf5f97-ch66f logs
Generating amster-ss9j5 logs
Generating ds-cts-0 logs
Generating ds-idrepo-0 logs
Generating end-user-ui-875cc95df-9nmf4 logs
Generating idm-0 logs
Generating ldif-importer-x25x6 logs
Generating login-ui-74b8d676-vqm6c logs
open <a href="file:///tmp/forgeops/log.html" class="bare">file:///tmp/forgeops/log.html</a> in your browser</pre>
</div>
</div>
</li>
<li>
<p>In a browser, go to the URL shown in the <span class="command"><code>debug-logs.sh</code></span>
output. For example, <code><a href="file:///tmp/forgeops/log.html" class="bare">file:///tmp/forgeops/log.html</a></code>. The browser displays a
screen with a link for each ForgeRock Identity Platform pod in your namespace:</p>
<div class="imageblock">
<div class="content">
<img src="_images/debug-logs.png" alt="Screen shot of debug-logs.sh output.">
</div>
</div>
</li>
<li>
<p>(Optional) To access the information for a pod, select its link from the start
of the <span class="command"><code>debug-logs.sh</code></span> output.</p>
<div class="paragraph">
<p>Selecting the link takes you to the pod&#8217;s description. Logs for each of the
pod&#8217;s containers follow the pod&#8217;s description.</p>
</div>
</li>
<li>
<p>(Optional) To modify the output to contain the latest updates to the pod descriptions and
container logs, run the <span class="command"><code>debug-logs.sh</code></span> script again, and then
refresh your browser.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdk_shutdown_and_removal"><a class="anchor" href="#cdk_shutdown_and_removal"></a>CDK Shutdown and Removal</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you&#8217;re done working with your ForgeRock Identity Platform deployment, shut it down and
remove it from your namespace as follows:</p>
</div>
<div class="openblock procedure">
<div class="title">Shut Down and Remove a ForgeRock Identity Platform Deployment</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to the terminal window where you started Skaffold.</p>
</li>
<li>
<p>Run the <span class="command"><code>skaffold delete</code></span> command to shut down your deployment
and remove it from your namespace:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops</strong>
$ <strong>skaffold delete</strong>
Cleaning up&#8230;&#8203;</pre>
</div>
</div>
</li>
<li>
<p>Delete DS persistent volume claims (PVCs) from your namespace:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl delete pvc --all</strong>
persistentvolumeclaim "data-ds-cts-0" deleted
persistentvolumeclaim "data-ds-idrepo-0" deleted</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cloud_deployment_model_documentation"><a class="anchor" href="#cloud_deployment_model_documentation"></a>Cloud Deployment Model Documentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Deploy the CDM on GKE, Amazon EKS, or AKS to quickly spin up the
platform for demonstration purposes. Youll get a feel for what its like to
deploy the platform on a Kubernetes cluster in the cloud. When youre done, you
wont have a production-quality deployment. But you will have a robust,
reference implementation of the ForgeRock Identity Platform.</p>
</div>
<div class="sect2">
<h3 id="cdm_checklist"><a class="anchor" href="#cdm_checklist"></a>CDM Checklist</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/intro.html" class="page">Become familiar with the CDM</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/architecture.html" class="page">Understand CDM architecture</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Set up your local environment and create a cluster (<a href="cdm/gke/setup/setup-env.html" class="page">GKE</a>|<a href="cdm/eks/setup/setup-env.html" class="page">EKS</a>|<a href="cdm/aks/setup/setup-env.html" class="page">AKS</a>)</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/deploy.html" class="page">Deploy the platform</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/access.html" class="page">Access platform UIs and APIs</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/next-steps.html" class="page">Explore your deployment and start planning for production</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="about_the_cloud_deployment_model"><a class="anchor" href="#about_the_cloud_deployment_model"></a>About the Cloud Deployment Model</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The ForgeRock Cloud Deployment Team has developed Docker images, Kustomize
bases and overlays, Skaffold workflows, shell scripts, and other artifacts
expressly to build the Cloud Deployment Model (CDM). The <code>forgeops</code> repository
on GitHub contains the CDM artifacts you can use to deploy the ForgeRock Identity Platform
in a cloud environment.</p>
</div>
<div class="paragraph">
<p>The CDM is a reference implementation for ForgeRock cloud deployments.
You can get a sample ForgeRock Identity Platform deployment up and running in the cloud
quickly using the CDM. After deploying the CDM, you can use it to
explore how you might configure your Kubernetes cluster before you deploy the
platform in production.</p>
</div>
<div class="paragraph">
<p>The CDM is a robust sample deployment for demonstration and exploration
purposes only. <em>It is not a production deployment</em>.</p>
</div>
<div class="paragraph">
<p>This documentation describes how to use the CDM to stand up a Kubernetes
cluster in the cloud that runs the ForgeRock Identity Platform, and then access the
platform&#8217;s GUIs and REST APIs. When you&#8217;re done, you can use the
CDM to explore deployment customizations:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/start-cdm.png" alt="Illustrates the major tasks performed to deploy the CDM.">
</div>
</div>
<div class="paragraph">
<p>Standing up a Kubernetes cluster and deploying the platform using the
CDM is an activity you might want to perform as a learning and exploration
exercise before you put together a project plan for deploying the platform
in production. To better understand how this activity fits in to the overall
deployment process, see
<a href="start/start-here.html#cdm-sandbox" class="page">Deploy the CDM</a>.</p>
</div>
<div class="paragraph">
<p>Using the CDM artifacts and this documentation, you can quickly get the
ForgeRock Identity Platform running in a Kubernetes cloud environment. You deploy the
CDM to begin to familiarize yourself with some of the steps you&#8217;ll need
to perform when deploying the platform in the cloud for production use.
These steps include creating a cluster suitable for deploying the
ForgeRock Identity Platform, installing the platform, and accessing its UIs and APIs.</p>
</div>
<div class="paragraph">
<p><strong>Standardizes the process</strong>. The ForgeRock Cloud Deployment Team&#8217;s mission is
to standardize a process for deploying ForgeRock Identity Platform natively in the cloud.
The Team is made up of technical consultants and cloud software developers.
We&#8217;ve had numerous interactions with ForgeRock customers, and discussed common
deployment issues. Based on our interactions, we standardized on Kubernetes as
the cloud platform, and we developed the CDM artifacts to make deployment
of the platform easier in the cloud.</p>
</div>
<div class="paragraph">
<p><strong>Simplifies baseline deployment</strong>. We then developed artifacts&#x2014;Dockerfiles,
Kustomize bases and overlays, Skaffold workflows, and shell scripts&#x2014;to
simplify the deployment process. We deployed small-sized, medium-sized, and
large-sized production-quality Kubernetes clusters, and kept them up and running
24x7. We conducted continuous integration and continuous deployment as we added
new capabilities and fixed problems in the system. We maintained, benchmarked,
and tuned the system for optimized performance. Most importantly, we documented
the process so you could replicate it.</p>
</div>
<div class="paragraph">
<p><strong>Eliminates guesswork</strong>. If you use our CDM artifacts and follow the
instructions in this documentation without deviation, you can successfully
deploy the $ForgeRock Identity Platform in the cloud. The CDM takes the guesswork out
out of setting up a cloud environment. It bypasses the
deploy-test-integrate-test-repeat cycle many customers struggle through when
spinning up the ForgeRock Identity Platform in the cloud for the first time.</p>
</div>
<div class="paragraph">
<p><strong>Prepares you to deploy in production</strong>. After you&#8217;ve deployed the CDM,
you&#8217;ll be ready to start working with experts on deploying in production. We
strongly recommend that you engage a ForgeRock technical consultant or partner
to assist you with deploying the platform in production.</p>
</div>
<h3 id="next_step_33" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/intro.html" class="page">Become familiar with the CDM</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/architecture.html" class="page">Understand CDM architecture</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Set up your local environment and create a cluster (<a href="cdm/gke/setup/setup-env.html" class="page">GKE</a>|<a href="cdm/eks/setup/setup-env.html" class="page">EKS</a>|<a href="cdm/aks/setup/setup-env.html" class="page">AKS</a>)</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/deploy.html" class="page">Deploy the platform</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/access.html" class="page">Access platform UIs and APIs</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/next-steps.html" class="page">Explore your deployment and start planning for production</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdm_architecture"><a class="anchor" href="#cdm_architecture"></a>CDM Architecture</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once you deploy the CDM, the ForgeRock Identity Platform is fully operational within
a Kubernetes cluster. <code>forgeops</code> artifacts provide well-tuned JVM settings,
memory, CPU limits, and other CDM configurations.</p>
</div>
<div class="paragraph">
<p>Here are some of the characteristics of the CDM:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Multi-zone Kubernetes cluster</dt>
<dd>
<div class="paragraph">
<p>ForgeRock Identity Platform is deployed in a Kubernetes cluster.</p>
</div>
<div class="paragraph">
<p>For high availability, CDM clusters are distributed across three zones.</p>
</div>
<div class="paragraph">
<p>For better node sizing, pods in CDM clusters are organized in two node
pools.</p>
</div>
<div class="paragraph">
<p>Go <a href="#cdm-topology">here</a> for a diagram that shows the
organization of pods in zones and node pools in a CDM cluster.</p>
</div>
</dd>
</dl>
</div>
<div id="cluster-sizes" class="dlist">
<dl>
<dt class="hdlist1">Cluster sizes</dt>
<dd>
<div class="paragraph">
<p>Before deploying the CDM, you specify one of three cluster sizes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A small cluster with capacity to handle 1,000,000 test users</p>
</li>
<li>
<p>A medium cluster with capacity to handle 10,000,000 test users</p>
</li>
<li>
<p>A large cluster with capacity to handle 100,000,000 test users</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Third-party deployment and monitoring tools</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/kubernetes/ingress-nginx">NGINX Ingress Controller</a> for
Kubernetes ingress support.</p>
</li>
<li>
<p><a href="https://prometheus.io/">Prometheus</a> for monitoring and notifications.</p>
</li>
<li>
<p><a href="https://prometheus.io/docs/alerting/alertmanager/">Prometheus Alertmanager</a>
for setting and managing alerts.</p>
</li>
<li>
<p><a href="https://grafana.com/">Grafana</a> for metrics visualization.</p>
</li>
<li>
<p><a href="https://docs.cert-manager.io">Certificate Manager</a> for obtaining and installing
security certificates.</p>
</li>
<li>
<p><a href="https://helm.sh">Helm</a> for deploying Helm charts for the NGINX Ingress
Controller, Prometheus, and Grafana.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Ready-to-use ForgeRock Identity Platform components</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Multiple DS instances are deployed for higher availability. Separate
instances are deployed for Core Token Service (CTS) tokens and identities. The
instances for identities also contain AM and IDM run-time data.</p>
</li>
<li>
<p>The AM configuration is file-based, stored at the path
<code>/home/forgerock/openam/config</code> inside the AM Docker container (and in
the AM pods).</p>
</li>
<li>
<p>Multiple AM instances are deployed for higher availability. The
AM instances are configured to access the DS data stores.</p>
</li>
<li>
<p>Multiple IDM instances are deployed for higher availability.
The IDM instances are configured to access the DS data stores.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="cdm-topology" class="dlist">
<dl>
<dt class="hdlist1">Highly available, distributed deployment</dt>
<dd>
<div class="paragraph">
<p>Deployment across the three zones ensures that the ingress controller and all
ForgeRock Identity Platform components are highly available.</p>
</div>
<div class="paragraph">
<p>Distribution across the two node pools&#x2014;primary and DS&#x2014;groups
like pods together, enabling appropriate node sizing.</p>
</div>
<div class="paragraph">
<p>The following diagram shows how pods are organized in node pools and zones on
CDM clusters:</p>
</div>
</dd>
</dl>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/m-cluster.svg" alt="CDM clusters have three zones and two node pools. The node pools have six nodes each.">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Load balancing</dt>
<dd>
<div class="paragraph">
<p>The NGINX Ingress Controller provides load balancing services for CDM
deployments. Ingress controller pods run in the <code>nginx</code> namespace. Implementation
varies by cloud provider.</p>
</div>
</dd>
<dt class="hdlist1">Secret generation and management</dt>
<dd>
<div class="paragraph">
<p>ForgeRock&#8217;s
<a href="https://github.com/ForgeRock/secret-agent">open source Secret Agent
operator</a> generates Kubernetes secrets for ForgeRock Identity Platform deployments. It also
integrates with Google Cloud Secret Manager, AWS Secrets Manager, and Azure Key
Vault, providing cloud backup and retrieval for secrets.</p>
</div>
</dd>
<dt class="hdlist1">Secured communication</dt>
<dd>
<div class="paragraph">
<p>The ingress controller is SSL-enabled. SSL is terminated at the ingress controller.
Incoming requests and outgoing responses are encrypted. For more information,
see <a href="deployment/security.html#secure-http" class="page">Secure HTTP</a>.</p>
</div>
</dd>
<dt class="hdlist1">Stateful Sets</dt>
<dd>
<div class="paragraph">
<p>The CDM uses Kubernetes stateful sets to manage the DS pods.
Stateful sets protect against data loss if Kubernetes client containers fail.</p>
</div>
<div class="paragraph">
<p>The CTS data stores are configured for
<a href="glossary.html#glossary-affinity," class="page">affinity</a> load balancing for optimal
performance:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/m-cluster-cts-flow.svg" alt="AM connections to CTS servers use token affinity in CDM.">
</div>
</div>
<div class="paragraph">
<p>The AM policies, application data, and identities reside in the <code>idrepo</code>
directory service. The deployment uses a single <code>idrepo</code> master that can fail
over to one or more secondary directory services:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/m-cluster-idrepo-flow.svg" alt="For all the ${am.abbr} pods" height="the primary connection is to the ds-idrepo-0 service">
</div>
</div>
</dd>
<dt class="hdlist1">Authentication</dt>
<dd>
<div class="paragraph">
<p>IDM is configured to use AM for authentication.</p>
</div>
</dd>
<dt class="hdlist1">DS replication</dt>
<dd>
<div class="paragraph">
<p>All DS instances are configured for full replication of identities and
session tokens.</p>
</div>
</dd>
<dt class="hdlist1">Backup and restore</dt>
<dd>
<div class="paragraph">
<p>The CDM is ready to back up directory data, but backups are not scheduled
by default. To schedule backups, see
<a href="deployment/backup-restore.html" class="page">Backup and Restore</a>.</p>
</div>
<div class="paragraph">
<p>You can enable the automatic restore capability in CDM to create new
DS instances with data from the backup of another CDM deployment
with the same DS topology.</p>
</div>
</dd>
<dt class="hdlist1">Initial data loading jobs</dt>
<dd>
<div class="paragraph">
<p>When it starts up, the CDM runs two jobs to load data into the
environment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>amster</code> job loads application data, such as OAuth 2.0 client definitions,
to the <code>idrepo</code> DS instance.</p>
</li>
<li>
<p>The <code>ldif-importer</code> job primes the DS <code>idrepo</code> instance, which acts as
the AM application and policy store, with required schema.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<h3 id="next_step_34" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/intro.html" class="page">Become familiar with the CDM</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/architecture.html" class="page">Understand CDM architecture</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark>Set up your local environment and create a cluster (<a href="cdm/gke/setup/setup-env.html" class="page">GKE</a>|<a href="cdm/eks/setup/setup-env.html" class="page">EKS</a>|<a href="cdm/aks/setup/setup-env.html" class="page">AKS</a>)</mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/deploy.html" class="page">Deploy the platform</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/access.html" class="page">Access platform UIs and APIs</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/next-steps.html" class="page">Explore your deployment and start planning for production</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="environment_setup_gke"><a class="anchor" href="#environment_setup_gke"></a>Environment Setup: GKE</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before deploying the CDM, you must set up your local computer, configure
a Google Cloud project, and create a GKE cluster.</p>
</div>
<div class="paragraph">
<p></p>
</div>
<details>
<summary>
Windows users
</summary>
<div class="paragraph">
<p>ForgeRock supports deploying the CDK and CDM using macOS and
Linux. If you have a Windows computer, you&#8217;ll need to create a Linux VM. We
tested using the following configurations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hypervisor: Hyper-V, VMWare Player, or VMWare Workstation</p>
</li>
<li>
<p>Guest OS: Ubuntu 19.10 with 12 GB memory and 60 GB disk space</p>
</li>
<li>
<p>Nested virtualization enabled in the Linux VM.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Perform all the procedures in this documentation within the Linux VM. In this
documentation, the local computer refers to the Linux VM for Windows users.</strong></p>
</div>
</details>
<div class="sect2">
<h3 id="environment_setup_checklist_2"><a class="anchor" href="#environment_setup_checklist_2"></a>Environment Setup Checklist</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/project.html" class="page">Set up a Google Cloud project</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After you&#8217;ve completed all of these environment setup tasks, you&#8217;ll be ready to
<a href="cdm/deploy.html" class="page">deploy the ForgeRock Identity Platform on your new Kubernetes
cluster</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="third_party_software_5"><a class="anchor" href="#third_party_software_5"></a>Third-Party Software</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before installing the CDM, you must obtain non-ForgeRock software and
install it on your local computer.</p>
</div>
<div class="paragraph">
<p>ForgeRock recommends that you install third-party software using
<a href="https://brew.sh/">Homebrew</a> on macOS and Linux.</p>
</div>
<div class="paragraph">
<p>The versions listed in the following table have been validated for deploying the
CDM on Google Cloud. Earlier and later versions will <em>probably</em> work. If
you want to try using versions that are not in the tables, it is your
responsibility to validate them.</p>
</div>
<div class="paragraph">
<p>Install the following third-party software:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Software</th>
<th class="tableblock halign-left valign-top">Version</th>
<th class="tableblock halign-left valign-top">Homebrew package</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker Desktop<sup class="footnote" id="_footnote_docker">[<a id="_footnoteref_19" class="footnote" href="#_footnotedef_19" title="View footnote.">19</a>]</sup>
</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.3.0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker</code> (cask)<sup class="footnote" id="_footnote_linuxbrew">[<a id="_footnoteref_20" class="footnote" href="#_footnotedef_20" title="View footnote.">20</a>]</sup>
</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes client (<span class="command"><code>kubectl</code></span>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.19.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubernetes-cli</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Skaffold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.14.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skaffold</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kustomize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.8.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kustomize</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes context switcher (<span class="command"><code>kubectx</code></span>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubectx</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Helm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.3.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>helm</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Google Cloud SDK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">311.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>google-cloud-sdk</code> (cask)<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_7" title="View footnote.">7</a>]</sup></p></td>
</tr>
</tbody>
</table>
<h3 id="next_step_35" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/gke/setup/project.html" class="page">Set up a Google Cloud project</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="google_cloud_project_setup"><a class="anchor" href="#google_cloud_project_setup"></a>Google Cloud Project Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The CDM runs in a Kubernetes cluster in a Google Cloud project.</p>
</div>
<div class="paragraph">
<p>This page outlines how the Cloud Deployment Team created and configured our
Google Cloud project before we created our cluster.</p>
</div>
<div class="paragraph">
<p>To replicate Google Cloud project creation and configuration, follow this
procedure:</p>
</div>
<div class="openblock procedure">
<div class="title">Configure a Google Cloud Project for the CDM</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in to the Google Cloud Console and create a new project.</p>
</li>
<li>
<p>Authenticate to the Google Cloud SDK to obtain the permissions you&#8217;ll need to
create a cluster:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Configure the Google Cloud SDK standard component to use your Google account.
Run the following command:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>gcloud auth login</strong></pre>
</div>
</div>
</li>
<li>
<p>A browser window appears, prompting you to select a Google account. Select
the account you want to use for cluster creation.</p>
<div class="paragraph">
<p>A second screen requests several permissions. Select Allow.</p>
</div>
<div class="paragraph">
<p>A third screen should appear with the heading, "You are now authenticated with
the Google Cloud SDK!"</p>
</div>
</li>
<li>
<p>Set the Google Cloud SDK configuration to reference your new project. Specify
the project ID, not the project name, in the <code>gcloud config set project</code>
command:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>gcloud config set project <code><em>my-project-id</em></code></strong></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Assign the following roles to users who will be creating
Kubernetes clusters and deploying the CDM:</p>
<div class="ulist">
<ul>
<li>
<p>Editor</p>
</li>
<li>
<p>Kubernetes Engine Admin</p>
</li>
<li>
<p>Kubernetes Engine Cluster Admin</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Remember, the CDM is a reference implementation, and is
<a href="start/start-here.html#cdm-sandbox" class="page">not for production use</a>.
The roles you assign in this step are suitable for the CDM.
When you <a href="start/start-here.html#planning" class="page">create a project plan</a>,
you&#8217;ll need to determine which Google Cloud roles are required.</p>
</div>
</li>
<li>
<p>The Cloud Deployment Team used the <code>us-west1</code> region to develop and test
the CDM.</p>
<div class="paragraph">
<p>If you would like to deploy the CDM in a different region, set the region
in your Google Cloud SDK configuration. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>gcloud config set compute/region <code><em>my-region</em></code></strong></pre>
</div>
</div>
</li>
<li>
<p>Determine the cluster size:
<a href="cdm/architecture.html#cluster-sizes" class="page">small, medium, or large</a>.</p>
</li>
<li>
<p>Ensure that the cluster creation script will support your region:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Go to Google&#8217;s
<a href="https://cloud.google.com/compute/docs/regions-zones">Regions and Zones</a>
page.</p>
</li>
<li>
<p>Determine if the <code>a</code>, <code>b</code>, and <code>c</code> zones are available in your region.</p>
<div class="paragraph">
<p>If these zones are available, no additional action needs to be taken.</p>
</div>
<div class="paragraph">
<p>If they&#8217;re not available:</p>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Change to the <span class="path"><code>/path/to/forgeops/cluster/gke</code></span> directory.</p>
</li>
<li>
<p>Open the script that sets environment variables for your selected cluster
size. For example, open the <span class="path"><code>small.sh</code></span> script if you&#8217;re going to deploy
a small-sized cluster.</p>
</li>
<li>
<p>Locate the statement that sets the <code>NODE_LOCATIONS</code> environment variable.</p>
</li>
<li>
<p>Uncomment this statement.</p>
</li>
<li>
<p>Change the statement to configure CDM to use three zones available in
your region.</p>
</li>
<li>
<p>Save your changes to the script.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Ensure that your region has an adequate CPU quota for the CDM:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the <span class="path"><code>/path/to/forgeops/cluster/gke</code></span> directory.</p>
</li>
<li>
<p>Open the script that sets environment variables for your selected cluster
size. For example, open the <span class="path"><code>small.sh</code></span> script if you&#8217;re going to deploy
a small-sized cluster.</p>
</li>
<li>
<p>Locate the statements that set the <code>MACHINE</code> and <code>DS_MACHINE</code> environment
variables.</p>
</li>
<li>
<p>Your quotas need to let you allocate six machines each of <code>MACHINE</code> and
<code>DS_MACHINE</code> types in your region. If your quotas are too low, request and wait
for a quota increase from Google Cloud before attempting to create your CDM
cluster.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_36" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/project.html" class="page">Set up a Google Cloud project</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/gke/setup/forgeops.html" class="page">Get the forgeops repository</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="forgeops_repository_5"><a class="anchor" href="#forgeops_repository_5"></a><code>forgeops</code> Repository</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you can deploy the CDK or the CDM, you must first get the
<code>forgeops</code> repository:<sup class="footnote" id="_footnote_release-tag">[<a id="_footnoteref_21" class="footnote" href="#_footnotedef_21" title="View footnote.">21</a>]</sup></p>
</div>
<div class="openblock procedure">
<div class="title">Obtain the forgeops Repository</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone the <code>forgeops</code> repository:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git clone <a href="https://github.com/ForgeRock/forgeops.git" class="bare">https://github.com/ForgeRock/forgeops.git</a></strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>forgeops</code> repository is a public Git repository. You do not need
credentials to clone it.</p>
</div>
</li>
<li>
<p>Check out the <code>2020.10.28-AlSugoDiNoci</code> release tag, creating a branch named
<code><em>my-branch</em></code>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd forgeops</strong>
$ <strong>git checkout tags/2020.10.28-AlSugoDiNoci -b <em>my-branch</em></strong>
Switched to a new branch <em>'my-branch'</em></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_37" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/project.html" class="page">Set up a Google Cloud project</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/gke/setup/cluster.html" class="page">Create a Kubernetes cluster</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="kubernetes_cluster_creation"><a class="anchor" href="#kubernetes_cluster_creation"></a>Kubernetes Cluster Creation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ForgeRock provides shell scripts to use for cluster creation. Use them when
you deploy the CDM. After you&#8217;ve finished deploying the CDM, you
can use the CDM as a sandbox to explore a different infrastructure-as-code
solution, if you like.</p>
</div>
<div class="paragraph">
<p>When you <a href="start/start-here.html#planning" class="page">Create a Project Plan</a>,
you&#8217;ll need to identify your organization&#8217;s preferred infrastructure-as-code
solution, and create your own cluster creation automation scripts, if necessary.</p>
</div>
<div id="create-gke-cluster" class="openblock procedure">
<div class="title">Create a Kubernetes Cluster for the CDM</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the cluster:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the directory that contains the cluster creation script:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/cluster/gke</strong></pre>
</div>
</div>
</li>
<li>
<p>Source the script that contains the configuration for your cluster size. For
example:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>source ./small.sh</strong></pre>
</div>
</div>
</li>
<li>
<p>Run the cluster creation script:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>./cluster-up.sh</strong></pre>
</div>
</div>
<div class="paragraph">
<p>If you&#8217;re prompted to install Google Cloud SDK beta components, enter <strong>Y</strong> to
install them.</p>
</div>
<div class="paragraph">
<p>The script creates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The cluster</p>
</li>
<li>
<p>The <code>ds-pool</code> node pool</p>
</li>
<li>
<p>The <code>fast</code> storage class</p>
</li>
<li>
<p>The <code>prod</code> namespace</p>
</li>
<li>
<p>The <code>cluster-admin-binding</code> cluster role binding</p>
</li>
</ul>
</div>
</li>
<li>
<p>To verify that the script created the cluster, log in to the Google Cloud
console. Select the Kubernetes Engine option. You should see the new cluster in
the list of Kubernetes clusters.</p>
</li>
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command.</p>
<div class="paragraph">
<p>The output should contain your newly created cluster and any existing clusters.</p>
</div>
<div class="paragraph">
<p>The current context should be set to the context for your new cluster.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Set context to the <code>prod</code> namespace:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubens prod</strong></pre>
</div>
</div>
</li>
<li>
<p>Check the status of the pods in your cluster until all the pods are ready:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>List all the pods in the cluster:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl get pods --all-namespaces</strong>
NAMESPACE                         NAME                                                       READY   STATUS    RESTARTS   AGE
cnrm-system                       cnrm-deletiondefender-0                                    1/1     Running   0          6m52s
cnrm-system                       cnrm-resource-stats-recorder-7cc75c4d59-tjwvx              2/2     Running   0          6m52s
cnrm-system                       cnrm-webhook-manager-656ffb69d5-6d7cp                      1/1     Running   0          6m52s
configconnector-operator-system   configconnector-operator-0                                 1/1     Running   0          7m46s
kube-system                       event-exporter-gke-59b99fdd9c-qtvzw                        2/2     Running   0          7m49s
kube-system                       fluentd-gke-6zs4n                                          2/2     Running   0          6m37s
. . .</pre>
</div>
</div>
</li>
<li>
<p>Review the output. Deployment is complete when:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>READY</code> column indicates all running containers are available. The entry
in the <code>READY</code> column represents [total number of containers/number of available containers].</p>
</li>
<li>
<p>All entries in the <code>STATUS</code> column indicate <code>Running</code> or <code>Completed</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If necessary, continue to query your cluster&#8217;s status until all the pods are ready.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_38" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/project.html" class="page">Set up a Google Cloud project</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/gke/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="nginx_ingress_controller"><a class="anchor" href="#nginx_ingress_controller"></a>NGINX Ingress Controller</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use the NGINX ingress controller when you deploy the CDM.</p>
</div>
<div class="paragraph">
<p>Remember, <a href="start/start-here.html#cdm-sandbox" class="page">the
CDM is a reference implementation and not for production use</a>.
When you <a href="start/start-here.html#planning" class="page">create a project plan</a>,
you&#8217;ll need to determine which ingress controller to use in production.</p>
</div>
<div class="paragraph">
<p>After you&#8217;ve finished deploying the CDM, you can use the CDM as a
sandbox to explore deployment with a different ingress controller.</p>
</div>
<div class="openblock procedure">
<div class="title">Deploy an NGINX Ingress Controller</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Verify that you initialized your cluster by performing the steps in
<a href="cdm/gke/setup/cluster.html#crate-gke-cluster" class="page">Create a Kubernetes
Cluster for the CDM</a>.</p>
<div class="paragraph">
<p>If you did not set up your cluster using this technique, the cluster might be
missing some required configuration.</p>
</div>
</li>
<li>
<p>Deploy the NGINX ingress controller in your cluster:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>/path/to/forgeops/bin/ingress-controller-deploy.sh -g</strong>
namespace/nginx created
Release "nginx-ingress" does not exist. Installing it now.
NAME: nginx-ingress
LAST DEPLOYED: Mon Sep 28 16:14:33 2020
NAMESPACE: nginx
STATUS: deployed
REVISION: 1
TEST SUITE: None
. . .</pre>
</div>
</div>
</li>
<li>
<p>Check the status of the pods in the <code>nginx</code> namespace until all the pods are
ready:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl get pods --namespace nginx</strong>
NAME                                              READY STATUS    RESTARTS AGE
nginx-ingress-controller-69b755f68b-9l5n8         1/1   Running   0        4m38s</pre>
</div>
</div>
</li>
<li>
<p>Get the ingress controller&#8217;s external IP address:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl get services --namespace nginx</strong>
NAME                                 TYPE           CLUSTER-IP   EXTERNAL-IP      PORT(S)                      AGE
ingress-nginx-controller             LoadBalancer   10.4.6.154   <mark>35.203.145.112</mark>   80:30300/TCP,443:30638/TCP   58s
ingress-nginx-controller-admission   ClusterIP      10.4.4.9     &lt;none&gt;           443/TCP                      58s</pre>
</div>
</div>
<div class="paragraph">
<p>The ingress controller&#8217;s IP address should appear in the <code>EXTERNAL-IP</code> column.
There can be a short delay while the ingress starts before the IP address
appears in the <code>kubectl get services</code> command&#8217;s output; you might need to run
the command several times.</p>
</div>
</li>
<li>
<p>Add an entry similar to the following to your <span class="path"><code>/etc/hosts</code></span> file to
enable local resolution of hostnames used by the platform, Prometheus,
and Grafana UIs and APIs:</p>
<div class="listingblock">
<div class="content">
<pre><code><em>ingress-ip-address</em> prod.iam.example.com prometheus.iam.example.com grafana.iam.example.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <code><em>ingress-ip-address</em></code>, specify the external IP address of the ingress
controller service in the previous command.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_39" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/project.html" class="page">Set up a Google Cloud project</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/gke/setup/cert-manager.html" class="page">Deploy certificate manager</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="certificate_manager"><a class="anchor" href="#certificate_manager"></a>Certificate Manager</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use cert-manager when you deploy the CDM.</p>
</div>
<div class="paragraph">
<p>Remember, <a href="start/start-here.html#cdm-sandbox" class="page">the
CDM is a reference implementation and not for production use</a>.
When you <a href="start/start-here.html#planning" class="page">create a project plan</a>,
you&#8217;ll need to determine how to manage certificates in production.</p>
</div>
<div class="paragraph">
<p>After you&#8217;ve finished deploying the CDM, you can use the CDM as a
sandbox to explore deployment with a different certificate manager.</p>
</div>
<div class="openblock procedure">
<div class="title">Deploy Certificate Manager</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deploy the Certificate Manager in your cluster:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>/path/to/forgeops/bin/certmanager-deploy.sh</strong>
customresourcedefinition.apiextensions.k8s.io/certificaterequests.cert-manager.io created
customresourcedefinition.apiextensions.k8s.io/certificates.cert-manager.io created
customresourcedefinition.apiextensions.k8s.io/challenges.acme.cert-manager.io created
customresourcedefinition.apiextensions.k8s.io/clusterissuers.cert-manager.io created
customresourcedefinition.apiextensions.k8s.io/issuers.cert-manager.io created
customresourcedefinition.apiextensions.k8s.io/orders.acme.cert-manager.io created
namespace/cert-manager created
serviceaccount/cert-manager-cainjector created
serviceaccount/cert-manager created
serviceaccount/cert-manager-webhook created
clusterrole.rbac.authorization.k8s.io/cert-manager-cainjector created
. . .
service/cert-manager created
service/cert-manager-webhook created
deployment.apps/cert-manager-cainjector created
deployment.apps/cert-manager created
deployment.apps/cert-manager-webhook created
mutatingwebhookconfiguration.admissionregistration.k8s.io/cert-manager-webhook created
validatingwebhookconfiguration.admissionregistration.k8s.io/cert-manager-webhook created
deployment.extensions/cert-manager-webhook condition met
clusterissuer.cert-manager.io/default-issuer created
secret/certmanager-ca-secret created</pre>
</div>
</div>
</li>
<li>
<p>Check the status of the pods in the <code>cert-manager</code> namespace until all the pods are ready:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl get pods --namespace cert-manager</strong>
NAME                                              READY STATUS    RESTARTS AGE
cert-manager-6d5fd89bdf-khj5w                     1/1   Running   0        3m57s
cert-manager-cainjector-7d47d59998-h5b48          1/1   Running   0        3m57s
cert-manager-webhook-6559cc8549-8vdtp             1/1   Running   0        3m56s</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_40" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/project.html" class="page">Set up a Google Cloud project</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/gke/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/gke/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prometheus_grafana_and_alertmanager"><a class="anchor" href="#prometheus_grafana_and_alertmanager"></a>Prometheus, Grafana, and Alertmanager</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use Prometheus, Grafana, and Alertmanager when you deploy the CDM.</p>
</div>
<div class="paragraph">
<p>After you&#8217;ve finished deploying the CDM, you can use the CDM as a
sandbox to explore deployment with a different monitoring and alerting
framework.</p>
</div>
<div class="paragraph">
<p>Remember, <a href="start/start-here.html#cdm-sandbox" class="page">the
CDM is a reference implementation and not for production use</a>.
When you <a href="start/start-here.html#planning" class="page">create a project plan</a>,
you&#8217;ll need to determine how to monitor and send alerts in your production
deployment.</p>
</div>
<div class="openblock procedure">
<div class="title">Deploy Prometheus, Grafana, and Alertmanager</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deploy Prometheus, Grafana, and Alertmanager in your cluster. You can safely
ignore <code>info: skipping unknown hook: "crd-install"</code> messages:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>/path/to/forgeops/bin/prometheus-deploy.sh</strong>
namespace/monitoring created
"stable" has been added to your repositories
Release "prometheus-operator" does not exist. Installing it now.
manifest_sorter.go:175: info: skipping unknown hook: "crd-install"
. . .
NAME: prometheus-operator
LAST DEPLOYED: Mon Sep 28 16:47:45 2020
NAMESPACE: monitoring
STATUS: deployed
REVISION: 1
. . .
customresourcedefinition.apiextensions.k8s.io/prometheuses.monitoring.coreos.com condition met
customresourcedefinition.apiextensions.k8s.io/servicemonitors.monitoring.coreos.com condition met
customresourcedefinition.apiextensions.k8s.io/servicemonitors.monitoring.coreos.com condition met
customresourcedefinition.apiextensions.k8s.io/podmonitors.monitoring.coreos.com condition met
customresourcedefinition.apiextensions.k8s.io/alertmanagers.monitoring.coreos.com condition met
Release "forgerock-metrics" does not exist. Installing it now.
NAME: forgerock-metrics
LAST DEPLOYED: Mon Sep 28 16:48:27 2020
NAMESPACE: monitoring
STATUS: deployed
REVISION: 1
TEST SUITE: None</pre>
</div>
</div>
</li>
<li>
<p>Check the status of the pods in the <code>monitoring</code> namespace until all the pods are ready:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl get pods --namespace monitoring</strong>
NAME                                                      READY   STATUS    RESTARTS   AGE
alertmanager-prometheus-operator-alertmanager-0           2/2     Running   0          61s
prometheus-operator-grafana-86dcbfc89-t4r7m               2/2     Running   0          71s
prometheus-operator-kube-state-metrics-66b4c95cd9-cml5t   1/1     Running   0          71s
prometheus-operator-operator-67d8cb455-4jtmg              2/2     Running   0          71s
prometheus-operator-prometheus-node-exporter-47ls8        1/1     Running   0          71s
prometheus-operator-prometheus-node-exporter-bwlzq        1/1     Running   0          71s
prometheus-operator-prometheus-node-exporter-jkzrj        1/1     Running   0          71s
prometheus-operator-prometheus-node-exporter-nnxvw        1/1     Running   0          71s
prometheus-operator-prometheus-node-exporter-vbq9c        1/1     Running   0          71s
prometheus-operator-prometheus-node-exporter-zdq4n        1/1     Running   0          71s
prometheus-prometheus-operator-prometheus-0               3/3     Running   1          51s</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_41" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/project.html" class="page">Set up a Google Cloud project</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/gke/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/gke/setup/push.html" class="page">Prepare to push Docker images</a></mark></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="docker_push_setup_4"><a class="anchor" href="#docker_push_setup_4"></a><span class="command"><code>docker push</code></span> Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the deployment environment you&#8217;re setting up, Skaffold builds Docker images
using the Docker software you&#8217;ve installed on your local computer. After it
builds the images, Skaffold pushes them to a Docker registry available to your
GKE cluster. With the images on the remote Docker registry, Skaffold can
orchestrate the ForgeRock Identity Platform, creating containers from the Docker images.</p>
</div>
<div class="paragraph">
<p>For Skaffold to be able to push the Docker images:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Docker must be running on your local computer.</p>
</li>
<li>
<p>Your local computer needs credentials that let Skaffold push the images to the
Docker registry available to your cluster.</p>
</li>
<li>
<p>Skaffold needs to know the location of the Docker registry.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Perform the following procedure to let Skaffold to push Docker images to a
registry accessible to your cluster:</p>
</div>
<div class="openblock procedure">
<div class="title">Set up Your Local Computer to Push Docker Images</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If it&#8217;s not already running, start Docker on your local computer. For more
information, see the Docker documentation.</p>
</li>
<li>
<p>Set up a Docker credential helper:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>gcloud auth configure-docker</strong></pre>
</div>
</div>
</li>
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command to obtain the Kubernetes context.</p>
</li>
<li>
<p>Configure Skaffold with the Docker registry location for your project and the
Kubernetes context. Use your project ID (<em>not</em> your project name) and the
Kubernetes context that you obtained in the previous step:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>skaffold config set default-repo gcr.io/<em>my-project-ID</em> -k <code><em>my-kubernetes-context</em></code></strong></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_42" class="discrete">Next Step</h3>
<div class="paragraph">
<p>You&#8217;ve completed all the setup tasks for GKE. Now you&#8217;re ready to deploy the
platform in your new cluster:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/intro.html" class="page">Become familiar with the CDM</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/architecture.html" class="page">Understand CDM architecture</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Set up your local environment and create a cluster (<a href="cdm/gke/setup/setup-env.html" class="page">GKE</a>|<a href="cdm/eks/setup/setup-env.html" class="page">EKS</a>|<a href="cdm/aks/setup/setup-env.html" class="page">AKS</a>)</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/deploy.html" class="page">Deploy the platform</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/access.html" class="page">Access platform UIs and APIs</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/next-steps.html" class="page">Explore your deployment and start planning for production</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="environment_setup_eks"><a class="anchor" href="#environment_setup_eks"></a>Environment Setup: EKS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before deploying the CDM, you must set up your local computer, configure
your AWS account, and create an EKS cluster.</p>
</div>
<div class="paragraph">
<p></p>
</div>
<details>
<summary>
Windows users
</summary>
<div class="paragraph">
<p>ForgeRock supports deploying the CDK and CDM using macOS and
Linux. If you have a Windows computer, you&#8217;ll need to create a Linux VM. We
tested using the following configurations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hypervisor: Hyper-V, VMWare Player, or VMWare Workstation</p>
</li>
<li>
<p>Guest OS: Ubuntu 19.10 with 12 GB memory and 60 GB disk space</p>
</li>
<li>
<p>Nested virtualization enabled in the Linux VM.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Perform all the procedures in this documentation within the Linux VM. In this
documentation, the local computer refers to the Linux VM for Windows users.</strong></p>
</div>
</details>
<div class="sect2">
<h3 id="environment_setup_checklist_3"><a class="anchor" href="#environment_setup_checklist_3"></a>Environment Setup Checklist</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/architecture.html" class="page">Understand CDM architecture on EKS</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/aws-env.html" class="page">Set up your AWS environment</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After you&#8217;ve completed all of these environment setup tasks, you&#8217;ll be ready to
<a href="cdm/deploy.html" class="page">deploy the ForgeRock Identity Platform on your new Kubernetes
cluster</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="architecture_overview"><a class="anchor" href="#architecture_overview"></a>Architecture Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following diagram provides an overview of a CDM deployment in the
Amazon EKS environment:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/eks-components-aws.svg" alt="CDM cluster uses two subnets and contains two worker nodes.">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>An AWS stack template is used to create a virtual private cloud (VPC).</p>
</li>
<li>
<p>Three subnets are configured across three availability zones.</p>
</li>
<li>
<p>A Kubernetes cluster is created over the three subnets.</p>
</li>
<li>
<p>Three worker nodes are created within the cluster. The worker nodes contain
the computing infrastructure to run the CDM components.</p>
</li>
<li>
<p>A local file system is mounted to the DS pod for storing directory data
backup.</p>
</li>
</ul>
</div>
<h3 id="next_step_43" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/architecture.html" class="page">Understand CDM architecture on EKS</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/eks/setup/sw.html" class="page">Install third-party software</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/aws-env.html" class="page">Set up your AWS environment</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="third_party_software_6"><a class="anchor" href="#third_party_software_6"></a>Third-Party Software</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before installing the CDM, you must obtain non-ForgeRock software and
install it on your local computer.</p>
</div>
<div class="paragraph">
<p>ForgeRock recommends that you install third-party software using
<a href="https://brew.sh/">Homebrew</a> on macOS and Linux.</p>
</div>
<div class="paragraph">
<p>The versions listed in the following table have been validated for deploying the
CDM on Amazon Web Services. Earlier and later versions will <em>probably</em> work.
If you want to try using versions that are not in the tables, it is your
responsibility to validate them.</p>
</div>
<div class="paragraph">
<p>Install the following third-party software:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Software</th>
<th class="tableblock halign-left valign-top">Version</th>
<th class="tableblock halign-left valign-top">Homebrew package</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker Desktop<sup class="footnote" id="_footnote_docker">[<a id="_footnoteref_22" class="footnote" href="#_footnotedef_22" title="View footnote.">22</a>]</sup>
</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.3.0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker</code> (cask)<sup class="footnote" id="_footnote_linuxbrew">[<a id="_footnoteref_23" class="footnote" href="#_footnotedef_23" title="View footnote.">23</a>]</sup>
</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes client (<span class="command"><code>kubectl</code></span>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.19.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubernetes-cli</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Skaffold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.14.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skaffold</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kustomize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.8.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kustomize</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes context switcher (<span class="command"><code>kubectx</code></span>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubectx</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Helm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.3.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>helm</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Amazon AWS Command Line Interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.0.53</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>awscli</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AWS IAM Authenticator for Kubernetes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>aws-iam-authenticator</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">eksctl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.29.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>eksctl</code></p></td>
</tr>
</tbody>
</table>
<h3 id="next_step_44" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/architecture.html" class="page">Understand CDM architecture on EKS</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/eks/setup/aws-env.html" class="page">Set up your AWS environment</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="aws_environment_setup"><a class="anchor" href="#aws_environment_setup"></a>AWS Environment Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This page outlines how the Cloud Deployment Team set up AWS before deploying the
CDM. We created these resources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A group named <code>cdm_users</code>, with some preconfigured policies, some custom IAM
policies, and one or more users</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>ECR repositories for Docker images</p>
</li>
</ul>
</div>
<div class="openblock procedure">
<div class="title">Set up the AWS Environment for CDM Deployment</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create and configure an IAM group:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Create a group with the name <code>cdm-users</code>.</p>
</li>
<li>
<p>Attach the following AWS preconfigured policies to the <code>cdm-users</code> group:</p>
<div class="ulist">
<ul>
<li>
<p><code>IAMUserChangePassword</code></p>
</li>
<li>
<p><code>IAMReadOnlyAccess</code></p>
</li>
<li>
<p><code>AmazonEC2FullAccess</code></p>
</li>
<li>
<p><code>AmazonEC2ContainerRegistryFullAccess</code></p>
</li>
<li>
<p><code>AWSCloudFormationFullAccess</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Create two policies in the IAM service of your AWS account:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Create the <code>EksAllAccess</code> policy using the <code>eks-all-access.json</code> file in
the <span class="path"><code>/path/to/forgeops/etc/aws-example-iam-policies</code></span> directory.</p>
</li>
<li>
<p>Create the <code>IamLimitedAccess</code> policy using the <code>iam-limited-access.json</code> file
in the <span class="path"><code>/path/to/forgeops/etc/aws-example-iam-policies</code></span> directory.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Attach the policies you created to the <code>cdm-users</code> group.</p>
<div class="paragraph">
<p>Remember, the CDM is a reference implementation and
<a href="start/start-here.html#cdm-sandbox" class="page">is not for production use</a>.
The policies you create in this procedure are suitable for the CDM. When
you <a href="start/start-here.html#planning" class="page">create a project plan</a>,
you&#8217;ll need to determine how to configure AWS permissions.</p>
</div>
</li>
<li>
<p>Assign one or more AWS users who will set up CDM to the <code>cdm-users</code>
group.</p>
</li>
</ol>
</div>
</li>
<li>
<p>If you haven&#8217;t already done so, set up your <span class="command"><code>aws</code></span> command-line
interface environment using the <span class="command"><code>aws configure</code></span> command.</p>
</li>
<li>
<p>Verify that your AWS account is a member of the <code>cdm-users</code> group:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>aws iam list-groups-for-user --user-name <em>my-user-name</em> --output json</strong>
{
    "Groups": [
        {
            "Path": "/",
            "GroupName": "cdm-users",
            "GroupId": "ABCDEFGHIJKLMNOPQRST",
            "Arn": "arn:aws:iam::048497731163:group/cdm-users",
            "CreateDate": "2020-03-11T21:03:17+00:00"
        }
    ]
}</pre>
</div>
</div>
</li>
<li>
<p>The Cloud Deployment Team used the <code>us-east-1</code> region to develop and test
the CDM.</p>
<div class="paragraph">
<p>If you would like to deploy the CDM in a different region, configure the
region as your default region. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>aws configure set default.region us-central-1</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Note the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The region must support Amazon EKS.</p>
</li>
<li>
<p>The region must have at least three availability zones. (Use the
<span class="command"><code>aws ec2 describe-availability-zones --region region-name</code></span> command
to determine the availability zones for an AWS region.)</p>
</li>
<li>
<p>Objects required for your EKS cluster should reside in the same region to
get the best performance. To make sure that AWS objects are created in the
correct region, be sure to set your default region as shown above.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Determine your cluster size:
<a href="cdm/architecture.html#cluster-sizes" class="page">small, medium, or large</a>.</p>
</li>
<li>
<p>If you are <em>not</em> deploying the CDM in the <code>us-east-1</code> region, ensure
that the cluster creation script will support your region:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the <span class="path"><code>/path/to/forgeops/cluster/eks</code></span> directory.</p>
</li>
<li>
<p>Open the configuration file for your selected cluster size. For example,
open the <span class="path"><code>small.yaml</code></span> file if you&#8217;re going to deploy a small-sized
cluster.</p>
</li>
<li>
<p>Specify your region as the <code>metadata</code>/<code>region</code> value.</p>
</li>
<li>
<p>Specify the three availability zones in your region as the
<code>availabilityZones</code> values.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Ensure that your region has an adequate CPU quota for the CDM:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the <span class="path"><code>/path/to/forgeops/cluster/eks</code></span> directory.</p>
</li>
<li>
<p>Open the YAML file that contains the configuration for your selected cluster
size. For example, open the <span class="path"><code>small.yaml</code></span> file if you&#8217;re going to deploy
a small-sized cluster.</p>
</li>
<li>
<p>Locate the two <code>instanceType</code> statements in the <code>nodeGroups</code> section.</p>
</li>
<li>
<p>Your quotas need to let you allocate six machines of each type in your
region. If your quotas are too low, request and wait for a quota increase from
AWS before attempting to create your CDM cluster.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Create Amazon ECR repositories for the ForgeRock Identity Platform Docker images:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>for i in am amster ds-cts ds-idrepo idm ig ldif-importer;
do
  aws ecr create-repository --repository-name "forgeops/${i}";
done</strong>

{
    "repository": {
        "repositoryArn": "arn:aws:ecr:us-east-1:. . .:repository/forgeops/am",
        "registryId": ". . .",
        "repositoryName": "forgeops/am",
        "repositoryUri": ". . . .dkr.ecr.us-east-1.amazonaws.com/forgeops/am",
        "createdAt": "2020-08-03T14:19:54-08:00"
    }
}
. . .</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_45" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/architecture.html" class="page">Understand CDM architecture on EKS</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/aws-env.html" class="page">Set up your AWS environment</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/eks/setup/forgeops.html" class="page">Get the forgeops repository</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="forgeops_repository_6"><a class="anchor" href="#forgeops_repository_6"></a><code>forgeops</code> Repository</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you can deploy the CDK or the CDM, you must first get the
<code>forgeops</code> repository:<sup class="footnote" id="_footnote_release-tag">[<a id="_footnoteref_24" class="footnote" href="#_footnotedef_24" title="View footnote.">24</a>]</sup></p>
</div>
<div class="openblock procedure">
<div class="title">Obtain the forgeops Repository</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone the <code>forgeops</code> repository:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git clone <a href="https://github.com/ForgeRock/forgeops.git" class="bare">https://github.com/ForgeRock/forgeops.git</a></strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>forgeops</code> repository is a public Git repository. You do not need
credentials to clone it.</p>
</div>
</li>
<li>
<p>Check out the <code>2020.10.28-AlSugoDiNoci</code> release tag, creating a branch named
<code><em>my-branch</em></code>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd forgeops</strong>
$ <strong>git checkout tags/2020.10.28-AlSugoDiNoci -b <em>my-branch</em></strong>
Switched to a new branch <em>'my-branch'</em></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_46" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/architecture.html" class="page">Understand CDM architecture on EKS</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/aws-env.html" class="page">Set up your AWS environment</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/eks/setup/cluster.html" class="page">Create a Kubernetes cluster</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="kubernetes_cluster_creation_2"><a class="anchor" href="#kubernetes_cluster_creation_2"></a>Kubernetes Cluster Creation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This page outlines how the Cloud Deployment Team created our cluster.</p>
</div>
<div id="create-eks-cluster" class="openblock procedure">
<div class="title">Create a Kubernetes Cluster for the CDM</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Obtain the following information from your AWS administrator:</p>
<div class="ulist">
<ul>
<li>
<p>The AWS region and zones in which you will create the cluster. The CDM
is deployed in three zones within a single region.</p>
<div class="paragraph">
<p>The Cloud Deployment Team deployed the CDM in three zones of the <code>us-east-1</code>
region.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Create your cluster:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the directory that contains the cluster creation script:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/cluster/eks</strong></pre>
</div>
</div>
</li>
<li>
<p>Run the cluster creation script. Specify the YAML file that contains the
configuration for your cluster size. For example:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>./cluster-up.sh small.yaml</strong></pre>
</div>
</div>
<div class="paragraph">
<p>To verify that the cluster has been created, log in to the AWS console. Select
the EKS service link. You should see the new cluster in the list of Amazon EKS
clusters.</p>
</div>
</li>
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectx</strong>
. . .
<code>user.name@small.us-east-1.eksctl.io</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output should contain your newly created cluster and any existing clusters.</p>
</div>
<div class="paragraph">
<p>The current context should be set to the context for your new cluster.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Check the status of the pods in your cluster until all the pods are ready:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>List all the pods in the cluster:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl get pods --all-namespaces</strong>
NAMESPACE     NAME                       READY   STATUS    RESTARTS   AGE
kube-system   aws-node-4fzmz             1/1     Running   0          9m28s
kube-system   aws-node-btkf9             1/1     Running   0          9m23s
kube-system   aws-node-gbw6b             1/1     Running   0          9m3s
kube-system   aws-node-gtp2x             1/1     Running   0          9m1s
kube-system   aws-node-klv4t             1/1     Running   0          9m28s
kube-system   aws-node-znjt6             1/1     Running   0          9m4s
kube-system   coredns-75b44cb5b4-nm824   1/1     Running   0          25m
kube-system   coredns-75b44cb5b4-xlwpn   1/1     Running   0          25m
kube-system   kube-proxy-4gxgw           1/1     Running   0          9m3s
kube-system   kube-proxy-bb4sr           1/1     Running   0          9m28s
kube-system   kube-proxy-knw77           1/1     Running   0          9m28s
kube-system   kube-proxy-kwq22           1/1     Running   0          9m1s
kube-system   kube-proxy-ptpnf           1/1     Running   0          9m23s
kube-system   kube-proxy-zt4t2           1/1     Running   0          9m4s        66m</pre>
</div>
</div>
</li>
<li>
<p>Review the output. Deployment is complete when:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>READY</code> column indicates all running containers are available. The entry
in the <code>READY</code> column represents [total number of containers/number of available
containers].</p>
</li>
<li>
<p>All entries in the <code>STATUS</code> column indicate <code>Running</code> or <code>Completed</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If necessary, continue to query your cluster&#8217;s status until all the pods are
ready.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_47" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/architecture.html" class="page">Understand CDM architecture on EKS</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/aws-env.html" class="page">Set up your AWS environment</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/eks/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="nginx_ingress_controller_2"><a class="anchor" href="#nginx_ingress_controller_2"></a>NGINX Ingress Controller</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use the NGINX ingress controller when you deploy the CDM.</p>
</div>
<div class="paragraph">
<p>Remember, <a href="start/start-here.html#cdm-sandbox" class="page">the
CDM is a reference implementation and not for production use</a>.
When you <a href="start/start-here.html#planning" class="page">create a project plan</a>,
you&#8217;ll need to determine which ingress controller to use in production.</p>
</div>
<div class="paragraph">
<p>After you&#8217;ve finished deploying the CDM, you can use the CDM as a
sandbox to explore deployment with a different ingress controller.</p>
</div>
<div class="openblock procedure">
<div class="title">Deploy an NGINX Ingress Controller</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Verify that you initialized your cluster by performing the steps in
<a href="cdm/eks/setup/cluster.html#create-eks-cluster" class="page">Create a Kubernetes
Cluster for the CDM</a>.</p>
<div class="paragraph">
<p>If you did not set up your cluster using this technique, the cluster might be
missing some required configuration.</p>
</div>
</li>
<li>
<p>Deploy the NGINX ingress controller in your cluster:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>/path/to/forgeops/bin/ingress-controller-deploy.sh -e</strong>
namespace/nginx created
Detected cluster of type: cdm-small
Setting ingress pod count to 2
"ingress-nginx" has been added to your repositories
Release "ingress-nginx" does not exist. Installing it now.
NAME: ingress-nginx
LAST DEPLOYED: Thu Oct  1 13:02:30 2020
NAMESPACE: nginx
STATUS: deployed
REVISION: 1
TEST SUITE: None
NOTES:
. . .</pre>
</div>
</div>
</li>
<li>
<p>Check the status of the pods in the <code>nginx</code> namespace until all the pods are ready:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl get pods --namespace nginx</strong>
NAME                                       READY   STATUS    RESTARTS   AGE
ingress-nginx-controller-bb566bf7b-c9kmk   1/1     Running   0          2m45s
ingress-nginx-controller-bb566bf7b-l6dz6   1/1     Running   0          2m45s</pre>
</div>
</div>
</li>
<li>
<p>Obtain the DNS name (shown under EXTERNAL-IP column) of the load balancer :</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl get services --namespace nginx</strong>
NAME                                 TYPE           CLUSTER-IP     EXTERNAL-IP                                    PORT(S)                      AGE
ingress-nginx-controller             LoadBalancer   10.100.43.88   a4f33a6b. . .ca4.elb.us-east-1.amazonaws.com   80:30005/TCP,443:30770/TCP   62s
ingress-nginx-controller-admission   ClusterIP      10.100.2.215   &lt;none&gt;                                         443/TCP                      62s</pre>
</div>
</div>
</li>
<li>
<p>Wait for a couple of minutes for the load balancer to be assigned the external
IP address. Then, get the external IP addresses of the load balancer. For example:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>host ac5f2939. . .42d085.elb.us-east-1.amazonaws.com</strong>
ac5f2939. . .42d085.elb.us-east-1.amazonaws.com has address 54.65.76.87
ac5f2939. . .42d085.elb.us-east-1.amazonaws.com has address 3.210.123.210
ac5f2939. . .42d085.elb.us-east-1.amazonaws.com has address 3.220.78.123</pre>
</div>
</div>
<div class="paragraph">
<p>The <span class="command"><code>host</code></span> command returns several IP addresses. You can use any of
the IP addresses when you modify your local hosts file in the next step for evaluation
purposes. You must create an appropriate entry in your DNS servers for production
deployments.</p>
</div>
</li>
<li>
<p>Add an entry similar to the following to your <span class="path"><code>/etc/hosts</code></span> file to
enable local resolution of hostnames used by the platform, Prometheus,
and Grafana UIs and APIs:</p>
<div class="listingblock">
<div class="content">
<pre><code><em>ingress-ip-address</em> prod.iam.example.com prometheus.iam.example.com grafana.iam.example.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <code><em>ingress-ip-address</em></code>, specify the external IP of the ingress controller
service in the previous command.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_48" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/architecture.html" class="page">Understand CDM architecture on EKS</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/aws-env.html" class="page">Set up your AWS environment</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/eks/setup/cert-manager.html" class="page">Deploy certificate manager</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="certificate_manager_2"><a class="anchor" href="#certificate_manager_2"></a>Certificate Manager</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use cert-manager when you deploy the CDM.</p>
</div>
<div class="paragraph">
<p>Remember, <a href="start/start-here.html#cdm-sandbox" class="page">the
CDM is a reference implementation and not for production use</a>.
When you <a href="start/start-here.html#planning" class="page">create a project plan</a>,
you&#8217;ll need to determine how to manage certificates in production.</p>
</div>
<div class="paragraph">
<p>After you&#8217;ve finished deploying the CDM, you can use the CDM as a
sandbox to explore deployment with a different certificate manager.</p>
</div>
<div class="openblock procedure">
<div class="title">Deploy Certificate Manager</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deploy the Certificate Manager in your cluster:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>/path/to/forgeops/bin/certmanager-deploy.sh</strong>

customresourcedefinition.apiextensions.k8s.io/certificaterequests.cert-manager.io created
customresourcedefinition.apiextensions.k8s.io/certificates.cert-manager.io created
customresourcedefinition.apiextensions.k8s.io/challenges.acme.cert-manager.io created
customresourcedefinition.apiextensions.k8s.io/clusterissuers.cert-manager.io created
customresourcedefinition.apiextensions.k8s.io/issuers.cert-manager.io created
customresourcedefinition.apiextensions.k8s.io/orders.acme.cert-manager.io created
namespace/cert-manager created
serviceaccount/cert-manager-cainjector created
serviceaccount/cert-manager created
serviceaccount/cert-manager-webhook created
clusterrole.rbac.authorization.k8s.io/cert-manager-cainjector created
. . .
service/cert-manager created
service/cert-manager-webhook created
deployment.apps/cert-manager-cainjector created
deployment.apps/cert-manager created
deployment.apps/cert-manager-webhook created
mutatingwebhookconfiguration.admissionregistration.k8s.io/cert-manager-webhook created
validatingwebhookconfiguration.admissionregistration.k8s.io/cert-manager-webhook created
deployment.extensions/cert-manager-webhook condition met
clusterissuer.cert-manager.io/default-issuer created
secret/certmanager-ca-secret created</pre>
</div>
</div>
</li>
<li>
<p>Check the status of the pods in the <code>cert-manager</code> namespace until all the pods
are ready:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl get pods --namespace cert-manager</strong>

NAME                                              READY STATUS    RESTARTS AGE
cert-manager-6d5fd89bdf-khj5w                     1/1   Running   0        3m57s
cert-manager-cainjector-7d47d59998-h5b48          1/1   Running   0        3m57s
cert-manager-webhook-6559cc8549-8vdtp             1/1   Running   0        3m56s</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_49" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/architecture.html" class="page">Understand CDM architecture on EKS</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/aws-env.html" class="page">Set up your AWS environment</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/eks/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/eks/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prometheus_grafana_and_alertmanager_2"><a class="anchor" href="#prometheus_grafana_and_alertmanager_2"></a>Prometheus, Grafana, and Alertmanager</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use Prometheus, Grafana, and Alertmanager when you deploy the CDM.</p>
</div>
<div class="paragraph">
<p>After you&#8217;ve finished deploying the CDM, you can use the CDM as a
sandbox to explore deployment with a different monitoring and alerting
framework.</p>
</div>
<div class="paragraph">
<p>Remember, <a href="start/start-here.html#cdm-sandbox" class="page">the
CDM is a reference implementation and not for production use</a>.
When you <a href="start/start-here.html#planning" class="page">create a project plan</a>,
you&#8217;ll need to determine how to monitor and send alerts in your production
deployment.</p>
</div>
<div class="openblock procedure">
<div class="title">Deploy Prometheus, Grafana, and Alertmanager</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deploy Prometheus, Grafana, and Alertmanager in your cluster. You can safely
ignore <code>info: skipping unknown hook: "crd-install"</code> messages:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>/path/to/forgeops/bin/prometheus-deploy.sh</strong>
namespace/monitoring created
"stable" has been added to your repositories
Release "prometheus-operator" does not exist. Installing it now.
manifest_sorter.go:175: info: skipping unknown hook: "crd-install"
. . .
NAME: prometheus-operator
LAST DEPLOYED: Mon Aug 10 16:47:45 2020
NAMESPACE: monitoring
STATUS: deployed
REVISION: 1
NOTES:
<strong><strong></strong><strong></strong></strong><strong><strong></strong><strong></strong>*
</strong>* DEPRECATED <strong><strong>*
</strong><strong></strong></strong><strong><strong></strong><strong></strong></strong>**
. . .
customresourcedefinition.apiextensions.k8s.io/prometheuses.monitoring.coreos.com condition met
customresourcedefinition.apiextensions.k8s.io/servicemonitors.monitoring.coreos.com condition met
customresourcedefinition.apiextensions.k8s.io/servicemonitors.monitoring.coreos.com condition met
customresourcedefinition.apiextensions.k8s.io/podmonitors.monitoring.coreos.com condition met
customresourcedefinition.apiextensions.k8s.io/alertmanagers.monitoring.coreos.com condition met
Release "forgerock-metrics" does not exist. Installing it now.
NAME: forgerock-metrics
LAST DEPLOYED: Mon Aug 10 16:48:27 2020
NAMESPACE: monitoring
STATUS: deployed
REVISION: 1
TEST SUITE: None</pre>
</div>
</div>
</li>
<li>
<p>Check the status of the pods in the <code>monitoring</code> namespace until all the pods
are ready:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl get pods --namespace monitoring</strong>
NAME                                                READY STATUS    RESTARTS AGE
alertmanager-prometheus-operator-alertmanager-0     2/2   Running   0        5m8s
prometheus-operator-grafana-7b8598c98f-glhmn        2/2   Running   0        5m16s
prometheus-operator-kube-state-metrics-. . .        1/1   Running   0        5m16s
prometheus-operator-operator-55966c69dd-76v46       2/2   Running   0        5m16s
prometheus-operator-prometheus-node-exporter-82r4b  1/1   Running   0        5m16s
prometheus-operator-prometheus-node-exporter-85ns8  1/1   Running   0        5m16s
prometheus-operator-prometheus-node-exporter-kgwln  1/1   Running   0        5m16s
prometheus-operator-prometheus-node-exporter-rrwrx  1/1   Running   0        5m16s
prometheus-operator-prometheus-node-exporter-vl8f9  1/1   Running   0        5m16s
prometheus-operator-prometheus-node-exporter-xmjrf  1/1   Running   0        5m16s
prometheus-prometheus-operator-prometheus-0         3/3   Running   1        4m57s</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_50" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/architecture.html" class="page">Understand CDM architecture on EKS</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/aws-env.html" class="page">Set up your AWS environment</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/eks/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/eks/setup/push.html" class="page">Prepare to push Docker images</a></mark></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="docker_push_setup_5"><a class="anchor" href="#docker_push_setup_5"></a><span class="command"><code>docker push</code></span> Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the deployment environment you&#8217;re setting up, Skaffold builds Docker images
using the Docker software you&#8217;ve installed on your local computer. After it
builds the images, Skaffold pushes them to a Docker registry available to your
Amazon EKS cluster. With the images on the remote Docker registry, Skaffold can
orchestrate the ForgeRock Identity Platform, creating containers from the Docker images.</p>
</div>
<div class="paragraph">
<p>For Skaffold to be able to push the Docker images:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Docker must be running on your local computer.</p>
</li>
<li>
<p>Your local computer needs credentials that let Skaffold push the images to the
Docker registry available to the shared cluster.</p>
</li>
<li>
<p>Skaffold needs to know the location of the Docker registry.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Perform the following procedure to let Skaffold to push Docker images to a
registry accessible to your cluster:</p>
</div>
<div class="openblock procedure">
<div class="title">Set up Your Local Computer to Push Docker Images</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If it&#8217;s not already running, start Docker on your local computer. For more
information, see the Docker documentation.</p>
</li>
<li>
<p>Obtain your 12 digit AWS account ID. You&#8217;ll need it when you run subsequent
steps in this procedure.</p>
</li>
<li>
<p>Log in to Amazon ECR:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>aws ecr get-login-password | docker login --username AWS  \
 --password-stdin <em>my-account-id</em>.dkr.ecr.<em>my-region</em>.amazonaws.com</strong>
Login Succeeded</pre>
</div>
</div>
<div class="paragraph">
<p>ECR login sessions expire after 12 hours. Because of this, you&#8217;ll need to log in
again whenever your login session expires
<sup class="footnote">[<a id="_footnoteref_25" class="footnote" href="#_footnotedef_25" title="View footnote.">25</a>]</sup>.</p>
</div>
</li>
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command to obtain the Kubernetes context.</p>
</li>
<li>
<p>Configure Skaffold with your Docker registry location and the Kubernetes context:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>skaffold config \
 set default-repo <em>my-account-id</em>.dkr.ecr.<em>my-region</em>.amazonaws.com/forgeops \
 -k <em>my-kubernetes-context</em></strong>
set value default-repo to <em>my-account-id</em>.dkr.ecr.<em>my-region</em>.amazonaws.com/forgeops
for context <em>my-kubernetes-context</em></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_51" class="discrete">Next Step</h3>
<div class="paragraph">
<p>You&#8217;ve completed all the setup tasks for EKS. Now you&#8217;re ready to deploy the
platform in your new cluster:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/intro.html" class="page">Become familiar with the CDM</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/architecture.html" class="page">Understand CDM architecture</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Set up your local environment and create a cluster (<a href="cdm/gke/setup/setup-env.html" class="page">GKE</a>|<a href="cdm/eks/setup/setup-env.html" class="page">EKS</a>|<a href="cdm/aks/setup/setup-env.html" class="page">AKS</a>)</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/deploy.html" class="page">Deploy the platform</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/access.html" class="page">Access platform UIs and APIs</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/next-steps.html" class="page">Explore your deployment and start planning for production</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="environment_setup_aks"><a class="anchor" href="#environment_setup_aks"></a>Environment Setup: AKS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before deploying the CDM, you must set up your local computer, configure
an Azure subscription, and create a AKS cluster.</p>
</div>
<div class="paragraph">
<p></p>
</div>
<details>
<summary>
Windows users
</summary>
<div class="paragraph">
<p>ForgeRock supports deploying the CDK and CDM using macOS and
Linux. If you have a Windows computer, you&#8217;ll need to create a Linux VM. We
tested using the following configurations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hypervisor: Hyper-V, VMWare Player, or VMWare Workstation</p>
</li>
<li>
<p>Guest OS: Ubuntu 19.10 with 12 GB memory and 60 GB disk space</p>
</li>
<li>
<p>Nested virtualization enabled in the Linux VM.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Perform all the procedures in this documentation within the Linux VM. In this
documentation, the local computer refers to the Linux VM for Windows users.</strong></p>
</div>
</details>
<div class="sect2">
<h3 id="environment_setup_checklist_4"><a class="anchor" href="#environment_setup_checklist_4"></a>Environment Setup Checklist</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/subscription.html" class="page">Set up an Azure subscription</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After you&#8217;ve completed all of these environment setup tasks, you&#8217;ll be ready to
<a href="cdm/deploy.html" class="page">deploy the ForgeRock Identity Platform on your new Kubernetes
cluster</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="third_party_software_7"><a class="anchor" href="#third_party_software_7"></a>Third-Party Software</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before installing the CDM, you must obtain non-ForgeRock software and
install it on your local computer.</p>
</div>
<div class="paragraph">
<p>ForgeRock recommends that you install third-party software using
<a href="https://brew.sh/">Homebrew</a> on macOS and Linux.</p>
</div>
<div class="paragraph">
<p>The versions listed in the following table have been validated for deploying the
CDM on Microsoft Azure. Earlier and later versions will <em>probably</em> work.
If you want to try using versions that are not in the tables, it is your
responsibility to validate them.</p>
</div>
<div class="paragraph">
<p>Install the following third-party software:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Software</th>
<th class="tableblock halign-left valign-top">Version</th>
<th class="tableblock halign-left valign-top">Homebrew package</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker Desktop<sup class="footnote" id="_footnote_docker">[<a id="_footnoteref_26" class="footnote" href="#_footnotedef_26" title="View footnote.">26</a>]</sup>
</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.3.0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker</code> (cask)<sup class="footnote" id="_footnote_linuxbrew">[<a id="_footnoteref_27" class="footnote" href="#_footnotedef_27" title="View footnote.">27</a>]</sup>
</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes client (<span class="command"><code>kubectl</code></span>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.19.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubernetes-cli</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Skaffold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.14.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skaffold</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kustomize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.8.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kustomize</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes context switcher (<span class="command"><code>kubectx</code></span>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubectx</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Helm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.3.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>helm</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Azure Command Line Interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.11.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>azure-cli</code></p></td>
</tr>
</tbody>
</table>
<h3 id="next_step_52" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/aks/setup/subscription.html" class="page">Set up an Azure subscription</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="azure_subscription_setup"><a class="anchor" href="#azure_subscription_setup"></a>Azure Subscription Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The CDM runs in a Kubernetes cluster in an Azure subscription.</p>
</div>
<div class="paragraph">
<p>This page outlines how the Cloud Deployment Team created and configured our
Azure subscription before we created our cluster.</p>
</div>
<div class="paragraph">
<p>To replicate Azure subscription creation and configuration, follow this procedure:</p>
</div>
<div class="openblock procedure">
<div class="title">Configure an Azure Subscription for the CDM</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Assign the following roles to users who will deploy the CDM:</p>
<div class="ulist">
<ul>
<li>
<p>Azure Kubernetes Service Cluster Admin Role</p>
</li>
<li>
<p>Azure Kubernetes Service Cluster User Role</p>
</li>
<li>
<p>Contributor</p>
</li>
<li>
<p>User Access Administrator</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Remember, the CDM is a reference implementation, and is
<a href="start/start-here.html#cdm-sandbox" class="page">not for production use</a>.
The roles you assign in this step are suitable for the CDM. When you
<a href="start/start-here.html#planning" class="page">create a project plan</a>,
you&#8217;ll need to determine which Azure roles are required.</p>
</div>
</li>
<li>
<p>Log in to Azure services as a user with the roles you assigned in the previous step:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>az login --username <code><em>my-user-name</em></code></strong></pre>
</div>
</div>
</li>
<li>
<p>View your current subscription ID:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>az account show</strong></pre>
</div>
</div>
</li>
<li>
<p>If necessary, set the current subscription ID to the one you will use to
deploy the CDM:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>az account set --subscription <code><em>my-subscription-id</em></code></strong></pre>
</div>
</div>
</li>
<li>
<p>The Cloud Deployment Team used the <code>eastus</code> region to develop and test
the CDM.</p>
<div class="paragraph">
<p>If you would like to deploy the CDM in a different region, set that
region as your default location. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>az configure --defaults location=westus2</strong></pre>
</div>
</div>
<div class="paragraph">
<p>When changing the region for deploying the CDM:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The region must support AKS.</p>
</li>
<li>
<p>The subscription, resource groups, and resources you create for your AKS
cluster must reside in the same region.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Determine the cluster size:
<a href="cdm/architecture.html#cluster-sizes" class="page">small, medium, or large</a>.</p>
</li>
<li>
<p>Ensure that your region has an adequate CPU quota for the CDM:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the <span class="path"><code>/path/to/forgeops/cluster/aks</code></span> directory.</p>
</li>
<li>
<p>Open the script that sets environment variables for your selected cluster
size. For example, open the <span class="path"><code>small.sh</code></span> script if you&#8217;re going to deploy
a small-sized cluster.</p>
</li>
<li>
<p>Locate the statements that set the <code>VM_SIZE</code> and <code>DS_VM_SIZE</code> environment
variables.</p>
</li>
<li>
<p>Your quotas need to let you allocate six machines of each type in your
region. If your quotas are too low, request and wait for a quota increase from
Microsoft before attempting to create your CDM cluster.</p>
</li>
</ol>
</div>
</li>
<li>
<p>The CDM uses Azure Container Registry (ACR) for storing Docker images.</p>
<div class="paragraph">
<p>If you do not have a container registry in your subscription, create one.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_53" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/subscription.html" class="page">Set up an Azure subscription</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/aks/setup/forgeops.html" class="page">Get the forgeops repository</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="forgeops_repository_7"><a class="anchor" href="#forgeops_repository_7"></a><code>forgeops</code> Repository</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you can deploy the CDK or the CDM, you must first get the
<code>forgeops</code> repository:<sup class="footnote" id="_footnote_release-tag">[<a id="_footnoteref_28" class="footnote" href="#_footnotedef_28" title="View footnote.">28</a>]</sup></p>
</div>
<div class="openblock procedure">
<div class="title">Obtain the forgeops Repository</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone the <code>forgeops</code> repository:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git clone <a href="https://github.com/ForgeRock/forgeops.git" class="bare">https://github.com/ForgeRock/forgeops.git</a></strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>forgeops</code> repository is a public Git repository. You do not need
credentials to clone it.</p>
</div>
</li>
<li>
<p>Check out the <code>2020.10.28-AlSugoDiNoci</code> release tag, creating a branch named
<code><em>my-branch</em></code>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd forgeops</strong>
$ <strong>git checkout tags/2020.10.28-AlSugoDiNoci -b <em>my-branch</em></strong>
Switched to a new branch <em>'my-branch'</em></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_54" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/subscription.html" class="page">Set up an Azure subscription</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/aks/setup/cluster.html" class="page">Create a Kubernetes cluster</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="kubernetes_cluster_creation_3"><a class="anchor" href="#kubernetes_cluster_creation_3"></a>Kubernetes Cluster Creation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This page outlines how the Cloud Deployment Team created our cluster.</p>
</div>
<div id="create-aks-cluster" class="openblock procedure">
<div class="title">Create a Kubernetes Cluster for the CDM</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the cluster:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the directory that contains the cluster creation script:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/cluster/aks</strong></pre>
</div>
</div>
</li>
<li>
<p>Source the script that contains the configuration for your cluster size. For
example:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>source ./small.sh</strong></pre>
</div>
</div>
</li>
<li>
<p>Run the cluster creation script:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>./cluster-up.sh</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The script creates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The cluster</p>
</li>
<li>
<p>The DS node pool</p>
</li>
<li>
<p>The <code>fast</code> storage class</p>
</li>
<li>
<p>The <code>prod</code> namespace</p>
</li>
<li>
<p>A public static IP address</p>
</li>
</ul>
</div>
</li>
<li>
<p>To verify that the script created the cluster, log in to the Azure portal.
Select the Kubernetes Engine option. You should see the new cluster in
the list of Kubernetes clusters.</p>
</li>
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command.</p>
<div class="paragraph">
<p>The output should contain your newly created cluster and any existing clusters.</p>
</div>
<div class="paragraph">
<p>The current context should be set to the context for your new cluster.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Check the status of the pods in your cluster until all the pods are ready:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>List all the pods in the cluster:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl get pods --all-namespaces</strong>
NAMESPACE     NAME                                         READY   STATUS    RESTARTS   AGE
kube-system   azure-cni-networkmonitor-7jhxs               1/1     Running   0          22m
kube-system   azure-cni-networkmonitor-7js4b               1/1     Running   0          20m
. . .
kube-system   azure-ip-masq-agent-2vdnb                    1/1     Running   0          22m
. . .</pre>
</div>
</div>
</li>
<li>
<p>Review the output. Deployment is complete when:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>READY</code> column indicates all running containers are available. The entry
in the <code>READY</code> column represents [total number of containers/number of available
containers].</p>
</li>
<li>
<p>All entries in the <code>STATUS</code> column indicate <code>Running</code> or <code>Completed</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If necessary, continue to query your cluster&#8217;s status until all the pods are ready.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_55" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/subscription.html" class="page">Set up an Azure subscription</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/aks/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="nginx_ingress_controller_3"><a class="anchor" href="#nginx_ingress_controller_3"></a>NGINX Ingress Controller</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use the NGINX ingress controller when you deploy the CDM.</p>
</div>
<div class="paragraph">
<p>Remember, <a href="start/start-here.html#cdm-sandbox" class="page">the
CDM is a reference implementation and not for production use</a>.
When you <a href="start/start-here.html#planning" class="page">create a project plan</a>,
you&#8217;ll need to determine which ingress controller to use in production.</p>
</div>
<div class="paragraph">
<p>After you&#8217;ve finished deploying the CDM, you can use the CDM as a
sandbox to explore deployment with a different ingress controller.</p>
</div>
<div class="openblock procedure">
<div class="title">Deploy an NGINX Ingress Controller</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Verify that you initialized your cluster by performing the steps in
<a href="cdm/aks/setup/cluster.html#ccreate-aks-cluster" class="page">Create a Kubernetes
Cluster for the CDM</a>.</p>
<div class="paragraph">
<p>If you did not set up your cluster using this technique, the cluster might be
missing some required configuration.</p>
</div>
</li>
<li>
<p>Deploy the NGINX ingress controller in your cluster:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>/path/to/forgeops/bin/ingress-controller-deploy.sh -a</strong>
namespace/nginx created
Release "nginx-ingress" does not exist. Installing it now.
NAME: nginx-ingress
. . .</pre>
</div>
</div>
</li>
<li>
<p>Check the status of the pods in the <code>nginx</code> namespace until all the pods are
ready:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl get pods --namespace nginx</strong>
NAME                                              READY STATUS    RESTARTS AGE
nginx-ingress-controller-69b755f68b-9l5n8         1/1   Running   0        4m38s</pre>
</div>
</div>
</li>
<li>
<p>Get the ingress controller&#8217;s public IP address:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl get services --namespace nginx</strong>
NAME                                 TYPE           CLUSTER-IP     EXTERNAL-IP   PORT(S)                      AGE
ingress-nginx-controller             LoadBalancer   10.0.149.206   <mark>20.51.97.25</mark>   80:30378/TCP,443:31333/TCP   25s
ingress-nginx-controller-admission   ClusterIP      10.0.87.188    &lt;none&gt;        443/TCP                      25s</pre>
</div>
</div>
<div class="paragraph">
<p>The ingress controller&#8217;s IP address should appear in the <code>EXTERNAL-IP</code> column.
There can be a short delay while the ingress starts before the IP address
appears in the <code>kubectl get services</code> command&#8217;s output; you might need to run
the command several times.</p>
</div>
</li>
<li>
<p>Add an entry similar to the following to your <span class="path"><code>/etc/hosts</code></span> file to
enable local resolution of hostnames used by the platform, Prometheus,
and Grafana UIs and APIs:</p>
<div class="listingblock">
<div class="content">
<pre><code><em>ingress-ip-address</em> prod.iam.example.com prometheus.iam.example.com grafana.iam.example.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <code><em>ingress-ip-address</em></code>, specify the public IP address of the ingress
controller service in the previous command.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_56" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/subscription.html" class="page">Set up an Azure subscription</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/aks/setup/cert-manager.html" class="page">Deploy certificate manager</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="certificate_manager_3"><a class="anchor" href="#certificate_manager_3"></a>Certificate Manager</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use cert-manager when you deploy the CDM.</p>
</div>
<div class="paragraph">
<p>Remember, <a href="start/start-here.html#cdm-sandbox" class="page">the
CDM is a reference implementation and not for production use</a>.
When you <a href="start/start-here.html#planning" class="page">create a project plan</a>,
you&#8217;ll need to determine how to manage certificates in production.</p>
</div>
<div class="paragraph">
<p>After you&#8217;ve finished deploying the CDM, you can use the CDM as a
sandbox to explore deployment with a different certificate manager.</p>
</div>
<div class="openblock procedure">
<div class="title">Deploy Certificate Manager</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deploy the Certificate Manager in your cluster:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>/path/to/forgeops/bin/certmanager-deploy.sh</strong>
customresourcedefinition.apiextensions.k8s.io/certificaterequests.cert-manager.io created
customresourcedefinition.apiextensions.k8s.io/certificates.cert-manager.io created
customresourcedefinition.apiextensions.k8s.io/challenges.acme.cert-manager.io created
customresourcedefinition.apiextensions.k8s.io/clusterissuers.cert-manager.io created
customresourcedefinition.apiextensions.k8s.io/issuers.cert-manager.io created
customresourcedefinition.apiextensions.k8s.io/orders.acme.cert-manager.io created
namespace/cert-manager created
serviceaccount/cert-manager-cainjector created
serviceaccount/cert-manager created
serviceaccount/cert-manager-webhook created
clusterrole.rbac.authorization.k8s.io/cert-manager-cainjector created
. . .
service/cert-manager created
service/cert-manager-webhook created
deployment.apps/cert-manager-cainjector created
deployment.apps/cert-manager created
deployment.apps/cert-manager-webhook created
mutatingwebhookconfiguration.admissionregistration.k8s.io/cert-manager-webhook created
validatingwebhookconfiguration.admissionregistration.k8s.io/cert-manager-webhook created
deployment.extensions/cert-manager-webhook condition met
clusterissuer.cert-manager.io/default-issuer created
secret/certmanager-ca-secret created</pre>
</div>
</div>
</li>
<li>
<p>Check the status of the pods in the <code>cert-manager</code> namespace until all the pods
are ready:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl get pods --namespace cert-manager</strong>
NAME                                              READY STATUS    RESTARTS AGE
cert-manager-6d5fd89bdf-khj5w                     1/1   Running   0        3m57s
cert-manager-cainjector-7d47d59998-h5b48          1/1   Running   0        3m57s
cert-manager-webhook-6559cc8549-8vdtp             1/1   Running   0        3m56s</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_57" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/subscription.html" class="page">Set up an Azure subscription</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <mark><a href="cdm/aks/setup/cert-manager.html" class="page">Deploy certificate manager</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/aks/setup/push.html" class="page">Prepare to push Docker images</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prometheus_grafana_and_alert_manager"><a class="anchor" href="#prometheus_grafana_and_alert_manager"></a>Prometheus, Grafana, and Alert Manager</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use Prometheus, Grafana, and Alertmanager when you deploy the CDM.</p>
</div>
<div class="paragraph">
<p>After you&#8217;ve finished deploying the CDM, you can use the CDM as a
sandbox to explore deployment with a different monitoring and alerting
framework.</p>
</div>
<div class="paragraph">
<p>Remember, <a href="start/start-here.html#cdm-sandbox" class="page">the
CDM is a reference implementation and not for production use</a>.
When you <a href="start/start-here.html#planning" class="page">create a project plan</a>,
you&#8217;ll need to determine how to monitor and send alerts in your production
deployment.</p>
</div>
<div class="openblock procedure">
<div class="title">Deploy Prometheus, Grafana, and Alertmanager</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deploy Prometheus, Grafana, and Alertmanager in your cluster. You can safely
ignore <code>info: skipping unknown hook: "crd-install"</code> messages:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>/path/to/forgeops/bin/prometheus-deploy.sh</strong>
namespace/monitoring created
"stable" has been added to your repositories
Release "prometheus-operator" does not exist. Installing it now.
manifest_sorter.go:175: info: skipping unknown hook: "crd-install"
. . .
NAME: prometheus-operator
LAST DEPLOYED: Mon Aug 17 16:47:45 2020
NAMESPACE: monitoring
STATUS: deployed
REVISION: 1
. . .
customresourcedefinition.apiextensions.k8s.io/prometheuses.monitoring.coreos.com condition met
customresourcedefinition.apiextensions.k8s.io/servicemonitors.monitoring.coreos.com condition met
customresourcedefinition.apiextensions.k8s.io/servicemonitors.monitoring.coreos.com condition met
customresourcedefinition.apiextensions.k8s.io/podmonitors.monitoring.coreos.com condition met
customresourcedefinition.apiextensions.k8s.io/alertmanagers.monitoring.coreos.com condition met
Release "forgerock-metrics" does not exist. Installing it now.
NAME: forgerock-metrics
LAST DEPLOYED: Mon Aug 17 16:48:27 2020
NAMESPACE: monitoring
STATUS: deployed
REVISION: 1
TEST SUITE: None</pre>
</div>
</div>
</li>
<li>
<p>Check the status of the pods in the <code>monitoring</code> namespace until all the pods
are ready:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl get pods --namespace monitoring</strong>
NAME                                                  READY STATUS    RESTARTS AGE
alertmanager-prometheus-operator-alertmanager-0       2/2   Running   0        5m8s
prometheus-operator-grafana-7b8598c98f-glhmn          2/2   Running   0        5m16s
prometheus-operator-kube-state-metrics-. . .          1/1   Running   0        5m16s
prometheus-operator-operator-55966c69dd-76v46         2/2   Running   0        5m16s
prometheus-operator-prometheus-node-exporter-2tc48    1/1   Running   0        3m31s
prometheus-operator-prometheus-node-exporter-4p4mr    1/1   Running   0        3m31s
prometheus-operator-prometheus-node-exporter-4vz75    1/1   Running   0        3m31s
prometheus-operator-prometheus-node-exporter-5vbnw    1/1   Running   0        3m32s
prometheus-operator-prometheus-node-exporter-9vflt    1/1   Running   0        3m31s
prometheus-operator-prometheus-node-exporter-bhmzn    1/1   Running   0        3m31s
prometheus-operator-prometheus-node-exporter-hdjqm    1/1   Running   0        3m31s
prometheus-operator-prometheus-node-exporter-hxwzw    1/1   Running   0        3m31s
prometheus-operator-prometheus-node-exporter-kbrm9    1/1   Running   0        3m31s
prometheus-operator-prometheus-node-exporter-ktpfs    1/1   Running   0        3m31s
prometheus-operator-prometheus-node-exporter-sm85n    1/1   Running   0        3m31s
prometheus-operator-prometheus-node-exporter-xntgk    1/1   Running   0        3m31s
prometheus-prometheus-operator-prometheus-0           3/3   Running   1        4m57s</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_58" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/subscription.html" class="page">Set up an Azure subscription</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/forgeops.html" class="page">Get the forgeops repository</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/cluster.html" class="page">Create a Kubernetes cluster</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/secret-agent.html" class="page">Install the Secret Agent operator</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/nginx.html" class="page">Deploy the NGINX ingress controller</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/cert-manager.html" class="page">Deploy certificate manager</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/aks/setup/prometheus.html" class="page">Deploy Prometheus, Grafana, and Alertmanager</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/aks/setup/push.html" class="page">Prepare to push Docker images</a></mark></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="docker_push_setup_6"><a class="anchor" href="#docker_push_setup_6"></a><span class="command"><code>docker push</code></span> Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the deployment environment you&#8217;re setting up, Skaffold builds Docker images
using the Docker software you&#8217;ve installed on your local computer. After it
builds the images, Skaffold pushes them to a Docker registry available to your
AKS cluster. With the images on the remote Docker registry, Skaffold can
orchestrate the ForgeRock Identity Platform, creating containers from the Docker images.</p>
</div>
<div class="paragraph">
<p>For Skaffold to push the Docker images:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Docker must be running on your local computer.</p>
</li>
<li>
<p>Your local computer needs credentials that let Skaffold push the images to the
Docker repository available to your cluster.</p>
</li>
<li>
<p>Skaffold needs to know the location of the Docker repository.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Perform the following procedure to let Skaffold to push Docker images to a
registry accessible to your cluster:</p>
</div>
<div class="openblock procedure">
<div class="title">Set up Your Local Computer to Push Docker Images</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If it&#8217;s not already running, start Docker on your local computer. For more
information, see the Docker documentation.</p>
</li>
<li>
<p>If you don&#8217;t already have the name of the container registry that will hold
ForgeRock Docker images, obtain it from your Azure administrator.</p>
</li>
<li>
<p>Log in to your container registry:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>az acr login --name <em>registry-name</em></strong></pre>
</div>
</div>
<div class="paragraph">
<p>Azure repository logins expire after 4 hours. Because of this, you&#8217;ll need to
log in to ACR whenever your login session expires
<sup class="footnote">[<a id="_footnoteref_29" class="footnote" href="#_footnotedef_29" title="View footnote.">29</a>]</sup>.</p>
</div>
</li>
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command to obtain the Kubernetes context.</p>
</li>
<li>
<p>Configure Skaffold with your Docker repository location and Kubernetes context:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>skaffold config \
 set default-repo <em>registry-name</em>.azurecr.io/cdm -k <em>my-kubernetes-context</em></strong></pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>skaffold config set default-repo <em>my-container-registry</em>.azurecr.io/cdm -k small</strong></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_59" class="discrete">Next Step</h3>
<div class="paragraph">
<p>You&#8217;ve completed all the setup tasks for AKS. Now you&#8217;re ready to deploy the
platform in your new cluster:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/intro.html" class="page">Become familiar with the CDM</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/architecture.html" class="page">Understand CDM architecture</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Set up your local environment and create a cluster (<a href="cdm/gke/setup/setup-env.html" class="page">GKE</a>|<a href="cdm/eks/setup/setup-env.html" class="page">EKS</a>|<a href="cdm/aks/setup/setup-env.html" class="page">AKS</a>)</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/deploy.html" class="page">Deploy the platform</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/access.html" class="page">Access platform UIs and APIs</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/next-steps.html" class="page">Explore your deployment and start planning for production</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdm_deployment"><a class="anchor" href="#cdm_deployment"></a>CDM Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that you&#8217;ve set up your deployment environment following the instructions in
the Environment Setup section for your cloud platform, you&#8217;re ready to deploy
the CDM. This page shows you how to deploy the CDM in your
Kubernetes cluster using artifacts from the <code>forgeops</code> repository.</p>
</div>
<div class="paragraph">
<p>Perform the following procedure:</p>
</div>
<div class="openblock procedure">
<div class="title">Deploy the CDM</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Initialize the staging area for configuration profiles with the canonical
CDK configuration profile
<sup class="footnote">[<a id="_footnoteref_30" class="footnote" href="#_footnotedef_30" title="View footnote.">30</a>]</sup>
for the ForgeRock Identity Platform:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/bin</strong>
$ <strong>./config.sh init --profile cdk --version 7.0</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <span class="command"><code>config.sh init</code></span> command copies the canonical CDK
configuration profile from the master directory for configuration profiles to
the staging area:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/config-sh.init.svg" alt="The staging area is initialized from the canonical ${cdk.abbr} profile.">
</div>
</div>
<div class="paragraph">
<p>For more information about the management of ForgeRock Identity Platform configuration
profiles in the <code>forgeops</code> repository,
see <a href="cdk/develop.html#configuration-profiles" class="page">Configuration Profiles</a>.</p>
</div>
</li>
<li>
<p>Change to the <span class="path"><code>/path/to/forgeops</code></span> directory and execute the
<span class="command"><code>skaffold run</code></span> command:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops</strong>
$ <strong>skaffold run -p small</strong></pre>
</div>
</div>
</li>
<li>
<p>Make the <code>prod</code> namespace your current namespace:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubens prod</strong></pre>
</div>
</div>
</li>
<li>
<p>Check the status of the pods in the <code>prod</code> namespace until all the pods are
ready:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Run the <span class="command"><code>kubectl get pods</code></span> command:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl get pods</strong>
NAME                          READY   STATUS      RESTARTS   AGE
admin-ui-555d9f5b9d-qlhvk     1/1     Running     0          3m59s
am-7857c7676c-gjwlj           1/1     Running     0          3m58s
amster-4qzwm                  1/1     Running     0          3m57s
ds-cts-0                      1/1     Running     0          3m58s
ds-cts-1                      1/1     Running     0          2m32s
ds-cts-2                      1/1     Running     0          2m1s
ds-idrepo-0                   1/1     Running     0          3m58s
ds-idrepo-1                   1/1     Running     0          2m24s
ds-idrepo-2                   1/1     Running     0          107s
end-user-ui-f6594c6f9-dcfvz   1/1     Running     0          3m58s
idm-0                         1/1     Running     0          3m58s
ldif-importer-4gbdl           0/1     Completed   0          3m56s
login-ui-76d4444b84-j4j5s     1/1     Running     0          3m58s</pre>
</div>
</div>
</li>
<li>
<p>Review the output. Deployment is complete when:</p>
<div class="ulist">
<ul>
<li>
<p>All entries in the <code>STATUS</code> column indicate <code>Running</code> or <code>Completed</code>.</p>
</li>
<li>
<p>The <code>READY</code> column indicates all running containers are available. The entry
in the <code>READY</code> column represents [total number of containers/number of available
containers].</p>
</li>
<li>
<p>Three AM and two IDM pods are present.</p>
</li>
<li>
<p>The initial loading jobs (<code>amster</code> and <code>ldif-importer</code>) have reached
<code>Completed</code> status.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If necessary, continue to query your deployment&#8217;s status until all the pods
are ready.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_60" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/intro.html" class="page">Become familiar with the CDM</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/architecture.html" class="page">Understand CDM architecture</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Set up your local environment and create a cluster (<a href="cdm/gke/setup/setup-env.html" class="page">GKE</a>|<a href="cdm/eks/setup/setup-env.html" class="page">EKS</a>|<a href="cdm/aks/setup/setup-env.html" class="page">AKS</a>)</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/deploy.html" class="page">Deploy the platform</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/access.html" class="page">Access platform UIs and APIs</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="cdm/next-steps.html" class="page">Explore your deployment and start planning for production</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ui_and_api_access_2"><a class="anchor" href="#ui_and_api_access_2"></a>UI and API Access</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This page shows you how to access and monitor the ForgeRock Identity Platform components
that make up the CDM.</p>
</div>
<div class="paragraph">
<p>AM and IDM are configured for access through the CDM
cluster&#8217;s Kubernetes ingress controller. You can access these components using
their normal interfaces:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For AM, the console and REST APIs.</p>
</li>
<li>
<p>For IDM, the Admin UI and REST APIs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DS cannot be accessed through the ingress controller, but you can use
Kubernetes methods to access the DS pods.</p>
</div>
<div class="paragraph">
<p>For more information about how AM and IDM have been configured in
the CDM, see
<a href="https://github.com/ForgeRock/forgeops/blob/master/README.md#configuration">Configuration</a>
in the <code>forgeops</code> repository&#8217;s top-level README file for more information about
the configurations.</p>
</div>
<div class="sect2">
<h3 id="am-services-cdm"><a class="anchor" href="#am-services-cdm"></a>AM Services</h3>
<div class="paragraph">
<p>Access the AM console and REST APIs as follows:</p>
</div>
<div class="openblock procedure">
<div class="title">Access the AM Console</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that the <code>prod</code> namespace is the current namespace:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubens prod</strong></pre>
</div>
</div>
</li>
<li>
<p>Obtain the <code>amadmin</code> user&#8217;s password:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/bin</strong>
$ <strong>./print-secrets.sh amadmin</strong>
<span class="cyan-hl">179rd8en9rffa82rcf1qap1z0gv1hcej</span></pre>
</div>
</div>
</li>
<li>
<p>Open a new window or tab in a web browser.</p>
</li>
<li>
<p>Go to <a href="https://prod.iam.example.com/platform" class="bare">https://prod.iam.example.com/platform</a>.</p>
<div class="paragraph">
<p>The Kubernetes ingress controller handles the request, routing it to the
<code>login-ui</code> pod.</p>
</div>
<div class="paragraph">
<p>The login UI prompts you to log in.</p>
</div>
</li>
<li>
<p>Log in as the <code>amadmin</code> user.</p>
<div class="paragraph">
<p>The ForgeRock Identity Platform UI appears in the browser.</p>
</div>
</li>
<li>
<p>Select Native Consoles &gt; Access Management.</p>
<div class="paragraph">
<p>The AM console appears in the browser.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="openblock procedure">
<div class="title">Access the AM REST APIs</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start a terminal window session.</p>
</li>
<li>
<p>Run a <span class="command"><code>curl</code></span> command to verify that you can access the REST APIs
through the ingress controller. For example:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>curl \
 --insecure \
 --request POST \
 --header "Content-Type: application/json" \
 --header "X-OpenAM-Username: amadmin" \
 --header "X-OpenAM-Password: <span class="cyan-hl">179rd8en9rffa82rcf1qap1z0gv1hcej</span>" \
 --header "Accept-API-Version: resource=2.0" \
 --data "{}" \
 "https://prod.iam.example.com/am/json/realms/root/authenticate"</strong>

{
    "tokenId":"AQIC5wM2&#8230;&#8203;",
    "successUrl":"/am/console",
    "realm":"/"
}</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="idm_services"><a class="anchor" href="#idm_services"></a>IDM Services</h3>
<div class="paragraph">
<p>Access the IDM Admin UI and REST APIs as follows:</p>
</div>
<div class="openblock procedure">
<div class="title">Access the IDM Admin UI</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that the <code>prod</code> namespace is the current namespace:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubens prod</strong></pre>
</div>
</div>
</li>
<li>
<p>Obtain the <code>amadmin</code> user&#8217;s password:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/bin</strong>
$ <strong>./print-secrets.sh amadmin</strong>
<span class="cyan-hl">vr58qt11ihoa31zfbjsdxxrqryfw0s31</span></pre>
</div>
</div>
</li>
<li>
<p>Open a new window or tab in a web browser.</p>
</li>
<li>
<p>Go to <a href="https://prod.iam.example.com/platform" class="bare">https://prod.iam.example.com/platform</a>.</p>
<div class="paragraph">
<p>The Kubernetes ingress controller handles the request, routing it to the
<code>login-ui</code> pod.</p>
</div>
<div class="paragraph">
<p>The login UI prompts you to log in.</p>
</div>
</li>
<li>
<p>Log in as the <code>amadmin</code> user.</p>
<div class="paragraph">
<p>The ForgeRock Identity Platform UI appears in the browser.</p>
</div>
</li>
<li>
<p>Select Native Consoles &gt; Identity Management.</p>
<div class="paragraph">
<p>The IDM Admin UI appears in the browser.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="openblock procedure">
<div class="title">Access the IDM REST APIs</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start a terminal window session.</p>
</li>
<li>
<p>If you haven&#8217;t already done so, get the <code>amadmin</code> user&#8217;s password using the
<span class="command"><code>print-secrets.sh</code></span> command.</p>
</li>
<li>
<p>AM authorizes IDM REST API access using the
<a href="https://ea.forgerock.com/docs/am/oauth2-guide/oauth2-authz-grant.html">OAuth 2.0 authorization code
flow</a>. The CDM comes with the <code>idm-admin-ui</code> client,
which is configured to let you get a bearer token using this OAuth 2.0 flow.
You&#8217;ll use the bearer token in the next step to access the IDM REST API:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Get a session token for the <code>amadmin</code> user:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>curl \
 --request POST \
 --insecure \
 --header "Content-Type: application/json" \
 --header "X-OpenAM-Username: amadmin" \
 --header "X-OpenAM-Password: <span class="cyan-hl">vr58qt11ihoa31zfbjsdxxrqryfw0s31</span>" \
 --header "Accept-API-Version: resource=2.0, protocol=1.0" \
 'https://prod.iam.example.com/am/json/realms/root/authenticate'</strong>
{
 "tokenId":"<span class="pink-hl">AQIC5wM. . .TU3OQ*</span>",
 "successUrl":"/am/console",
 "realm":"/"}</pre>
</div>
</div>
</li>
<li>
<p>Get an authorization code. Specify the ID of the session token that you
obtained in the previous step in the <code>--Cookie</code> parameter:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>curl \
 --dump-header - \
 --insecure \
 --request GET \
 --Cookie "iPlanetDirectoryPro=<span class="pink-hl">AQIC5wM. . .TU3OQ*</span>" \
 "https://prod.iam.example.com/am/oauth2/realms/root/authorize?redirect_uri=https://prod.iam.example.com/platform/appAuthHelperRedirect.html&amp;client_id=idm-admin-ui&amp;scope=openid%20fr:idm:*&amp;response_type=code&amp;state=abc123"</strong>
HTTP/2 302
server: nginx/1.17.10
date: Tue, 29 Sep 2020 16:54:20 GMT
content-length: 0
location: <a href="https://prod.iam.example.com/platform/appAuthHelperRedirect.html" class="bare">https://prod.iam.example.com/platform/appAuthHelperRedirect.html</a>
 ?code=<span class="green-hl">3cItL9G52DIiBdfXRngv2_dAaYM</span>&amp;iss=http://prod.iam.example.com:80/am/oauth2&amp;state=abc123
 &amp;client_id=idm-admin-ui
set-cookie: route=1595350461.029.542.7328; Path=/am; Secure; HttpOnly
x-frame-options: SAMEORIGIN
x-content-type-options: nosniff
cache-control: no-store
pragma: no-cache
set-cookie: OAUTH_REQUEST_ATTRIBUTES=DELETED; Expires=Thu, 01 Jan 1970 00:00:00 GMT; Path=/; HttpOnly
strict-transport-security: max-age=15724800; includeSubDomains</pre>
</div>
</div>
</li>
<li>
<p>Exchange the authorization code for an access token. Specify the access code
that you obtained in the previous step in the <code>code</code> URL parameter:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>curl --request POST \
 --insecure \
 --data "grant_type=authorization_code" \
 --data "code=<span class="green-hl">3cItL9G52DIiBdfXRngv2_dAaYM</span>" \
 --data "client_id=idm-admin-ui" \
 --data "redirect_uri=https://prod.iam.example.com/platform/appAuthHelperRedirect.html" \
 "https://prod.iam.example.com/am/oauth2/realms/root/access_token" </strong>
{
 "access_token":"<span class="orange-hl">oPzGzGFY1SeP2RkI-ZqaRQC1cDg</span>",
 "scope":"openid fr:idm:*",
 "id_token":"eyJ0eXAiOiJKV
  . . .
  sO4HYqlQ",
 "token_type":"Bearer",
 "expires_in":239
}</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Run a <span class="command"><code>curl</code></span> command to verify that you can access the
<code>openidm/config</code> REST endpoint through the ingress controller. Use the
access token returned in the previous step as the bearer token in the
authorization header.</p>
<div class="paragraph">
<p>The following example command provides information about the IDM
configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>curl \
 --insecure \
 --request GET \
 --header "Authorization: Bearer <span class="orange-hl">oPzGzGFY1SeP2RkI-ZqaRQC1cDg</span>" \
 --data "{}" \
 <a href="https://prod.iam.example.com/openidm/config" class="bare">https://prod.iam.example.com/openidm/config</a></strong>
{
 "_id":"",
 "configurations":
  [
   {
    "_id":"ui.context/admin",
    "pid":"ui.context.4f0cb656-0b92-44e9-a48b-76baddda03ea",
    "factoryPid":"ui.context"
    },
    . . .
   ]
}</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="directory_services_2"><a class="anchor" href="#directory_services_2"></a>Directory Services</h3>
<div class="paragraph">
<p>The DS pods in the CDM are not exposed outside of the cluster.
If you need to access one of the DS pods, use a standard Kubernetes method:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Execute shell commands in DS pods using the <span class="command"><code>kubectl exec</code></span>
command.</p>
</li>
<li>
<p>Forward a DS pod&#8217;s LDAPS port (1636) to your local computer. Then, you
can run LDAP CLI commands, for example <span class="command"><code>ldapsearch</code></span>. You can also
use an LDAP editor such as Apache Directory Studio to access the directory.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For all CDM directory pods, the directory superuser DN is <code>uid=admin</code>.
Obtain this user&#8217;s password by running the <strong>print-secrets.sh dsadmin</strong> command.</p>
</div>
</div>
<div class="sect2">
<h3 id="cdm-monitoring"><a class="anchor" href="#cdm-monitoring"></a>CDM Monitoring</h3>
<div class="paragraph">
<p>To start the Grafana UI, go to <a href="http://grafana.iam.example.com" class="bare">http://grafana.iam.example.com</a>. Log in to Grafana
as the <code>admin</code> user. The password is <code>password</code>.</p>
</div>
<div class="paragraph">
<p>To start the Prometheus UI, go to <a href="http://prometheus.iam.example.com" class="bare">http://prometheus.iam.example.com</a>.</p>
</div>
<div class="paragraph">
<p>For more information on the web UIs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://docs.grafana.org">Grafana</a></p>
</li>
<li>
<p><a href="https://prometheus.io/docs/introduction/overview">Prometheus</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For a description of the CDM monitoring architecture and information
about how to customize CDM monitoring, see
<a href="deployment/monitoring.html" class="page">Monitoring Customizations</a>.</p>
</div>
<h3 id="next_step_61" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/intro.html" class="page">Become familiar with the CDM</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/architecture.html" class="page">Understand CDM architecture</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Set up your local environment and create a cluster (<a href="cdm/gke/setup/setup-env.html" class="page">GKE</a>|<a href="cdm/eks/setup/setup-env.html" class="page">EKS</a>|<a href="cdm/aks/setup/setup-env.html" class="page">AKS</a>)</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/deploy.html" class="page">Deploy the platform</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="cdm/access.html" class="page">Access platform UIs and APIs</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="cdm/next-steps.html" class="page">Explore your deployment and start planning for production</a></mark></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdm_removal_gke"><a class="anchor" href="#cdm_removal_gke"></a>CDM Removal: GKE</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you&#8217;re done working with the CDM, you can remove it from Google
Cloud Platform by following this procedure:</p>
</div>
<div class="openblock procedure">
<div class="title">Remove the CDM</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the <span class="command"><code>skaffold delete</code></span> command to shut down your deployment
and remove it from your namespace:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops</strong>
$ <strong>skaffold delete</strong>
Cleaning up&#8230;&#8203;</pre>
</div>
</div>
</li>
<li>
<p>Remove your cluster:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the directory that contains the cluster removal script:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/cluster/gke</strong></pre>
</div>
</div>
</li>
<li>
<p>Source the script that contains the configuration for your cluster size. For
example:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>source ./small.sh</strong></pre>
</div>
</div>
</li>
<li>
<p>Run the cluster removal script:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>./cluster-down.sh</strong>
Getting the cluster credentials for small in Zone <em>my-region</em>-a
Fetching cluster endpoint and auth data.
kubeconfig entry generated for small.
Cleaning up the ngnix load balancer. Ignore any errors below
deployment.apps "ingress-nginx-controller" deleted
service "ingress-nginx-controller" deleted
service "ingress-nginx-controller-admission" deleted
namespace "nginx" deleted
About to delete the cluster in 10 seconds
The following clusters will be deleted.
 - [small] in [<em>my-region</em>]

Do you want to continue (Y/n)?</pre>
</div>
</div>
<div class="paragraph">
<p>Enter <strong>Y</strong> to confirm that you want to remove your cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Deleting cluster small&#8230;&#8203;done.
Deleted [https://container.googleapis.com/v1/projects/<em>my-project</em>/zones/<em>my-region</em>/clusters/small].</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command.</p>
<div class="paragraph">
<p>The Kubernetes context for the CDM cluster should not appear in the
<span class="command"><code>kubectx</code></span> command output.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdm_removal_eks"><a class="anchor" href="#cdm_removal_eks"></a>CDM Removal: EKS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you&#8217;re done working with the CDM, you can remove it from Amazon Web
Services by following this procedure:</p>
</div>
<div class="openblock procedure">
<div class="title">Remove the CDM</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the <span class="command"><code>skaffold delete</code></span> command to shut down your deployment
and remove it from your namespace:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops</strong>
$ <strong>skaffold delete</strong>
Cleaning up&#8230;&#8203;</pre>
</div>
</div>
</li>
<li>
<p>Remove your cluster:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the directory that contains the cluster removal script:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/cluster/eks</strong></pre>
</div>
</div>
</li>
<li>
<p>Run the cluster removal script. Specify the YAML file that contains the
configuration for your cluster size. For example:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>./cluster-down.sh small.yaml</strong>
Deleting cluster small. . .
[]  eksctl version 0.27.0
[]  using region us-east-1
[]  deleting EKS cluster "small"
[]  deleted 0 Fargate profile(s)
[]  kubeconfig has been updated
[]  cleaning up AWS load balancers created by Kubernetes objects of Kind Service or Ingress
[]  2 sequential tasks: { 2 parallel sub-tasks: { delete nodegroup "primary", delete nodegroup "ds" }, delete cluster control plane "small" }
[]  will delete stack "eksctl-small-nodegroup-primary"
[]  waiting for stack "eksctl-small-nodegroup-primary" to get deleted
[]  will delete stack "eksctl-small-nodegroup-ds"
[]  waiting for stack "eksctl-small-nodegroup-ds" to get deleted
[]  will delete stack "eksctl-small-cluster"
[]  waiting for stack "eksctl-small-cluster" to get deleted
[]  all cluster resources were deleted</pre>
</div>
</div>
</li>
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command.</p>
<div class="paragraph">
<p>The Kubernetes context for the CDM cluster should not appear in the
<span class="command"><code>kubectx</code></span> command output.</p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdm_removal_aks"><a class="anchor" href="#cdm_removal_aks"></a>CDM Removal: AKS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you&#8217;re done working with the CDM, you can remove it from Azure by
following this procedure:</p>
</div>
<div class="openblock procedure">
<div class="title">Remove the CDM</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the <span class="command"><code>skaffold delete</code></span> command to shut down your deployment
and remove it from your namespace:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops</strong>
$ <strong>skaffold delete</strong>
Cleaning up&#8230;&#8203;</pre>
</div>
</div>
</li>
<li>
<p>Remove your cluster:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the directory that contains the cluster removal script:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/cluster/aks</strong></pre>
</div>
</div>
</li>
<li>
<p>Source the script that contains the configuration for your cluster size. For
example:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>source ./small.sh</strong></pre>
</div>
</div>
</li>
<li>
<p>Run the cluster removal script:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>./cluster-down.sh</strong>
Deleting AKS cluster small&#8230;&#8203;
Are you sure you want to perform this operation? (y/n):</pre>
</div>
</div>
<div class="paragraph">
<p>Enter <strong>y</strong> to confirm that you want to delete the cluster.</p>
</div>
<div class="paragraph">
<p>After the cluster has been deleted, a second confirmation prompt appears:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Deleting resource group small-res-group&#8230;&#8203;
Are you sure you want to perform this operation? (y/n):</pre>
</div>
</div>
<div class="paragraph">
<p>Enter <strong>y</strong> to confirm that you want to delete the resource group.</p>
</div>
<div class="paragraph">
<p>After a short time, cluster removal is complete.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Run the <span class="command"><code>kubectx</code></span> command.</p>
<div class="paragraph">
<p>The Kubernetes context for the CDM cluster should not appear in the
<span class="command"><code>kubectx</code></span> command output.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="next_steps"><a class="anchor" href="#next_steps"></a>Next Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you&#8217;ve followed the instructions for deploying the CDM
<em>without modifying configurations</em>, then the following indicates that you&#8217;ve
been successful:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Kubernetes cluster and pods are up and running.</p>
</li>
<li>
<p>DS, AM, and IDM are installed and running. You can access
each ForgeRock component.</p>
</li>
<li>
<p>DS is provisioned with sample users. Replication and failover work as
expected.</p>
</li>
<li>
<p>Monitoring tools are installed and running. You can access a monitoring
console for DS, AM, and IDM.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you&#8217;re satisfied that all of these conditions are met, then you&#8217;ve
successfully taken the first steps towards deploying the ForgeRock Identity Platform in the
cloud. Congratulations!</p>
</div>
<div class="paragraph">
<p>You can use the CDM to test deployment customizations&#x2014;options that
you might want to use in production, but are not part of the CDM.
Examples include, but are not limited to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Running lightweight benchmark tests</p>
</li>
<li>
<p>Making backups of CDM data, and restoring the data</p>
</li>
<li>
<p>Securing SSL with a certificate that&#8217;s dynamically obtained from Let&#8217;s Encrypt</p>
</li>
<li>
<p>Using an ingress controller other than the NGINX ingress controller</p>
</li>
<li>
<p>Resizing the cluster to meet your business requirements</p>
</li>
<li>
<p>Configuring Alert Manager to issue alerts when usage thresholds have been
reached</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now that you&#8217;re familiar with the CDM&#x2014;ForgeRock&#8217;s reference
implementation&#x2014;you&#8217;re ready to work with a project team to plan and
configure your production deployment. You&#8217;ll need a team with expertise in the
ForgeRock Identity Platform, in your cloud provider, and in Kubernetes on your cloud
provider. We strongly recommend that you engage a ForgeRock technical consultant
 or partner to assist you with deploying the platform in production.</p>
</div>
<div class="paragraph">
<p>You&#8217;ll perform these major activities:</p>
</div>
<div class="paragraph">
<p><strong>Platform configuration</strong>. ForgeRock Identity Platform experts configure AM and
IDM using the CDK, and build custom Docker images for the
ForgeRock Identity Platform. The <a href="cdk/overview.html" class="page">Cloud Developer&#8217;s Kit Documentation</a> provides information about
platform configuration tasks.</p>
</div>
<div class="paragraph">
<p><strong>Cluster configuration</strong>. Cloud technology experts configure the Kubernetes
cluster that will host the ForgeRock Identity Platform for optimal performance and
reliability. Tasks include: configuring your Kubernetes cluster to suit your
business needs; setting up monitoring and alerts to track site health and
performance; backing up configuration and user data for disaster preparedness;
and securing your deployment. The <a href="deployment/overview.html" class="page">Deployment Topics Documentation</a>
and READMEs in the <code>forgeops</code> repository provide information about cluster
configuration.</p>
</div>
<div class="paragraph">
<p><strong>Site reliability engineering</strong>. Site reliability engineers monitor the
ForgeRock Identity Platform deployment, and keep the deployment up and running based on your
business requirements. These might include use cases, service-level agreements,
thresholds, and load test profiles. The
<a href="deployment/overview.html" class="page">Deployment Topics Documentation</a>, and READMEs in the <code>forgeops</code>
repository, provide information about site reliability.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deployment_topics_documentation"><a class="anchor" href="#deployment_topics_documentation"></a>Deployment Topics Documentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After you get the CDM up and running, you can use it to test deployment
customizations&#8212;&#8203;options that are not part of the CDM, but which you
might want to use when you deploy in production. This part of the documentation
covers building base Docker images, scheduling backups, restoring directory
data, customizing monitoring, customizing security, and running lightweight
benchmarks.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="start/start-here.html" class="page"><span class="icon"><i class="fa fa-play-circle fa-3x"></i></span></a></p>
<p class="tableblock"><strong><a href="start/start-here.html" class="page">Start Here</a></strong></p>
<p class="tableblock">Important information you should know before deploying on Kubernetes.</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="deployment/base-docker-images.html" class="page"><span class="fab fa-3x">&#xf395;</span></a></p>
<p class="tableblock"><strong><a href="deployment/base-docker-images.html" class="page">Base Docker Images</a></strong></p>
<p class="tableblock">Build base Docker images for the platform.</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="deployment/backup-restore.html" class="page"><span class="icon"><i class="fa fa-save fa-3x"></i></span></a></p>
<p class="tableblock"><strong><a href="deployment/backup-restore.html" class="page">Backup and Restore</a></strong></p>
<p class="tableblock">Schedule backups for directory data, and restore data if a failure occurs.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="deployment/monitoring.html" class="page"><span class="icon"><i class="fa fa-camera fa-3x"></i></span></a></p>
<p class="tableblock"><strong><a href="deployment/monitoring.html" class="page">Monitoring</a></strong></p>
<p class="tableblock">Customize the CDM&#8217;s monitoring configuration and set up alerts.</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="deployment/security.html" class="page"><span class="icon"><i class="fa fa-lock fa-3x"></i></span></a></p>
<p class="tableblock"><strong><a href="deployment/security.html" class="page">Security</a></strong></p>
<p class="tableblock">Customize CDM security.</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="support.html" class="page"><span class="fa fa-3x">&#xf017;</span></a></p>
<p class="tableblock"><strong><a href="support.html" class="page">CDM Benchmarks</a></strong></p>
<p class="tableblock">Run lightweight benchmarks on the CDM.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The ForgeRock Identity Platform serves as the basis for our simple and comprehensive
identity and access management solution. We help our customers deepen their
relationships with their customers, and improve the productivity and
connectivity of their employees and partners. For more information about
ForgeRock and about the platform, see <a href="https://www.forgerock.com" class="bare">https://www.forgerock.com</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="base_docker_images"><a class="anchor" href="#base_docker_images"></a>Base Docker Images</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ForgeRock provides a set of unsupported, evaluation-only base images for the
ForgeRock Identity Platform. These images are available in ForgeRock&#8217;s public Docker
registry.</p>
</div>
<div class="paragraph">
<p>Developers working with the CDK use the base images from ForgeRock to
build customized Docker images for a fully-configured ForgeRock Identity Platform
deployment:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/containerization-dev.svg" alt="Brief overview of containers for developers.">
</div>
</div>
<div class="paragraph">
<p>Users working with the CDM also use the base images from ForgeRock to
perform proof-of-concept deployments.</p>
</div>
<div class="paragraph">
<p>The base images from ForgeRock are evaluation-only. <em>They are not supported for
production use.</em> Because of this, you must build your own base images before you
deploy in production:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/containerization-prod.svg" alt="Brief overview of containers in production.">
</div>
</div>
<div class="paragraph">
<p>This topic tells you how to build your own base images, which you can deploy
in production.</p>
</div>
<div class="sect2">
<h3 id="base-images"><a class="anchor" href="#base-images"></a>Your Own Base Docker Images</h3>
<div class="paragraph">
<p>Perform the following procedure to build base Docker images that you can use in
production deployments of the ForgeRock Identity Platform. After you&#8217;ve built the base
images, push them to your Docker registry:</p>
</div>
<div class="openblock procedure">
<div class="title">Build and Deploy Your Own Base Docker Images</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download the latest versions of the AM, Amster, IDM, and
DS <code>.zip</code> files from <a href="https://ea.forgerock.com/nightlies">ForgeRock&#8217;s early access site</a>.
Optionally, you can also download the latest version of the IG <code>.zip</code>
file.</p>
</li>
<li>
<p>Build the base image for Amster. This image must be available in order
to build the base image for AM in the next step:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Unzip the Amster <code>.zip</code> file:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>unzip Amster-7.0.0.zip -d amster</strong></pre>
</div>
</div>
</li>
<li>
<p>Change to the <span class="path"><code>amster/samples/docker</code></span> directory in the expanded
<code>.zip</code> file output.</p>
</li>
<li>
<p>Run the <span class="command"><code>setup.sh</code></span> script:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>./setup.sh</strong>

+ mkdir -p build
+ find ../.. '!' -name .. '!' -name samples '!' -name docker -maxdepth 1 -exec cp -R '{}' build/ ';'
+ cp ../../docker/amster-install.sh ../../docker/docker-entrypoint.sh ../../docker/export.sh ../../docker/tar.sh build</pre>
</div>
</div>
</li>
<li>
<p>Build the <code>amster</code> Docker image:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>docker build --tag amster:7.0 .</strong>

Sending build context to Docker daemon   51.7MB
Step 1/12 : FROM gcr.io/forgerock-io/java-11:latest
 --&#8594; 4d0811d78b02
Step 2/12 : ENV FORGEROCK_HOME /home/forgerock
 --&#8594; Running in 472b8b0e1200
Removing intermediate container 472b8b0e1200
. . .</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Build the base image for AM:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Unzip the AM <code>.zip</code> file.</p>
</li>
<li>
<p>Change to the <span class="path"><code>openam/samples/docker</code></span> directory in the expanded
<code>.zip</code> file output.</p>
</li>
<li>
<p>Update and run the <span class="command"><code>setup.sh</code></span> script:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>chmod u+x setup.sh</strong>
$ <strong>sed -i'.tmp' -e 's/[Oo]pen[Aa][Mm]/AM/g' setup.sh</strong>
$ <strong>./setup.sh</strong></pre>
</div>
</div>
</li>
<li>
<p>Change to the <span class="path"><code>images/am-empty</code></span> directory.</p>
</li>
<li>
<p>Set privileges on scripts in the <span class="path"><code>images/am-empty</code></span> directory:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>chmod u+x docker-entrypoint.sh</strong>
$ <strong>chmod u+x scripts/</strong>*</pre>
</div>
</div>
</li>
<li>
<p>Update the WAR file name in the Dockerfile:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>sed -i'.tmp' -e 's/openam.war/AM.war/g' Dockerfile</strong></pre>
</div>
</div>
</li>
<li>
<p>Build the <code>am-empty</code> Docker image:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>docker build --tag am-empty:7.0 .</strong>

Sending build context to Docker daemon  198.7MB
Step 1/27 : FROM tomcat:9-jdk11-adoptopenjdk-hotspot AS base
9-jdk11-adoptopenjdk-hotspot: Pulling from library/tomcat
a1125296b23d: Pull complete
3c742a4a0f38: Pull complete
4c5ea3b32996: Pull complete
1b4be91ead68: Pull complete
0cbfb179272d: Pull complete
9648e8b5b6e1: Pull complete
d1aef586a7d1: Pull complete
ddd6eed10da2: Pull complete
3f5d89f2e2b4: Pull complete
Digest: sha256:ee307e4f1a1f5596b3636eb9107aa7989c768716bf0157651b28a4e34ff0846f
Status: Downloaded newer image for tomcat:9-jdk11-adoptopenjdk-hotspot
 --&#8594; 4f1036cadd4b
Step 2/27 : RUN apt-get update -y &amp;&amp;     apt-get install -y binutils wget unzip
 --&#8594; Running in ef6f6c08ba9b
. . .</pre>
</div>
</div>
</li>
<li>
<p>Change to the <span class="path"><code>../am-base</code></span> directory.</p>
</li>
<li>
<p>Set privileges on scripts in the <span class="path"><code>images/am-base</code></span> directory:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>chmod u+x docker-entrypoint.sh</strong>
$ <strong>chmod u+x scripts/</strong>*</pre>
</div>
</div>
</li>
<li>
<p>Build the <code>am-base</code> Docker image:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>docker build --build-arg docker_tag=7.0 --tag <em>my-registry</em>/am-base:7.0 .</strong>

Sending build context to Docker daemon  27.27MB
Step 1/27 : ARG docker_tag=latest
Step 2/27 : FROM amster:${docker_tag} as amster
 --&#8594; 50d60dbf29f5
Step 3/27 : FROM am-empty:${docker_tag} AS generator
 --&#8594; 0b258dc0c896
Step 4/27 : USER 0
 --&#8594; Running in 0512b3042833
Removing intermediate container 0512b3042833
 --&#8594; 59dfa4e1043e
. . .</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Now that the AM image is built, tag the base image for Amster
in advance of pushing it to your private repository:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>docker tag amster:7.0 <em>my-registry</em>/amster:7.0</strong></pre>
</div>
</div>
</li>
<li>
<p>Build the base image for DS:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Unzip the DS <code>.zip</code> file.</p>
</li>
<li>
<p>Change to the <span class="path"><code>opendj</code></span> directory in the expanded <code>.zip</code> file output.</p>
</li>
<li>
<p>Run the <span class="command"><code>samples/docker/setup.sh</code></span> script to create a server:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>./samples/docker/setup.sh</strong>

+ rm -f template/config/tools.properties
+ cp -r samples/docker/Dockerfile samples/docker/README.md . . .
+ rm -rf&#8201;&#8212;&#8201;README README.md bat '*.zip' opendj_logo.png setup.bat upgrade.bat setup.sh
+ ./setup --serverId docker --hostname localhost . . .

Validating parameters&#8230;&#8203;.. Done
Configuring certificates&#8230;&#8203;&#8230;&#8203;. Done
. . .</pre>
</div>
</div>
</li>
<li>
<p>Build the <code>ds</code> base image:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>docker build --tag <em>my-registry</em>/ds:7.0 .</strong>

Sending build context to Docker daemon  54.19MB
Sending build context to Docker daemon  55.31MB
Step 1/14 : FROM gcr.io/forgerock-io/java-11:latest
 --&#8594; 4d0811d78b02
Step 2/14 : COPY --chown=forgerock:root . /opt/opendj/
 --&#8594; 75c3db504d4c
Step 3/14 : USER 11111
 --&#8594; Running in 2346c3e1d73f
Removing intermediate container 2346c3e1d73f
 --&#8594; d66c728f8d2e
Step 4/14 : WORKDIR /opt/opendj
 --&#8594; Running in 2aa62e2d415f
Removing intermediate container 2aa62e2d415f
 --&#8594; 9e2cdf65ae56
. . .</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Build the base image for IDM:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Unzip the IDM <code>.zip</code> file.</p>
</li>
<li>
<p>Change to the <span class="path"><code>openidm</code></span> directory in the expanded <code>.zip</code>
file output.</p>
</li>
<li>
<p>Build the <code>idm</code> base image:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>docker build . --file bin/Custom.Dockerfile --tag <em>my-registry</em>/idm:7.0</strong>

Sending build context to Docker daemon  220.2MB
Step 1/7 : FROM gcr.io/forgerock-io/java-11:latest
 --&#8594; 4d0811d78b02
Step 2/7 : RUN apt-get update &amp;&amp;     apt-get install -y ttf-dejavu
 --&#8594; Running in e0943ff14f4b
Get:1 <a href="http://deb.debian.org/debian" class="bare">http://deb.debian.org/debian</a> stable InRelease [121 kB]
Get:2 <a href="http://deb.debian.org/debian" class="bare">http://deb.debian.org/debian</a> stable-updates InRelease [51.9 kB]
Get:3 <a href="http://deb.debian.org/debian" class="bare">http://deb.debian.org/debian</a> stable/main amd64 Packages [7905 kB]
Get:4 <a href="http://security.debian.org/debian-security" class="bare">http://security.debian.org/debian-security</a> stable/updates InRelease [65.4 kB]
Get:5 <a href="http://security.debian.org/debian-security" class="bare">http://security.debian.org/debian-security</a> stable/updates/main amd64 Packages [213 kB]
Get:6 <a href="http://deb.debian.org/debian" class="bare">http://deb.debian.org/debian</a> stable-updates/main amd64 Packages [7868 B]
Fetched 8364 kB in 2s (3401 kB/s)
Reading package lists&#8230;&#8203;
. . .</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>(Optional) Build the base image for IG:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Unzip the IG <code>.zip</code> file.</p>
</li>
<li>
<p>Change to the <span class="path"><code>identity-gateway</code></span> directory in the expanded <code>.zip</code>
file output.</p>
</li>
<li>
<p>Build the <code>ig</code> base image:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>docker build ig --tag <em>my-registry</em>/ig:7.0</strong>

Sending build context to Docker daemon  54.19MB
Step 1/7 : FROM gcr.io/forgerock-io/java-11:latest
latest: Pulling from forgerock-io/java-11
d50302ca539a: Already exists
79c4c086a545: Pull complete
dc6dba627cfa: Pull complete
Digest: sha256:5c5fdae70dbabb58c6fa0609b4d5a51b049f562e337d8bd9ed8653f7078b3d88
Status: Downloaded newer image for gcr.io/forgerock-io/java-11:latest
 --&#8594; 4d0811d78b02
Step 2/7 : ENV INSTALL_DIR /opt/ig
 --&#8594; Running in 5fff26381d8f
Removing intermediate container 5fff26381d8f
 --&#8594; e5bb2b75f4fb
Step 3/7 : COPY --chown=forgerock:root . "${INSTALL_DIR}"
 --&#8594; 1f35484fefb8
Step 4/7 : ENV IG_INSTANCE_DIR /var/ig
 --&#8594; Running in 3526eaf403d5
Removing intermediate container 3526eaf403d5
 --&#8594; 194c0495a29d
Step 5/7 : RUN mkdir -p "${IG_INSTANCE_DIR}"  &amp;&amp; chown -R forgerock:root "${IG_INSTANCE_DIR}" "${INSTALL_DIR}"     &amp;&amp; chmod -R g+rwx "${IG_INSTANCE_DIR}" "${INSTALL_DIR}"
 --&#8594; Running in a9c4bbcb7df0
Removing intermediate container a9c4bbcb7df0
 --&#8594; b6ca5a1022a7
Step 6/7 : USER 11111
 --&#8594; Running in fd53e422afad
Removing intermediate container fd53e422afad
 --&#8594; 954148a95b46
Step 7/7 : ENTRYPOINT ${INSTALL_DIR}/bin/start.sh ${IG_INSTANCE_DIR}
 --&#8594; Running in 59353752d80a
Removing intermediate container 59353752d80a
 --&#8594; 610d9934bfd0
Successfully built 610d9934bfd0
Successfully tagged my-registry/ig:7.0</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Run the <span class="command"><code>docker images</code></span> to verify that you built the base images:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>docker images</strong>

REPOSITORY                      TAG      IMAGE ID        CREATED        SIZE
my-registry/am-base             7.0      d115125b1c3f    1 hour ago     795MB
my-registry/amster              7.0      d9e1c735f415    1 hour ago     577MB
my-registry/ds                  7.0      ac8e8ab0fda6    1 hour ago     196MB
my-registry/idm                 7.0      0cc1b7f70ce6    1 hour ago     387MB
my-registry/ig                  7.0      9728c30c1829    1 hour ago     249MB
. . .</pre>
</div>
</div>
</li>
<li>
<p>Push the new base Docker images to your Docker registry.</p>
<div class="paragraph">
<p>See your registry provider documentation for detailed instructions. For most
Docker registries, you run the <span class="command"><code>docker login</code></span> command to log in to
the registry. Then, you run the <span class="command"><code>docker push</code></span> command to push a
Docker image to the registry.</p>
</div>
<div class="paragraph">
<p>However, some Docker registries have different requirements. For example, to
push Docker images to Google Container Registry, you use Google Cloud SDK
commands instead of using the <span class="command"><code>docker push</code></span> command.</p>
</div>
<div class="paragraph">
<p>Push the following images:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><em>my-registry</em>/am-base:7.0</code></p>
</li>
<li>
<p><code><em>my-registry</em>/amster:7.0</code></p>
</li>
<li>
<p><code><em>my-registry</em>/ds:7.0</code></p>
</li>
<li>
<p><code><em>my-registry</em>/idm:7.0</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you&#8217;re deploying your own IG base image, also push the
<code><em>my-registry</em>/ig:7.0</code> image.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="developer_dockerfile_changes"><a class="anchor" href="#developer_dockerfile_changes"></a>Developer Dockerfile Changes</h3>
<div class="paragraph">
<p>After you&#8217;ve pushed your own base images to your Docker registry, update the
Dockerfiles that your developers use when creating customized Docker images for
the ForgeRock Identity Platform. The Dockerfiles can now reference your own base images
instead of the evaluation-only images from ForgeRock.</p>
</div>
<div class="openblock procedure">
<div class="title">Change Developer Dockerfiles to Use Your Base Images</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Update the AM Dockerfile:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the <span class="path"><code>/path/to/forgeops/docker/7.0/am</code></span>
directory.</p>
</li>
<li>
<p>Open the file, <span class="path"><code>Dockerfile</code></span>, in that directory.</p>
</li>
<li>
<p>Change the line:</p>
<div class="listingblock">
<div class="content">
<pre>FROM gcr.io/forgerock-io/am-base...</pre>
</div>
</div>
<div class="paragraph">
<p>to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>FROM <em>my-registry</em>/am-base:7.0</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Make a similar change to the file,
<span class="path"><code>/path/to/forgeops/docker/7.0/amster/Dockerfile</code></span>.</p>
</li>
<li>
<p>Make a similar change to the file,
<span class="path"><code>/path/to/forgeops/docker/7.0/ds/cts/Dockerfile</code></span>.</p>
</li>
<li>
<p>Make a similar change to the file,
<span class="path"><code>/path/to/forgeops/docker/7.0/ds/idrepo/Dockerfile</code></span>.</p>
</li>
<li>
<p>Make a similar change to the file,
<span class="path"><code>/path/to/forgeops/docker/7.0/idm/Dockerfile</code></span>.</p>
</li>
<li>
<p>(Optional) Make a similar change to the file,
<span class="path"><code>/path/to/forgeops/docker/7.0/ig/Dockerfile</code></span>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>You can now build customized Docker images for the ForgeRock Identity Platform based on your
own Docker images and use them in production deployments.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The next time you run Skaffold, you must set the <code>--no-prune</code> and
<code>--cache-artifacts</code> options to <code>false</code> to ensure that Skaffold loads the new
images that you just built instead of loading previous images from cache. For
example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>skaffold run --no-prune=false --cache-artifacts=false</strong></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="backup_and_restore"><a class="anchor" href="#backup_and_restore"></a>Backup and Restore</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The backup topology of DS in the CDM:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/back-up.svg" alt="Diagram about backup topology.">
</div>
</div>
<div class="paragraph">
<p>Some important DS backup and restore considerations in the CDM:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Six DS instances are deployed using Kubernetes stateful sets (three
each for <code>idrepo</code> and <code>cts</code> backends).</p>
</li>
<li>
<p>DS data backups are stored in Google Cloud Service, Amazon S3, or
Azure Blob Storage. Before deploying the CDM set up a cloud storage
container and the necessary credentials to access the container.</p>
</li>
<li>
<p>Backups must be scheduled using the <span class="command"><code>schedule-backups.sh</code></span> script
in the <span class="path"><code>/path/to/forgeops/bin</code></span> path on your local computer.</p>
</li>
<li>
<p>By default, an incremental backup of the CTS and identity repository directory
instances is performed every hour. The first incremental backup created is a full
backup.</p>
</li>
<li>
<p>The backup schedule can be customized separately for CTS and identity repository
DS instances based on your recovery objectives.</p>
</li>
<li>
<p>By default, the backups are scheduled from the last (or <code>-2</code>) pod of each DS
instance. You can customize and schedule backups from any pod of a DS
instance. You can also schedule backups from multiple pods.</p>
</li>
<li>
<p>DS server instances use cryptographic keys to sign and verify the integrity of
backup files, and to encrypt data. Server instances protect these keys in a
deployment by encrypting them with the shared master key. For portability,
servers store the encrypted keys in the backup files.</p>
</li>
<li>
<p>An <code>idrepo</code> instance can be restored using the backup of any other <code>idrepo</code>
instance, as long as it holds a copy of the shared master key used to encrypt
the keys.</p>
</li>
<li>
<p>Similarly, a <code>cts</code> instance can also be restored using the backup of another
<code>cts</code> instance, as long as the shared master key is available to the <code>cts</code>
being restored.</p>
</li>
<li>
<p>You can set up new DS instances with data from a previous backup when
you deploy CDM.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="on_google_cloud"><a class="anchor" href="#on_google_cloud"></a>On Google Cloud</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Set up a Google Cloud storage bucket for the DS data backup, and configure the
<code>forgeops</code> artifacts with the location and credentials for the bucket:</p>
</div>
<div class="openblock procedure">
<div class="title">Set up a Google Cloud Storage Bucket for DS Data Backup</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a Google Cloud service account for performing the backup, and download
the <code>my-sa-credentials.json</code> file, which contains credentials for the service
account to be used for DS backup.</p>
</li>
<li>
<p>Create or identify a Google Cloud storage bucket for storing DS backup:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Note the Link for the gsutil value.</p>
</li>
<li>
<p>Grant permissions on the bucket to the service account you created in step 1.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Create and apply the cloud storage credentials:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the <span class="path"><code>/path/to/forgeops/kustomize/base/7.0/ds/base</code></span>
directory.</p>
</li>
<li>
<p>Set your Kubernetes context to your CDM cluster:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectx <em>my-kubernetes-context</em></strong></pre>
</div>
</div>
</li>
<li>
<p>Create the <span class="path"><code>cloud-storage-credentials.yaml</code></span> credential file:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl create secret generic cloud-storage-credentials \
 --from-file=GOOGLE_CREDENTIALS_JSON=<em>/path/to/my-sa-credential.json</em> \
 --dry-run=client -o yaml &gt; cloud-storage-credentials.yaml</strong></pre>
</div>
</div>
</li>
<li>
<p>Apply the credential information to the running CDM instance:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl apply -f cloud-storage-credentials.yaml</strong></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Set up the backup location in the configuration of the running CDM instance:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Get the <code>platform-config</code> configmap:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl -n prod get configmap platform-config -o yaml &gt; <em>my-config.yaml</em></strong></pre>
</div>
</div>
</li>
<li>
<p>Edit the local configmap file and set the <code>DSBACKUP_DIRECTORY</code>
parameter to the Link for gsutil of the DS data backup bucket.</p>
<div class="paragraph">
<p>For example: <code>DSBACKUP_DIRECTORY</code> <span class="path"><code>gs://<em>my-backup-bucket</em></code></span></p>
</div>
</li>
<li>
<p>Apply the change to the running CDM:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl apply -f <em>my-config.yaml</em></strong></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Apply the same change to your local Kustomization overlay file:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the <span class="path"><code>/path/to/forgeops/kustomize/base/kustomizeConfig</code></span>
directory.</p>
</li>
<li>
<p>Edit the <span class="path"><code>kustomization.yaml</code></span> file and set the <code>DSBACKUP_DIRECTORY</code>
parameter to the location of the backup bucket.</p>
<div class="paragraph">
<p>For example: <code>DSBACKUP_DIRECTORY</code> <span class="path"><code>gs://<em>my-backup-bucket</em></code></span></p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>Now you are ready to enable and schedule backups.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="on_aws"><a class="anchor" href="#on_aws"></a>On AWS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Set up an S3 bucket for the DS data backup and configure the <code>forgeops</code>
artifacts with the location and credentials for the S3 bucket:</p>
</div>
<div class="openblock procedure">
<div class="title">Set up an S3 Bucket for DS Data Backup</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create or identify an existing S3 bucket for storing the DS data backup,
and note the S3 link of the bucket.</p>
</li>
<li>
<p>Create and apply the cloud storage credentials:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the <span class="path"><code>/path/to/forgeops/kustomize/base/7.0/ds/base/</code></span>
directory.</p>
</li>
<li>
<p>Set your Kubernetes context to your CDM cluster:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectx <em>my-kubernetes-context</em></strong></pre>
</div>
</div>
</li>
<li>
<p>Create the <span class="path"><code>cloud-storage-credentials.yaml</code></span> credential file:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl create secret generic cloud-storage-credentials \
 --from-literal=AWS_ACCESS_KEY_ID=<code><em>my-access-key</em></code> \
 --from-literal=AWS_SECRET_ACCESS_KEY=<code><em>my-secret-access-key</em></code> \
 --dry-run=client -o yaml &gt; cloud-storage-credentials.yaml</strong></pre>
</div>
</div>
</li>
<li>
<p>Apply the credential information to the running CDM instance:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl apply -f cloud-storage-credentials.yaml</strong></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Set up the backup location in the configuration of the running CDM instance:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Get the <code>platform-config</code> configmap:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl -n prod get configmap platform-config -o yaml &gt; <em>my-config.yaml</em></strong></pre>
</div>
</div>
</li>
<li>
<p>Edit the local configmap file and set the <code>DSBACKUP_DIRECTORY</code> parameter to
the S3 link of the DS data backup bucket.</p>
<div class="paragraph">
<p>For example: <code>DSBACKUP_DIRECTORY</code> <span class="path"><code>s3://<em>my-backup-bucket</em></code></span></p>
</div>
</li>
<li>
<p>Apply the change to the running CDM instance:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl apply -f my-config.yaml</strong></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Apply the same change to your local Kustomization overlay file:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the <span class="path"><code>/path/to/forgeops/kustomize/base/kustomizeConfig</code></span>
directory.</p>
</li>
<li>
<p>Edit the <span class="path"><code>kustomization.yaml</code></span> file and set the <code>DSBACKUP_DIRECTORY</code>
parameter to the S3 link of the DS data backup bucket.</p>
<div class="paragraph">
<p>For example: <code>DSBACKUP_DIRECTORY</code> <span class="path"><code>s3://<em>my-backup-bucket</em></code></span></p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>Now you are ready to enable and schedule backups.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="on_azure"><a class="anchor" href="#on_azure"></a>On Azure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Set up an Azure Blob Storage container for the DS data backup and
configure the <code>forgeops</code> artifacts with the location and credentials for the
Azure Blob Storage container:</p>
</div>
<div class="openblock procedure">
<div class="title">Set up an Azure Blob Storage Container for DSData Backup</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create or identify an existing Azure Blob Storage container for the DS
data backup. For more information on how to create and use Azure Blob Storage,
see <a href="https://docs.microsoft.com/en-us/azure/storage/blobs/storage-quickstart-blobs-cli">Quickstart: Create, download, and list blobs with Azure CLI</a>.</p>
</li>
<li>
<p>Get the access link to the Azure Blob Storage container to be used for the
DS backup:</p>
</li>
<li>
<p>Create and apply the cloud storage credentials:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the <span class="path"><code>/path/to/forgeops/kustomize/base/7.0/ds/base</code></span>
directory.</p>
</li>
<li>
<p>Set your Kubernetes context to your CDM cluster:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectx <em>my-kubernetes-context</em></strong></pre>
</div>
</div>
</li>
<li>
<p>Create the <span class="path"><code>cloud-storage-credentials.yaml</code></span> credential file:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl create secret generic cloud-storage-credentials \
 --from-literal=AZURE_ACCOUNT_KEY_ID=<code><em>my-account-key</em></code> \
 --from-literal=AZURE_ACCOUNT_NAME=<code><em>my-account-name</em></code> \
 --dry-run=client -o yaml &gt; cloud-storage-credentials.yaml</strong></pre>
</div>
</div>
</li>
<li>
<p>Apply the credential information to the running CDM instance:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl apply -f cloud-storage-credentials.yaml</strong></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Set up the backup location in the configuration of the running CDM instance:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Get the <code>platform-config</code> configmap:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl -n prod get configmap platform-config -o yaml &gt; <em>my-config.yaml</em></strong></pre>
</div>
</div>
</li>
<li>
<p>Edit the local configmap file and set the <code>DSBACKUP_DIRECTORY</code> parameter to
the link of the DS data backup container.</p>
<div class="paragraph">
<p>For example: <code>DSBACKUP_DIRECTORY</code> <span class="path"><code>az://<em>my-backup-bucket</em></code></span></p>
</div>
</li>
<li>
<p>Apply the change to the running CDM:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl apply -f my-config.yaml</strong></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Apply the same change to your local Kustomization overlay file:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change to the <span class="path"><code>/path/to/forgeops/kustomize/base/kustomizeConfig</code></span>
directory.</p>
</li>
<li>
<p>Edit the <span class="path"><code>kustomization.yaml</code></span> file and set the <code>DSBACKUP_DIRECTORY</code>
parameter to the string <code>az://</code>, followed by the name of the backup container.</p>
<div class="paragraph">
<p>For example: <code>DSBACKUP_DIRECTORY</code> <span class="path"><code>az://<em>my-backup-container</em></code></span></p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>Now you are ready to enable and schedule backups.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="enable_ds_backup_schedules"><a class="anchor" href="#enable_ds_backup_schedules"></a>Enable DS Backup Schedules</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>After setting up your cloud storage for backup, you can enable $DS backup,
if you had not already enabled backup when you deployed your CDM:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set up your Kubernetes context and namespace.</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong> kubectx <em>my-cdm-context</em></strong>
$ <strong> kubens <em>my-namespace</em></strong></pre>
</div>
</div>
<div class="paragraph">
<p>In the CDM deployment, DS is deployed to the <span class="path"><code>prod</code></span>
namespace. So you would specify <span class="path"><code>prod</code></span> as the namespace in the above
command. If you have deployed DS in another namespace, you must specify
the corresponding namespace.</p>
</div>
</li>
<li>
<p>Get the names of the DS pods.</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong> kubectl get pods</strong></pre>
</div>
</div>
</li>
<li>
<p>Restart the DS pods.</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong> kubectl delete ds-idrepo-0</strong>
$ <strong> kubectl delete ds-cts-0</strong></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>After enabling backup, you can schedule backups of the directory data.</p>
</div>
<div class="sect2">
<h3 id="default_backup_schedule"><a class="anchor" href="#default_backup_schedule"></a>Default Backup Schedule</h3>
<div class="paragraph">
<p>The default backup schedule creates incremental backups of the <code>idrepo</code>
instance at the beginning of every hour, and the <code>cts</code> instance at 10 minutes
past every hour.</p>
</div>
<div class="paragraph">
<p>Run the <span class="command"><code>schedule-backups.sh</code></span> script to start backing up <code>cts</code> and
<code>idrepo</code> instances using the default schedule:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong> /path/to/forgeops/bin/schedule-backups.sh <em>my-namespace</em></strong></pre>
</div>
</div>
<div class="paragraph">
<p>In the CDM deployment, DS is deployed to the <span class="path"><code>prod</code></span>
namespace. So you would specify <span class="path"><code>prod</code></span> as the namespace in the above
command. If you have deployed DS in another namespace, you must specify
the corresponding namespace.</p>
</div>
</div>
<div class="sect2">
<h3 id="customized_backup_schedule"><a class="anchor" href="#customized_backup_schedule"></a>Customized Backup Schedule</h3>
<div class="paragraph">
<p>You can customize the backup schedule for <code>cts</code> and <code>idrepo</code> instances
separately. You can also schedule backups from any DS pod.</p>
</div>
<div class="paragraph">
<p>To customize the schedule for the <code>idrepo</code> instance, and to schedule backups
from the <code>ds-idrepo-1</code> pod in addition to the <code>ds-idrepo-2</code> pod:</p>
</div>
<div class="openblock procedure">
<div class="title">Customize Backup Schedule</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Edit the <span class="command"><code>schedule-backups.sh</code></span> file in the
<span class="path"><code>/path/to/forgeops/bin</code></span> folder and change the line
<code>BACKUP_SCHEDULE_IDREPO="0 * * * *"</code> to suit your backup schedule for <code>idrepo</code>.</p>
<div class="paragraph">
<p>For example, the following line schedules an incremental backup for the <code>idrepo</code>
instance every 30 minutes:</p>
</div>
<div class="paragraph">
<p><code>BACKUP_SCHEDULE_IDREPO="*/30 * * * *"</code></p>
</div>
</li>
<li>
<p>Edit the <span class="path"><code>kustomization.yaml</span></code> file in the
<span class="path"><code>/path/to/forgeops/kustomize/base/kustomizeConfig</code></span> folder on your
local computer and change the line that begins with <code>- DSBACKUP_HOSTS=</code> to:</p>
<div class="paragraph">
<p><code>- DSBACKUP_HOSTS="ds-cts-2,ds-idrepo-2,ds-idrepo-1"</code></p>
</div>
</li>
<li>
<p>Run the <span class="command"><code>schedule-backups.sh</code></span> script.</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>/path/to/forgeops/bin/schedule-backups.sh prod</strong></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>Similarly, edit the <span class="command"><code>schedule-backups.sh</code></span> script and change the line
<code>BACKUP_SCHEDULE_CTS="10 * * * *"</code> to suit your backup schedule for the
<code>cts</code> instance. If you want to add or change the <code>cts</code> pod that performs
backup, edit the <span class="path"><code>kustomization.yaml</span></code> file in the
<span class="path"><code>/path/to/forgeops/kustomize/base/kustomizeConfig</code></span> folder. Then run
the <span class="command"><code>schedule-backups.sh</code></span> script.</p>
</div>
<div class="paragraph">
<p>The <span class="command"><code>schedule-backups.sh</code></span> script stops any previously scheduled
backup jobs before initiating the new schedule.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdm_automatic_restore"><a class="anchor" href="#cdm_automatic_restore"></a>CDM Automatic Restore</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When the CDM is deployed, new, empty DS instances are created. You
can enable the automatic restore capability in CDM to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deploy new DS instances using the data from a previous backup.</p>
</li>
<li>
<p>Set up the <code>cts</code> and <code>idrepo</code> DS pods to recover from operational failures.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The automatic restore capability to deploy new instances with backup data is
useful when a system disaster occurs, or when directory services are lost. It is
also useful when you want to port test environment data to a production
deployment. Note that when you restore a DS instance, all its replicas
are restored.</p>
</div>
<div class="paragraph">
<p>You can enable automatic restore before you deploy CDM. To enable
automatic restore, you must set up the DS data backup to cloud
storage, copy the backup data to the cloud storage location, and then follow
these steps:</p>
</div>
<div class="openblock procedure">
<div class="title">Enable Automatic Restore</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Change to the <span class="path"><code>/path/to/forgeops/kustomize/base/kustomizeConfig</code></span>
directory.</p>
</li>
<li>
<p>Edit the <span class="path"><code>kustomization.yaml</code></span> file and set the <code>AUTORESTORE_FROM_DSBACKUP</code>
parameter to "true".</p>
</li>
<li>
<p>Deploy platform as described in
<a href="cdm/deploy.html" class="page">CDM Deployment</a>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>In a CDM deployment that has automatic restore enabled, you can recover a
failed pod:</p>
</div>
<div class="openblock procedure">
<div class="title">Recover a Failed DS Pod</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Delete the PVC attached to the failed DS pod using the
<span class="command"><code>kubectl delete pvc</code></span> command. The PVC might not get deleted
immediately if the attached pod is running.</p>
</li>
<li>
<p>In another terminal window, stop the failed DS pod using the
<span class="command"><code>kubectl delete pod</code></span> command. This will delete the PVC.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>The automatic restore feature of CDM recreates the PVC, copies data from
the backup, restores the DS pod with the latest backup, and replicates
the current data from other DS pods.</p>
</div>
<div class="paragraph">
<p>You can also perform manual restore of DS. For more information about
how to manually restore DS, see the
<a href="https://ea.forgerock.com/docs/ds/maintenance-guide/backup-restore.html#restore">Restore</a>
section in the <em>ForgeRock Directory Services Maintenance Guide</em>.</p>
</div>
<div class="paragraph">
<p>Consider following these best practices:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use a backup that is newer than the last replication purge.</p>
</li>
<li>
<p>When you restore a DS replica using backups that are older than the
purge delay, that replica will no longer be able to participate in replication.
Reinitialize the replica to restore the replication topology.</p>
</li>
<li>
<p>If the available backups are older than the purge delay, then initialize the
DS replica from an up-to-date master instance. For more information on
how to initialize a replica, see
<a href="https://ea.forgerock.com/docs/ds/config-guide/replication.html#init-repl">Manual
Initialization</a> in the <em>ForgeRock Directory Services Configuration Guide</em>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="monitoring_customizations"><a class="anchor" href="#monitoring_customizations"></a>Monitoring Customizations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This topic describes the CDM&#8217;s monitoring architecture. It also covers
common customizations you might perform to change the way monitoring, reporting,
and sending alerts works in your environment.</p>
</div>
<div class="paragraph">
<p>The CDM uses Prometheus to monitor ForgeRock Identity Platform components and
Kubernetes objects, Prometheus Alertmanager to send alert notifications, and
Grafana to analyze metrics using dashboards.</p>
</div>
<div class="paragraph">
<p>Prometheus and Grafana are deployed when you run the
<a href="https://github.com/ForgeRock/forgeops/blob/master/bin/prometheus-deploy.sh">prometheus-deploy.sh</a>
script. This script installs Helm charts from the
<a href="https://github.com/coreos/prometheus-operator">prometheus-operator</a>
project into the <code>monitoring</code> namespace of a CDM cluster. These Helm
charts deploy Kubernetes pods that run the Prometheus and Grafana services.</p>
</div>
<div class="paragraph">
<p>The following Prometheus and Grafana pods from the <code>prometheus-operator</code> project
run in the <code>monitoring</code> namespace:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Pod</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>alertmanager-prometheus-operator-alertmanager-0</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Handles Prometheus alerts by grouping them together, filtering them, and then
routing them to a receiver, such as a Slack channel.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>prometheus-operator-kube-state-metrics-...</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Generates Prometheus metrics for cluster node resources, such as CPU, memory,
and disk usage. One pod is deployed for each CDM node.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>prometheus-operator-prometheus-node-exporter-...</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Generates Prometheus metrics for Kubernetes API objects, such as deployments
and nodes.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>prometheus-operator-grafana-...</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Provides the Grafana service.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>prometheus-prometheus-operator-prometheus-0</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Provides the Prometheus service.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>See the
<a href="https://github.com/helm/charts/blob/master/stable/prometheus-operator/README.md">prometheus-operator Helm chart README file</a>
for more information about the pods in the preceding table.</p>
</div>
<div class="paragraph">
<p>In addition to the pods from the
<a href="https://github.com/coreos/prometheus-operator">prometheus-operator</a> project, the
<code>import-dashboards-...</code> pod from the
<a href="https://github.com/ForgeRock/forgeops">forgeops</a> project runs after Grafana
starts up. This pod imports Grafana dashboards from the ForgeRock Identity Platform and
terminates after importing has completed.</p>
</div>
<div class="paragraph">
<p>To access CDM monitoring dashboards, see
<a href="cdm/access.html#cdm-monitoring" class="page">CDM Monitoring</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The CDM uses Prometheus and Grafana for monitoring, reporting, and
sending alerts. If you prefer to use different tools, deploy infrastructure in
Kubernetes to support those tools.</p>
</div>
<div class="paragraph">
<p>Prometheus and Grafana are evolving technologies. Descriptions of these
technologies were accurate at the time of this writing, but might differ when
you deploy them.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="custom_grafana_dashboard_imports"><a class="anchor" href="#custom_grafana_dashboard_imports"></a>Custom Grafana Dashboard Imports</h3>
<div class="paragraph">
<p>The CDM includes a set of Grafana dashboards. You can customize, export
and import Grafana dashboards using the Grafana UI or HTTP API.</p>
</div>
<div class="paragraph">
<p>For information about importing custom Grafana dashboards, see the
<a href="https://github.com/ForgeRock/forgeops/blob/master/cluster/addons/prometheus/README.md#import-custom-grafana-dashboards">Import Custom Grafana Dashboards</a>
section of the Prometheus and Grafana Deployment README file
in the <a href="https://github.com/ForgeRock/forgeops">forgeops</a> repository.</p>
</div>
</div>
<div class="sect2">
<h3 id="prometheus_operator"><a class="anchor" href="#prometheus_operator"></a>Prometheus Operator</h3>
<div class="paragraph">
<p>The CDM&#8217;s monitoring framework is based on the
<a href="https://github.com/coreos/prometheus-operator">Prometheus Operator for Kubernetes</a>
project. The Prometheus Operator project provides monitoring definitions for
Kubernetes services and deployment, and management of Prometheus instances.</p>
</div>
<div class="paragraph">
<p>When deployed, the Prometheus Operator watches for ServiceMonitor
CRDs&#x2014;Kubernetes Custom Resource Definitions. CRDs are Kubernetes class
types that you can manage with the <span class="command"><code>kubectl</code></span> command. The
ServiceMonitor CRDs define targets to be scraped.</p>
</div>
<div class="paragraph">
<p>In the CDM, the Prometheus Operator configuration is defined in the
<a href="https://github.com/ForgeRock/forgeops/blob/master/etc/prometheus-values/prometheus-operator.yaml">prometheus-operator.yaml</a>
file in the <a href="https://github.com/ForgeRock/forgeops">forgeops</a> repository. To
customize the CDM monitoring framework, change values in these files,
following the examples documented in README files in the
<a href="https://github.com/coreos/prometheus-operator">Prometheus Operator project on GitHub</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="additional_alerts"><a class="anchor" href="#additional_alerts"></a>Additional Alerts</h3>
<div class="paragraph">
<p>CDM alerts are defined in the
<a href="https://github.com/ForgeRock/forgeops/blob/master/cluster/addons/prometheus/forgerock-metrics/templates/fr-alerts.yaml">fr-alerts.yaml</a>
file in the <a href="https://github.com/ForgeRock/forgeops">forgeops</a> repository.</p>
</div>
<div class="paragraph">
<p>To configure additional alerts, see the
<a href="https://github.com/ForgeRock/forgeops/blob/master/cluster/addons/prometheus/README.md#configure-alerting-rules">Configure Alerting Rules</a>
section of the Prometheus and Grafana Deployment README file in the
<a href="https://github.com/ForgeRock/forgeops">forgeops</a> repository.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="security_customizations"><a class="anchor" href="#security_customizations"></a>Security Customizations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This topic describes several options for securing the ForgeRock Identity Platform as
deployed on the CDM.</p>
</div>
<div class="sect2">
<h3 id="forgerock_secret_agent_operator"><a class="anchor" href="#forgerock_secret_agent_operator"></a>ForgeRock Secret Agent Operator</h3>
<div class="paragraph">
<p>The open source ForgeRock Secret Agent operator randomly generates all secrets
for AM, IDM, and DS services running in the CDK and
the CDM. The Secret Agent operator runs as a Kubernetes pod, which must
be available before AM, IDM, and DS are deployed.</p>
</div>
<div class="paragraph">
<p>By default, the operator examines your namespace to determine whether it
contains all the secrets required for ForgeRock Identity Platform deployment. If any of the
required secrets are not present, the operator generates them. Configuration
options that let you change this default behavior are available.</p>
</div>
<div class="paragraph">
<p>In addition to secret generation, the operator also integrates with Google Cloud
Secret Manager, AWS Secrets Manager, and Azure Key Vault, providing cloud backup
and retrieval for secrets.</p>
</div>
<div class="paragraph">
<p>For more information about secret generation options and secret management, see
the <a href="https://github.com/ForgeRock/secret-agent">Secret Agent project README</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="add-user-access"><a class="anchor" href="#add-user-access"></a>Cluster Access for Multiple AWS Users</h3>
<div class="paragraph">
<p>It&#8217;s common for team members to share the use of a cluster. For team members to
share a cluster, the cluster owner must grant access to each user.</p>
</div>
<div class="openblock procedure">
<div class="title">Grant Users Access to an EKS Cluster</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Get the ARNs and names of users who need access to your cluster.</p>
</li>
<li>
<p>Set the Kubernetes context to your Amazon EKS cluster.</p>
</li>
<li>
<p>Edit the authorization configuration map for the cluster using the
<span class="command"><code>kubectl edit</code></span> command:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl edit -n kube-system configmap/aws-auth</strong></pre>
</div>
</div>
</li>
<li>
<p>Under the <code>mapRoles</code> section, insert the <code>mapUser</code> section. An example is
shown here with the following parameters:</p>
<div class="ulist">
<ul>
<li>
<p>The user ARN is
<code>arn:aws:iam::<em>012345678901</em>:<em>user/new.user</em></code>.</p>
</li>
<li>
<p>The user name registered in AWS is <code><em>new.user</em></code>.</p>
<div class="listingblock">
<div class="content">
<pre>&#8230;&#8203; <strong>mapUsers: |
    - userarn: arn:aws:iam::<em>012345678901</em>:user/<em>new.user</em>
      username: <em>new.user</em>
      groups:
        - system:masters</strong>
&#8230;&#8203;</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>For each additional user, insert the <code>- userarn:</code> entry in the <code>mapUsers:</code>
section:</p>
<div class="listingblock">
<div class="content">
<pre>&#8230;&#8203; <strong>mapUsers: |
    - userarn: arn:aws:iam::<em>012345678901</em>:user/<em>new.user</em>
      username: <em>new.user</em>
      groups:
        - system:masters
    - userarn: arn:aws:iam::<em>901234567890</em>:user/<em>second.user</em>
      username: <em>second.user</em>
      groups:
        - system:masters</strong>
&#8230;&#8203;</pre>
</div>
</div>
</li>
<li>
<p>Save the configuration map.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="access_restriction_by_ip_address"><a class="anchor" href="#access_restriction_by_ip_address"></a>Access Restriction by IP Address</h3>
<div class="paragraph">
<p>When installing the ingress controller in production environments, you should
consider configuring a CIDR block in the Helm chart for the ingress controller
so that you restrict access to worker nodes from a specific IP address or a
range of IP addresses.</p>
</div>
<div class="paragraph">
<p>To specify a range of IP addresses allowed to access resources controlled by the
ingress controller, specify the
<code>--set controller.service.loadBalancerSourceRanges=<em>your IP range</em></code> option
when you install your ingress controller.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>helm install --namespace nginx --name nginx \
 --set rbac.create=true \
 --set controller.publishService.enabled=true \
 --set controller.stats.enabled=true \
 --set controller.service.externalTrafficPolicy=Local \
 --set controller.service.type=LoadBalancer \
 --set controller.image.tag="0.21.0" \
 --set controller.service.annotations."service\.beta\.kubernetes\.io/aws-load-balancer-type"="nlb" \
 --set controller.service.loadBalancerSourceRanges="{81.0.0.0/8,3.56.113.4/32}" \
 stable/nginx-ingress</strong></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="secure-http"><a class="anchor" href="#secure-http"></a>Secure HTTP</h3>
<div class="paragraph">
<p>The CDK and CDM enable secure communication with ForgeRock Identity Platform
services using an SSL-enabled ingress controller. Incoming requests and outgoing
responses are encrypted. SSL is terminated at the ingress controller.</p>
</div>
<div class="paragraph">
<p>You can configure communication with ForgeRock Identity Platform services using one of the
following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Over HTTPS using a self-signed certificate</strong>. Communication is encrypted,
but users will receive warnings about insecure communication from some browsers.</p>
</li>
<li>
<p><strong>Over HTTPS using a certificate with a trust chain that starts at a trusted
root certificate</strong>. Communication is encrypted, and users will not receive
warnings from their browsers.</p>
</li>
<li>
<p><strong>Over HTTPS using a dynamically obtained certificate from
<a href="https://letsencrypt.org/">Let&#8217;s Encrypt</a></strong>. Communication is encrypted and users
will not receive warnings from their browsers. A <code>cert-manager</code> pod installed in
your Kubernetes cluster calls Let&#8217;s Encrypt to obtain a certificate, and then
automatically installs a Kubernetes secret.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You install a Helm chart from the
<a href="https://github.com/jetstack/cert-manager">cert-manager project</a> to provision
certificates. By default, the pod issues a self-signed certificate. You can also
configure the pod to issue a certificate with a trust chain that begins at a
trusted root certificate, or to dynamically obtain a certificate from
Let&#8217;s Encrypt.</p>
</div>
<div class="sect3">
<h4 id="certificate_management_automation"><a class="anchor" href="#certificate_management_automation"></a>Certificate Management Automation</h4>
<div class="paragraph">
<p>In the CDM, certificate management is provided by the
<a href="https://github.com/jetstack/cert-manager">cert-manager</a> add-on. The certificate
manager deployed in CDM generates a self-signed certificate to secure
CDM communication.</p>
</div>
<div class="paragraph">
<p>In your own deployment, you can specify a different certificate issuer or DNS
challenge provider by changing values in the
<a href="https://github.com/ForgeRock/forgeops/blob/master/kustomize/base/7.0/ingress/ingress.yaml">ingress.yaml</a>
file.</p>
</div>
<div class="paragraph">
<p>For more information about configuring certificate management, see the
<a href="https://cert-manager.readthedocs.io">cert-manager</a> documentation.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdm_benchmarking"><a class="anchor" href="#cdm_benchmarking"></a>CDM Benchmarking</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The benchmarking instructions in this part of the documentation give you a
method to validate performance of your CDM deployment.</p>
</div>
<div class="paragraph">
<p>The benchmarking techniques we present are a lightweight example, and are not a
substitute for load testing a production deployment. Use our benchmarking
techniques to help you get started with the task of constructing your own load
tests.</p>
</div>
<div class="paragraph">
<p>Remember, <a href="start/start-here.html#cdm-sandbox" class="page">the CDM is a
reference implementation and not for production use</a>. When you
<a href="start/start-here.html#planning" class="page">create a project plan</a>, you&#8217;ll need to
think about how you&#8217;ll put together production-quality load tests that
accurately measure your own deployment&#8217;s performance.</p>
</div>
<div class="sect2">
<h3 id="cdm_benchmarking_checklist"><a class="anchor" href="#cdm_benchmarking_checklist"></a>CDM Benchmarking Checklist</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> <a href="deployment/benchmark/intro.html" class="page">Become familiar with CDM benchmarking</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="deployment/benchmark/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="deployment/benchmark/testusers.html" class="page">Generate test users</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="deployment/benchmark/authrate.html" class="page">Benchmark the authentication rate</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="deployment/benchmark/oauth2.html" class="page">Benchmark the OAuth 2.0 authorization code flow</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="about_cdm_benchmarking"><a class="anchor" href="#about_cdm_benchmarking"></a>About CDM Benchmarking</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="deployment/benchmark/overview.html" class="page">CDM Benchmarking</a> provides instructions for running
lightweight benchmarks to give you a means for validating your own CDM
deployment.</p>
</div>
<div class="paragraph">
<p>The Cloud Deployment Team runs the same benchmark tests. Our results are
available upon request from ForgeRock. To get them, contact your ForgeRock sales
representative.</p>
</div>
<div class="paragraph">
<p>We conduct our tests using the configurations specified for
<a href="cdm/architecture.html#cluster-sizes" class="page">small, medium, and large CDM
clusters</a>. We create our clusters using the techniques described in the
<a href="cdm/overview.html" class="page">CDM documentation</a>.</p>
</div>
<div class="paragraph">
<p>Next, we create test users:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>1,000,000 test users for a small cluster</p>
</li>
<li>
<p>10,000,000 test users for a medium cluster</p>
</li>
<li>
<p>100,000,000 test users for a large cluster</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Finally, we run tests that measure authentication rates and OAuth 2.0
authorization code flow performance.</p>
</div>
<div class="paragraph">
<p>If you follow the same method of deploying the CDM and running
benchmarks, the results you obtain should be similar to ForgeRock&#8217;s results.
However, factors beyond the scope of the CDM, or a failure to use our
documented sizing and configuration, may affect your benchmark test results.
These factors might include (but are not limited to): updates to cloud platform
SDKs; changes to third-party software required for Kubernetes; changes you have
made to sizing or configuration to suit your business needs.</p>
</div>
<div class="paragraph">
<p>The CDM is designed to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Conform to DevOps best practices</p>
</li>
<li>
<p>Facilitate continuous integration and continuous deployment</p>
</li>
<li>
<p>Scale and deploy on any Kubernetes environment in the cloud</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you require higher performance than the benchmarks reported here, you can
scale your deployment horizontally and vertically. Vertically scaling
ForgeRock Identity Platform works particularly well in the cloud. For more information about
scaling your deployment, contact your qualified ForgeRock partner or technical
consultant.</p>
</div>
<h3 id="next_step_62" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="deployment/benchmark/intro.html" class="page">Become familiar with CDM benchmarking</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="deployment/benchmark/sw.html" class="page">Install third-party software</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="deployment/benchmark/testusers.html" class="page">Generate test users</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="deployment/benchmark/authrate.html" class="page">Benchmark the authentication rate</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="deployment/benchmark/oauth2.html" class="page">Benchmark the OAuth 2.0 authorization code flow</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="third_party_software_8"><a class="anchor" href="#third_party_software_8"></a>Third-Party Software</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Cloud Deployment Team used Gradle 6.6.1 to benchmark the CDM. Before
you start running benchmarks, install this version of Gradle in your local
environment.</p>
</div>
<div class="paragraph">
<p>Earlier and later versions will <em>probably</em> work. If you want to try using
another version, it is your responsibility to validate it.</p>
</div>
<div class="paragraph">
<p>In addition to Gradle, you&#8217;ll need all the third-party software required to
deploy the CDM:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="cdm/gke/setup/sw.html" class="page">GKE</a></p>
</li>
<li>
<p><a href="cdm/eks/setup/sw.html" class="page">EKS</a></p>
</li>
<li>
<p><a href="cdm/aks/setup/sw.html" class="page">AKS</a></p>
</li>
</ul>
</div>
<h3 id="next_step_63" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="deployment/benchmark/intro.html" class="page">Become familiar with CDM benchmarking</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="deployment/benchmark/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="deployment/benchmark/testusers.html" class="page">Generate test users</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="deployment/benchmark/authrate.html" class="page">Benchmark the authentication rate</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="deployment/benchmark/oauth2.html" class="page">Benchmark the OAuth 2.0 authorization code flow</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="test_user_generation"><a class="anchor" href="#test_user_generation"></a>Test User Generation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you can test the performance of a CDM deployment, you must
generate test users, provision the CDM userstores, and prime the
directory servers.</p>
</div>
<div class="openblock procedure">
<div class="title">Provision the Userstores with Test Users</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure your Kubernetes context is set to the cluster in which the
CDM is deployed, and that <code>prod</code> is the current namespace.</p>
</li>
<li>
<p>Obtain the password for the directory superuser, <code>uid=admin</code>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/bin</strong>
$ <strong>./print-secrets.sh dsadmin</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Make a note of this password. You&#8217;ll need it for subsequent steps in this
procedure.</p>
</div>
</li>
<li>
<p>Change to the directory that contains the source for the <code>dsutil</code> Docker
container:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /path/to/forgeops/docker/7.0/ds/dsutil</strong></pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll generate test users from a pod you create from the <code>dsutil</code> container.</p>
</div>
</li>
<li>
<p>Build and push the <code>dsutil</code> Docker container to your container registry, and
then run the container.</p>
<div class="paragraph">
<p>The <em>my-registry</em> parameter varies, depending on the location of your registry:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>docker build --tag=<em>my-registry</em>/dsutil .</strong>
$ <strong>docker push <em>my-registry</em>/dsutil</strong>
$ <strong>kubectl run -it dsutil --image=<em>my-registry</em>/dsutil --restart=Never -- bash</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <span class="command"><code>kubectl run</code></span> command creates the <code>dsutil</code> pod, and leaves you in
a shell that lets you run commands in the pod.</p>
</div>
</li>
<li>
<p>Generate the test users&#8212;&#8203;1,000,000 users for a small CDM cluster,
10,000,000 for a medium cluster, and 100,000,000 for a large cluster. Run these
substeps from the <code>dsutil</code> pod&#8217;s shell:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Make an LDIF file that has the number of user entries for your cluster size:</p>
<div class="paragraph">
<p>For example, for a small cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>/opt/opendj/bin/makeldif -o data/entries.ldif \
 -c numusers=1000000 config/MakeLDIF/ds-idrepo.template</strong>
Processed 1000 entries
Processed 2000 entries
Processed 3000 entries
. . .
Processed 1000000 entries
LDIF processing complete. 1000003 entries written</pre>
</div>
</div>
<div class="paragraph">
<p>When the Cloud Deployment Team ran the <span class="command"><code>makeldif</code></span> script, it took
approximately:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>30 seconds to run on a small cluster.</p>
</li>
<li>
<p>xx minutes to run on a medium cluster (details to be provided for CLOUD-2635).</p>
</li>
<li>
<p>xx minutes to run on a large cluster (details to be provided for CLOUD-2635).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Create the user entries in the directory:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>/opt/opendj/bin/ldapmodify \
 -h ds-idrepo-0.ds-idrepo -p 1389 --useStartTls --trustAll \
 -D "uid=admin" -w <em>directory-superuser-password</em> --noPropertiesFile \
 --no-prompt --continueOnError --numConnections 10 data/entries.ldif</strong></pre>
</div>
</div>
<div class="paragraph">
<p><code>ADD operation successful</code> messages appear as user entries are added to the
directory.</p>
</div>
<div class="paragraph">
<p>When the Cloud Deployment Team ran the <span class="command"><code>ldapmodify</code></span> command, it
took approximately:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>15 minutes to run on a small cluster.</p>
</li>
<li>
<p>xx minutes to run on a medium cluster (details to be provided for CLOUD-2635).</p>
</li>
<li>
<p>xx minutes to run on a large cluster (details to be provided for CLOUD-2635).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Leave the <code>dsutil</code> pod&#8217;s shell open. You&#8217;ll use it to run the DS
benchmark tests.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Prime the directory servers:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Open a new terminal window or tab.</p>
<div class="paragraph">
<p>Use this terminal&#8212;&#8203;not the terminal window running the <code>dsutil</code> pod&#8217;s shell&#8212;&#8203;for
the remaining substeps in this step.</p>
</div>
</li>
<li>
<p>Prime the directory server running in the <code>ds-idrepo-0</code> pod:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Get a shell that lets you run commands in the <code>id-dsrepo-0</code> pod:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>kubectl exec ds-idrepo-0 -it -- bash</strong></pre>
</div>
</div>
</li>
<li>
<p>Run the following command:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>ldapsearch -D "uid=admin" -w <em>directory-superuser-password</em> \
 -p 1636 -b "ou=identities"  uid=user.*  | grep dn: | wc -l</strong>
10000000</pre>
</div>
</div>
</li>
<li>
<p>Exit from the <code>id-dsrepo-0</code> pod&#8217;s shell:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>exit</strong></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Prime the directory server running in the <code>ds-idrepo-1</code> pod.</p>
</li>
<li>
<p>Prime the directory server running in the <code>ds-idrepo-2</code> pod.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<h3 id="next_step_64" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="deployment/benchmark/intro.html" class="page">Become familiar with CDM benchmarking</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="deployment/benchmark/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="deployment/benchmark/testusers.html" class="page">Generate test users</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="deployment/benchmark/authrate.html" class="page">Benchmark the authentication rate</a></mark></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <a href="deployment/benchmark/oauth2.html" class="page">Benchmark the OAuth 2.0 authorization code flow</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="authentication_rate"><a class="anchor" href="#authentication_rate"></a>Authentication Rate</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>AMRestAuthNSim.scala</code> simulation tests authentication rates using the REST
API. It measures the throughput and response times of an AM server
performing REST authentications when AM is configured to use CTS-based
sessions.</p>
</div>
<div class="paragraph">
<p>To run the simulation:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure the userstore is provisioned, and the Directory Services cache is primed.</p>
<div class="paragraph">
<p>See <a href="deployment/benchmark/testusers.html" class="page">Test User Generation</a>.</p>
</div>
</li>
<li>
<p>Set environment variables that specify the host on which to run the test,
the number of concurrent threads to spawn when running the test, the duration of
the test (in seconds), the first part of the user ID, and the user password, and
the number of users for the test:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>export TARGET_HOST=prod.iam.example.com</strong>
$ <strong>export CONCURRENCY=100</strong>
$ <strong>export DURATION=60</strong>
$ <strong>export USER_PREFIX=user.</strong>
$ <strong>export USER_PASSWORD=T35tr0ck123</strong>
$ <strong>export USER_POOL=<em>n-users</em></strong></pre>
</div>
</div>
<div class="paragraph">
<p>where <em>n-users</em> is <code>1000000</code> for a small cluster, <code>10000000</code> for a medium
cluster, and <code>100000000</code> for a large cluster.</p>
</div>
</li>
<li>
<p>Configure AM for CTS-based sessions:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Log in to the platform console as the <code>amadmin</code> user. For details, see
<a href="cdm/access.html#am-services-cdm" class="page">AM Services</a>.</p>
</li>
<li>
<p>Go to the native AM console.</p>
</li>
<li>
<p>Select the top level realm.</p>
</li>
<li>
<p>Select Properties.</p>
</li>
<li>
<p>Make sure the Use Client-based Sessions option is disabled.</p>
<div class="paragraph">
<p>If it&#8217;s not disabled, disable it, and then select Save Changes.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Change to the <span class="path"><code>/path/to/forgeops/docker/gatling</code></span> directory.</p>
</li>
<li>
<p>Run the simulation:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>gradle clean; gradle gatlingRun-am.AMRestAuthNSim</strong></pre>
</div>
</div>
<div class="paragraph">
<p>When the simulation is complete, the name of a file containing the test results
appears near the end of the output.</p>
</div>
</li>
<li>
<p>Open the file containing the test results in a browser to review the results.</p>
</li>
</ol>
</div>
<h3 id="next_step_65" class="discrete">Next Step</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="deployment/benchmark/intro.html" class="page">Become familiar with CDM benchmarking</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="deployment/benchmark/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="deployment/benchmark/testusers.html" class="page">Generate test users</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="deployment/benchmark/authrate.html" class="page">Benchmark the authentication rate</a></p>
</li>
<li>
<p><i class="fa fa-square-o"></i> <mark><a href="deployment/benchmark/oauth2.html" class="page">Benchmark the OAuth 2.0 authorization code flow</a></mark></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="oauth_2_0_authorization_code_flow"><a class="anchor" href="#oauth_2_0_authorization_code_flow"></a>OAuth 2.0 Authorization Code Flow</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>AMAccessTokenSim.scala</code> simulation tests OAuth 2.0 authorization code flow
performance. It measures the throughput and response time of an AM server
performing authentication, authorization, and session token management when
AM is configured to use client-based sessions, and OAuth 2.0 is
configured to use client-based tokens. In this test, one transaction includes
all three operations.</p>
</div>
<div class="paragraph">
<p>To run the simulation:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure the userstore is provisioned, and the Directory Services cache is primed.</p>
<div class="paragraph">
<p>See <a href="deployment/benchmark/testusers.html" class="page">Test User Generation</a>.</p>
</div>
</li>
<li>
<p>Set environment variables that specify the host on which to run the test,
the number of concurrent threads to spawn when running the test, the duration of
the test (in seconds), the first part of the user ID, and the user password, and
the number of users for the test:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>export TARGET_HOST=prod.iam.example.com</strong>
$ <strong>export CONCURRENCY=100</strong>
$ <strong>export DURATION=60</strong>
$ <strong>export USER_PREFIX=user.</strong>
$ <strong>export USER_PASSWORD=T35tr0ck123</strong>
$ <strong>export USER_POOL=<em>n-users</em></strong></pre>
</div>
</div>
<div class="paragraph">
<p>where <em>n-users</em> is <code>1000000</code> for a small cluster, <code>10000000</code> for a medium
cluster, and <code>100000000</code> for a large cluster.</p>
</div>
</li>
<li>
<p>Configure AM for CTS-based sessions:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Log in to the platform console as the <code>amadmin</code> user. For details, see
<a href="cdm/access.html#am-services-cdm" class="page">AM Services</a>.</p>
</li>
<li>
<p>Go to the native AM console.</p>
</li>
<li>
<p>Select the top level realm.</p>
</li>
<li>
<p>Select Properties.</p>
</li>
<li>
<p>Make sure the Use Client-based Sessions option is disabled.</p>
<div class="paragraph">
<p>If it&#8217;s not disabled, disable it, and then select Save Changes.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Configure AM for CTS-based OAuth2 tokens:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Select Realms  &gt; Top Level Realm.</p>
</li>
<li>
<p>Select Services &gt; OAuth2 Provider.</p>
</li>
<li>
<p>Make sure the Use Client-based Access &amp; Refresh Tokens option is
disabled.</p>
<div class="paragraph">
<p>If it&#8217;s not disabled, disable it, and then select Save Changes.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Change to the <span class="path"><code>/path/to/forgeops/docker/gatling</code></span> directory.</p>
</li>
<li>
<p>Run the simulation:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>gradle clean; gradle gatlingRun-am.AMAccessTokenSim</strong></pre>
</div>
</div>
<div class="paragraph">
<p>When the simulation is complete, the name of a file containing the test results
appears near the end of the output.</p>
</div>
</li>
<li>
<p>Open the file containing the test results in a browser to review the results.</p>
</li>
</ol>
</div>
<h3 id="congratulations" class="discrete">Congratulations!</h3>
<div class="paragraph">
<p>Youve successfully run the CDM lightweight benchmark tests.</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> <a href="deployment/benchmark/intro.html" class="page">Become familiar with CDM benchmarking</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="deployment/benchmark/sw.html" class="page">Install third-party software</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="deployment/benchmark/testusers.html" class="page">Generate test users</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="deployment/benchmark/authrate.html" class="page">Benchmark the authentication rate</a></p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> <a href="deployment/benchmark/oauth2.html" class="page">Benchmark the OAuth 2.0 authorization code flow</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="devops_release_notes"><a class="anchor" href="#devops_release_notes"></a>DevOps Release Notes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Click <a href="rn/kubernetes-versions.html" class="page">here</a> for recommended Kubernetes versions
for deploying ForgeRock Identity Platform 7.</p>
</div>
<div class="paragraph">
<p>Click <a href="rn/limitations.html" class="page">here</a> for limitations when deploying ForgeRock Identity Platform
7 on Kubernetes.</p>
</div>
<div class="sect2">
<h3 id="october_28_2020"><a class="anchor" href="#october_28_2020"></a>October 28, 2020</h3>
<div class="paragraph">
<p><a href="forgeops.html#forgeops-updates" class="page">Release tag</a>: <code>2020.10.28-AlSugoDiNoci</code></p>
</div>
<div class="paragraph">
<p>This release of the <code>forgeops</code> repository includes major changes to the way
secrets are generated for CDM and CDK deployments. It introduces
new, simpler cluster provisioning and removal scripts, and reintroduces support
for small, medium, and large CDM cluster sizes. It also includes bug
fixes and several smaller enhancements.</p>
</div>
<div class="sect3">
<h4 id="highlights"><a class="anchor" href="#highlights"></a>Highlights</h4>
<div class="ulist">
<ul>
<li>
<p><a href="rn/highlights.html#r2020.10.28-AlSugoDiNoci-secret-agent" class="page">
New Secret Agent operator</a></p>
</li>
<li>
<p><a href="rn/highlights.html#r2020.10.28-AlSugoDiNoci-cluster-provisioning" class="page">
New cluster provisioning scripts</a></p>
</li>
<li>
<p><a href="rn/highlights.html#r2020.10.28-AlSugoDiNoci-sml" class="page">
Small, medium, and large CDM cluster sizing</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="changes"><a class="anchor" href="#changes"></a>Changes</h4>
<div class="ulist">
<ul>
<li>
<p><a href="rn/changes.html#r2020.10.28-AlSugoDiNoci-rt-data-types" class="page">
All main AM run-time data types supported when exporting configuration data</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020.10.28-AlSugoDiNoci-benchmarks" class="page">
Performance benchmark changes</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020.10.28-AlSugoDiNoci-prometheus-grafana" class="page">
Prometheus and Grafana web UI access without port forwarding</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020.10.28-AlSugoDiNoci-task-lists" class="page">
Task maps and checklists in the documentation</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020.10.28-AlSugoDiNoci-idm-deployment" class="page">
IDM pod deployed as a Kubernetes deployment object</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020.10.28-AlSugoDiNoci-minikube-cni" class="page">
Minikube <code>cni=true</code> option</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="deprecated"><a class="anchor" href="#deprecated"></a>Deprecated</h4>
<div class="ulist">
<ul>
<li>
<p><a href="rn/deprecated.html#r2020.10.28-AlSugoDiNoci-forgeops-secret" class="page">
<code>forgeops-secret</code> job</a></p>
</li>
<li>
<p><a href="rn/deprecated.html#r2020.10.28-AlSugoDiNoci-pulumi" class="page">
Cluster provisioning using Pulumi</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="august_10_2020"><a class="anchor" href="#august_10_2020"></a>August 10, 2020</h3>
<div class="paragraph">
<p><a href="forgeops.html#forgeops-updates" class="page">Release tag</a>: <code>2020.08.07-ZucchiniRicotta.1</code></p>
</div>
<div class="paragraph">
<p>This major new release of the <code>forgeops</code> repository supports ForgeRock Identity Platform 7.
In addition to enabling new features in the platform, this release adds
usability and security enhancements.</p>
</div>
<div class="paragraph">
<p>Click
<a href="https://github.com/ForgeRock/forgeops/releases/tag/2020.08.07-ZucchiniRicotta">here</a>
for the detailed change log.</p>
</div>
<div class="sect3">
<h4 id="highlights_2"><a class="anchor" href="#highlights_2"></a>Highlights</h4>
<div class="ulist">
<ul>
<li>
<p><a href="rn/highlights.html#r2020-08-10-ds-in-cloud" class="page">
Docker- and Kubernetes-ready DS</a></p>
</li>
<li>
<p><a href="rn/highlights.html#r2020-08-10-ds-cloud-backup" class="page">
DS backup to cloud storage</a></p>
</li>
<li>
<p><a href="rn/highlights.html#r2020-08-10-am-idm-integration" class="page">
AM and IDM integration</a></p>
</li>
<li>
<p><a href="rn/highlights.html#r2020-08-10-ds-as-idm-repo" class="page">
DS as IDM&#8217;s repository</a></p>
</li>
<li>
<p><a href="rn/highlights.html#r2020-08-10-am-fbc" class="page">
AM file-based configuration</a></p>
</li>
<li>
<p><a href="rn/highlights.html#r2020-08-10-docs" class="page">
Revised DevOps documentation</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="changes_2"><a class="anchor" href="#changes_2"></a>Changes</h4>
<div class="ulist">
<ul>
<li>
<p><a href="rn/changes.html#r2020-08-10-new-k8s-versions" class="page">
CDM on newer Kubernetes versions</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-08-10-print-secrets" class="page">
New <span class="command"><code>print-secrets.sh</code></span> script</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-08-10-ui-pods" class="page">
New UI pods</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-08-10-no-need-to-scale" class="page">
No need to explicitly scale AM in the CDM</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-08-10-ds-superuser" class="page">
Different directory superuser DN and backend database</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-08-10-minikube-reqs" class="page">
Increased virtual hardware requirements for running the CDK on Minikube</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-08-10-base-images" class="page">
New technique for building base Docker images</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-08-10-idm-rest-api" class="page">
New technique for IDM REST API access</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="deprecated_2"><a class="anchor" href="#deprecated_2"></a>Deprecated</h4>
<div class="ulist">
<ul>
<li>
<p><a href="rn/deprecated.html#r2020-08-10-6.5-artifacts" class="page">
DevOps artifacts for deploying ForgeRock Identity Platform 6.5</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="removed"><a class="anchor" href="#removed"></a>Removed</h4>
<div class="ulist">
<ul>
<li>
<p><a href="rn/removed.html#r2020-08-10-dockerfiles" class="page">
AM, Amster, IDM, DS, and IG Dockerfiles</a></p>
</li>
<li>
<p><a href="rn/removed.html#r2020-08-10-helm" class="page">
Helm charts</a></p>
</li>
<li>
<p><a href="rn/removed.html#r2020-08-10-amster-pod" class="page"><code>amster</code> pod</a></p>
</li>
<li>
<p><a href="rn/removed.html#r2020-08-10-postgresql-pod" class="page">
PostgreSQL pod</a></p>
</li>
<li>
<p><a href="rn/removed.html#r2020-08-10-web-pod" class="page">
<code>web</code> pod</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="documentation_updates"><a class="anchor" href="#documentation_updates"></a>Documentation Updates</h4>
<div class="ulist">
<ul>
<li>
<p><a href="rn/doc-updates.html#r2020-09-03-rn-misc-fixes" class="page">
Miscellaneous documentation fixes (September 3, 2020)</a></p>
</li>
<li>
<p><a href="rn/doc-updates.html#r2020-08-18-rn-6.5-deprecated" class="page">
New release note: DevOps artifacts for version 6.5 are deprecated (August 18, 2020)</a></p>
</li>
<li>
<p><a href="rn/doc-updates.html#r2020-08-17-OPENAM-16656" class="page">
Workaround for OPENAM-16656 and OPENAM-16658 (August 17, 2020)</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="july_16_2020"><a class="anchor" href="#july_16_2020"></a>July 16, 2020</h3>
<div class="paragraph">
<p><a href="forgeops.html#forgeops-updates" class="page">Release tag</a>: <code>2020.07.15-alleVongole</code></p>
</div>
<div class="paragraph">
<p>This release provides performance improvements and small bug fixes.</p>
</div>
<div class="paragraph">
<p>Click
<a href="https://github.com/ForgeRock/forgeops/releases/tag/2020.07.15-alleVongole">here</a>
for the detailed change log.</p>
</div>
</div>
<div class="sect2">
<h3 id="june_25_2020"><a class="anchor" href="#june_25_2020"></a>June 25, 2020</h3>
<div class="paragraph">
<p><a href="forgeops.html#forgeops-updates" class="page">Release tag</a>: <code>2020.06.24-laPaniscia</code></p>
</div>
<div class="paragraph">
<p>This release provides performance improvements and small bug fixes.</p>
</div>
<div class="paragraph">
<p>Click
<a href="https://github.com/ForgeRock/forgeops/releases/tag/2020.06.24-laPaniscia">here</a>
for the detailed change log.</p>
</div>
</div>
<div class="sect2">
<h3 id="may_18_2020"><a class="anchor" href="#may_18_2020"></a>May 18, 2020</h3>
<div class="paragraph">
<p><a href="forgeops.html#forgeops-updates" class="page">Release tag</a>: <code>2020.05.13-AlPomodoro.1</code></p>
</div>
<div class="paragraph">
<p>This release changes the recommended method for obtaining the <code>forgeops</code>
repository. We now recommend that users clone the repository, and then create a
branch based on the current release tag. For more information, see
<a href="forgeops.html" class="page">About the <code>forgeops</code> Repository (Pre-Release)</a>.</p>
</div>
<div class="paragraph">
<p>The release also provides performance improvements and small bug fixes.</p>
</div>
<div class="paragraph">
<p>Click
<a href="https://github.com/ForgeRock/forgeops/releases/tag/2020.05.13-AlPomodoro.1">here</a>
for the detailed change log.</p>
</div>
<div class="sect3">
<h4 id="highlights_3"><a class="anchor" href="#highlights_3"></a>Highlights</h4>
<div class="ulist">
<ul>
<li>
<p><a href="rn/highlights.html#r2020-2020-05-18-release-tags" class="page">
<code>forgeops</code> repository release tags</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="february_21_2020"><a class="anchor" href="#february_21_2020"></a>February 21, 2020</h3>
<div class="paragraph">
<p>This release is a major new revision of the <code>forgeops</code> repository, and provides
a completely new approach to ForgeRock DevOps. This release changes the way that
AM, IDM, and IG configuration is stored and managed.
Instead of relying on the external <code>forgeops-init</code> repository, configuration is
now stored inside the Docker images for AM, IDM, and IG.
Instead of using Helm charts, the <code>forgeops</code> repository now includes Kustomize
and Skaffold example artifacts for deploying the CDK and CDM on
Kubernetes.</p>
</div>
<div class="paragraph">
<p>The model for CDM cluster creation has also changed. Instead of bash
scripts, the <code>forgeops</code> repository now provides Pulumi scripts to create GKE,
EKS, and AKS clusters in which the CDM is installed.</p>
</div>
<div class="sect3">
<h4 id="highlights_4"><a class="anchor" href="#highlights_4"></a>Highlights</h4>
<div class="ulist">
<ul>
<li>
<p><a href="rn/highlights.html#r2020-02-20-docker-images" class="page">
Docker images include the AM, IDM, and IG configuration</a></p>
</li>
<li>
<p><a href="rn/highlights.html#r2020-02-20-skaffold" class="page">
Skaffold framework support</a></p>
</li>
<li>
<p><a href="rn/highlights.html#r2020-02-20-kustomize" class="page">
Kustomize framework support</a></p>
</li>
<li>
<p><a href="rn/highlights.html#r2020-02-20-cdk" class="page">
The ForgeRock Cloud Developer&#8217;s Kit</a></p>
</li>
<li>
<p><a href="rn/highlights.html#r2020-02-20-cdk-cdm-same-config" class="page">
Identical configurations for the CDK and the CDM</a></p>
</li>
<li>
<p><a href="rn/highlights.html#r2020-02-20-pulumi" class="page">
Pulumi scripts for CDM cluster creation</a></p>
</li>
<li>
<p><a href="rn/highlights.html#r2020-02-20-forgeops-secrets" class="page">
Secrets generator</a></p>
</li>
<li>
<p><a href="rn/highlights.html#r2020-02-20-aks-cookbook" class="page">
Completely revised AKS Cookbook</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="changes_3"><a class="anchor" href="#changes_3"></a>Changes</h4>
<div class="ulist">
<ul>
<li>
<p><a href="rn/changes.html#r2020-02-20-skaffold-kustomize" class="page">
Deployment with Skaffold and Kustomize instead of Helm</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-3az2np" class="page">
Changes to CDM zones and node pools</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-add-on-scripts" class="page">
New scripts for installing third-party components</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-tiller" class="page">
Helm tiller pod no longer required</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-revised-benchmarking" class="page">
Revised benchmarking technique</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-revised-backup" class="page">
Revised backup technique</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-ds-topology" class="page">
Modified DS topology in the CDM</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-ig-not-default" class="page">
IG not deployed by default</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-cdm-sizing-benchmarks" class="page">
CDM sizing and benchmarks</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-admin-passwords" class="page">
Randomly generated administrator passwords</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-new-names" class="page">
New Docker image and pod names</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-build-images" class="page">
New method for building base Docker images</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-customize-am" class="page">
AM WAR file customization script removed</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-backup-loader" class="page">
New <span class="command"><code>backup-loader.sh</code></span> script</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-default-urls" class="page">
Different default URLs</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-3party" class="page">
Support for newer versions of CDM third-party software</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-minikube-cdk-self-signed" class="page">
Certificate Manager no longer required for the CDK on Minikube</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-cdm-self-signed" class="page">
Self-signed certificates for GKE CDM deployments</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-2-devops-guides" class="page">
<em>DevOps Developer&#8217;s Guide</em> replaced</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-no-before-you-deploy" class="page">
<em>Before You Deploy</em> section moved</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-no-quickstart" class="page">
<em>DevOps QuickStart Guide</em> removed</a></p>
</li>
<li>
<p><a href="rn/changes.html#r2020-02-20-linux-mac" class="page">
CDM and CDK installation requires Linux or macOS</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="deprecated_3"><a class="anchor" href="#deprecated_3"></a>Deprecated</h4>
<div class="ulist">
<ul>
<li>
<p><a href="rn/deprecated.html#r2020-02-20-helm" class="page">
Helm charts</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="removed_2"><a class="anchor" href="#removed_2"></a>Removed</h4>
<div class="ulist">
<ul>
<li>
<p><a href="rn/removed.html#r2020-02-20-forgeops-init" class="page">
<code>forgeops-init</code> repository</a></p>
</li>
<li>
<p><a href="rn/removed.html#r2020-02-20-cdm-bash-scripts" class="page">
bash scripts for CDM cluster creation</a></p>
</li>
<li>
<p><a href="rn/removed.html#r2020-02-20-downloader" class="page">
Downloader utility</a></p>
</li>
<li>
<p><a href="rn/removed.html#r2020-02-20-customize-am" class="page">
AM WAR file customization script</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="support_from_forgerock"><a class="anchor" href="#support_from_forgerock"></a>Support From ForgeRock</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This appendix contains information about support options for the ForgeRock Cloud Developer&#8217;s Kit, the ForgeRock Cloud Deployment Model, and the ForgeRock Identity Platform.</p>
</div>
<div class="sect2">
<h3 id="forgerock_devops_support"><a class="anchor" href="#forgerock_devops_support"></a>ForgeRock DevOps Support</h3>
<div class="paragraph">
<p>ForgeRock has developed artifacts in the
<a href="https://github.com/ForgeRock/forgeops">forgeops</a> Git repository for the purpose
of deploying the ForgeRock Identity Platform in the cloud. The companion
<a href="index.html" class="page">DevOps documentation</a> provides examples, including
the ForgeRock Cloud Developer&#8217;s Kit (CDK) and the ForgeRock Cloud Deployment Model (CDM), to help
you get started.</p>
</div>
<div class="paragraph">
<p>These artifacts and documentation are provided on an "as is" basis. ForgeRock
does not guarantee the individual success developers may have in implementing
the code on their development platforms or in production configurations.</p>
</div>
<div class="sect3">
<h4 id="commercial-support"><a class="anchor" href="#commercial-support"></a>Commercial Support</h4>
<div class="paragraph">
<p>ForgeRock provides commercial support for the following DevOps resources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Artifacts in the <a href="https://github.com/ForgeRock/forgeops">forgeops</a> Git
repository:</p>
<div class="ulist">
<ul>
<li>
<p>Files used to build Docker images for the ForgeRock Identity Platform:</p>
<div class="ulist">
<ul>
<li>
<p>Dockerfiles</p>
</li>
<li>
<p>Scripts and configuration files incorporated into ForgeRock&#8217;s Docker images</p>
</li>
<li>
<p>Canonical configuration profiles for the platform</p>
</li>
</ul>
</div>
</li>
<li>
<p>Kustomize bases and overlays</p>
</li>
<li>
<p>Skaffold configuration files</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="index.html" class="page">ForgeRock DevOps Documentation</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>ForgeRock provides commercial support for the ForgeRock Identity Platform. For supported
components, containers, and Java versions, see the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://ea.forgerock.com/docs/am/release-notes/#chap-rnotes-before-you-install">ForgeRock Access Management Release Notes</a></p>
</li>
<li>
<p><a href="https://ea.forgerock.com/docs/idm/release-notes/#chap-before-you-install">ForgeRock Identity Management Release Notes</a></p>
</li>
<li>
<p><a href="https://ea.forgerock.com/docs/ds/release-notes/before-you-install.html">ForgeRock Directory Services Release Notes</a></p>
</li>
<li>
<p><a href="https://ea.forgerock.com/docs/ig/release-notes/#chap-before-you-install">ForgeRock Identity Gateway Release Notes</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="support_limitations"><a class="anchor" href="#support_limitations"></a>Support Limitations</h4>
<div class="paragraph">
<p>ForgeRock provides no commercial support for the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Artifacts other than Dockerfiles, Kustomize bases, Kustomize overlays, and
Skaffold YAML configuration files in the
<a href="https://github.com/ForgeRock/forgeops"> forgeops</a> Git repository. Examples
include scripts, example configurations, and so forth.</p>
</li>
<li>
<p>Non-ForgeRock infrastructure. Examples include Docker, Kubernetes, Google
Cloud Platform, Amazon Web Services, Microsoft Azure, and so forth.</p>
</li>
<li>
<p>Non-ForgeRock software. Examples include Java, Apache Tomcat, NGINX, Apache
HTTP Server, Certificate Manager, Prometheus, and so forth.</p>
</li>
<li>
<p>Production deployments that use ForgeRock&#8217;s evaluation-only Docker images.
When deploying the ForgeRock Identity Platform using Docker images, you must build and use
your own images for production deployments. For information about how to build
your own Docker images for the ForgeRock Identity Platform,
see <a href="deployment/base-docker-images.html" class="page">Base Docker Images</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="third_party_kubernetes_services"><a class="anchor" href="#third_party_kubernetes_services"></a>Third-Party Kubernetes Services</h4>
<div class="paragraph">
<p>ForgeRock supports deployments on Google Kubernetes Engine (GKE), Amazon Elastic
 Kubernetes Service (Amazon EKS), Microsoft Azure Kubernetes Service (AKS), and
 Red Hat OpenShift.</p>
</div>
<div class="paragraph">
<p>Red Hat OpenShift is a tested and supported platform using Kubernetes for
deployment. ForgeRock uses OpenShift tools such as the OpenShift installer, as
well as other representative environments, such as Amazon AWS, for the testing.
We do not test using bare metal due to the many customer permutations of
deployment and configuration that may exist, and therefore cannot guarantee that
we have tested in the same way a customer chooses to deploy. We will make
commercially reasonable efforts to provide first-line support for any reported
issue. In the case we are unable to reproduce a reported issue internally, we
will request the customer engage OpenShift support to collaborate on problem
identification and remediation. Customers deploying on OpenShift are expected to
have a support contract in place with IBM/Red Hat that ensures support resources
can be engaged if this situation may occur.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="documentation_access"><a class="anchor" href="#documentation_access"></a>Documentation Access</h3>
<div class="paragraph">
<p>ForgeRock publishes comprehensive documentation online:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The ForgeRock <a href="https://backstage.forgerock.com/knowledge/kb">Knowledge Base</a> offers a large and increasing
number of up-to-date, practical articles that help you deploy and manage
ForgeRock software.</p>
<div class="paragraph">
<p>While many articles are visible to community members, ForgeRock customers have
access to much more, including advanced information for customers using
ForgeRock software in a mission-critical capacity.</p>
</div>
</li>
<li>
<p>ForgeRock developer documentation, such as this site, aims to be technically
accurate with respect to the sample that is documented. It is visible to
everyone.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="problem_reports_and_feedback"><a class="anchor" href="#problem_reports_and_feedback"></a>Problem Reports and Feedback</h3>
<div class="paragraph">
<p>If you are a named customer Support Contact, contact ForgeRock using the
<a href="https://backstage.forgerock.com/support">Customer Support Portal</a> to request
information, or report a problem with Dockerfiles, Kustomize bases, Kustomize
overlays, or Skaffold YAML configuration files in the CDK or the
CDM.</p>
</div>
<div class="paragraph">
<p>If you have questions regarding the CDK or the CDM that are not
answered in the documentation, file an issue at
<a href="https://github.com/ForgeRock/forgeops/issues" class="bare">https://github.com/ForgeRock/forgeops/issues</a>.</p>
</div>
<div class="paragraph">
<p>When requesting help with a problem, include the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Description of the problem, including when the problem occurs and its impact
on your operation.</p>
</li>
<li>
<p>Steps to reproduce the problem.</p>
<div class="paragraph">
<p>If the problem occurs on a Kubernetes system other than Minikube, GKE, EKS,
OpenShift, or AKS, we might ask you to reproduce the problem on one of those.</p>
</div>
</li>
<li>
<p>HTML output from the <span class="command"><code>debug-logs.sh</code></span> script. For more
information, see
<a href="cdk/troubleshoot.html#pods" class="page">Pod Descriptions and Container Logs</a>.</p>
</li>
<li>
<p>Description of the environment, including the following information:</p>
<div class="ulist">
<ul>
<li>
<p>Environment type: Minikube, GKE, EKS, AKS, or OpenShift.</p>
</li>
<li>
<p>Software versions of supporting components:</p>
<div class="ulist">
<ul>
<li>
<p>Oracle VirtualBox (Minikube environments only).</p>
</li>
<li>
<p>Docker client (all environments).</p>
</li>
<li>
<p>Minikube (all environments).</p>
</li>
<li>
<p><span class="command"><code>kubectl</code></span> command (all environments).</p>
</li>
<li>
<p>Kustomize (all environments).</p>
</li>
<li>
<p>Skaffold (all environments).</p>
</li>
<li>
<p>Google Cloud SDK (GKE environments only).</p>
</li>
<li>
<p>Amazon AWS Command Line Interface (EKS environments only).</p>
</li>
<li>
<p>Azure Command Line Interface (AKS environments only).</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>forgeops</code> repository branch.</p>
</li>
<li>
<p>Any patches or other software that might be affecting the problem.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="contact_information"><a class="anchor" href="#contact_information"></a>Contact Information</h3>
<div class="paragraph">
<p>ForgeRock provides support services, professional services, training through ForgeRock University, and partner services to assist you in setting up and maintaining your deployments. For a general overview of these services, see <a href="https://www.forgerock.com" class="bare">https://www.forgerock.com</a>.</p>
</div>
<div class="paragraph">
<p>ForgeRock has staff members around the globe who support our international customers and partners. For details on ForgeRock&#8217;s support offering, including support plans and service-level agreements (SLAs), visit <a href="https://www.forgerock.com/support" class="bare">https://www.forgerock.com/support</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="glossary"><a class="anchor" href="#glossary"></a>Glossary</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">affinity (AM)</dt>
<dd>
<p>AM affinity deployment lets AM spread the LDAP reqests load over
multiple directory server instances. Once a CTS token is created and assigned to
a session, AM sends all subsequent token operations to the same token origin
directory server from any AM node. This ensures that the load of CTS token
management is spread across directory servers.</p>
<div class="paragraph">
<p>Source: <a href="https://backstage.forgerock.com/docs/am/7/cts-guide/cts-deployment-architectures.html#cts-affinity">
<em>CTS Affinity Deployment</em> in the Core Token Service (CTS) documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">Amazon EKS</dt>
<dd>
<p>Amazon Elastic Container Service for Kubernetes (Amazon EKS) is a managed
service that makes it easy for you to run Kubernetes on Amazon Web Services
without needing to set up or maintain your own Kubernetes control plane.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.aws.amazon.com/eks/latest/userguide/what-is-eks.html">
<em>What is Amazon EKS</em> in the Amazon EKS documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">ARN (AWS)</dt>
<dd>
<p>An Amazon Resource Name (ARN) uniquely identifies an Amazon Web Service (AWS)
resource. AWS requires an ARN when you need to specify a resource unambiguously
across all of AWS, such as in IAM policies and API calls.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html">
<em>Amazon Resource Names (ARNs)</em> in the AWS documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">AWS IAM Authenticator for Kubernetes</dt>
<dd>
<p>The AWS IAM Authenticator for Kubernetes is an authentication tool that lets you
use Amazon Web Services (AWS) credentials for authenticating to a Kubernetes
cluster.</p>
<div class="paragraph">
<p>Source: <a href="https://github.com/kubernetes-sigs/aws-iam-authenticator/blob/master/README.md">
<em>AWS IAM Authenticator for Kubernetes <code>README</code> file on GitHub</em></a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">Azure Kubernetes Service (AKS)</dt>
<dd>
<p>AKS is a managed container orchestration service based on Kubernetes.
AKS is available on the Microsoft Azure public cloud. AKS manages your hosted
Kubernetes environment, making it quick and easy to deploy and manage
containerized applications.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.microsoft.com/en-us/azure/aks/intro-kubernetes"><em>Azure
Kubernetes Service (AKS) documentation</em></a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">cloud-controller-manager</dt>
<dd>
<p>The <code>cloud-controller-manager</code> daemon runs controllers that interact with the
underlying cloud providers. The <code>cloud-controller-manager</code> daemon runs
provider-specific controller loops only.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/overview/components/#cloud-controller-manager">
<em>The <code>cloud-controller-manager</code></em> section in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">Cloud Developer&#8217;s Kit (CDK)</dt>
<dd>
<p>The developer artifacts in the <code>forgeops</code> Git repository,
together with the ForgeRock Identity Platform documentation, form the Cloud Developer&#8217;s Kit
(CDK). Use the CDK to set up the platform in your developer
environment.</p>
<div class="paragraph">
<p>Source: <em><a href="cdk/intro.html" class="page">About the Cloud Developer's Kit</a></em></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">Cloud Deployment Model (CDM)</dt>
<dd>
<p>The Cloud Deployment Model (CDM) is a common use ForgeRock Identity Platform architecture,
designed to be easy to deploy and easy to replicate. The ForgeRock Cloud
Deployment Team has developed Kustomize bases and overlays, Skaffold configuration
files, Docker images, and other artifacts expressly to build the CDM.</p>
<div class="paragraph">
<p>Source: <em><a href="cdm/intro.html" class="page">About the Cloud Deployment Model</a></em></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">CloudFormation (AWS)</dt>
<dd>
<p>CloudFormation is a service that helps you model and set up your AWS resources.
You create a template that describes all the AWS resources that you want. AWS
CloudFormation takes care of provisioning and configuring those resources for you.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/Welcome.html">
<em>What is AWS CloudFormation?</em> in the AWS documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
</dl>
</div>
<div id="cloudformation-template" class="dlist">
<dl>
<dt class="hdlist1">CloudFormation template (AWS)</dt>
<dd>
<p>An AWS CloudFormation template describes the resources that you want to provision
in your <a href="#stack-aws">AWS stack</a>. AWS CloudFormation templates are text files
formatted in JSON or YAML.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-guide.html">
<em>Working with AWS CloudFormation Templates</em> in the AWS documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">cluster</dt>
<dd>
<p>A container cluster is the foundation of Kubernetes Engine. A cluster consists
of at least one <a href="#cluster-master">cluster master</a> and multiple worker machines called nodes. The
Kubernetes objects that represent your containerized applications all run on top
of a cluster.</p>
<div class="paragraph">
<p>Source: <a href="https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-architecture">
<em>Cluster Architecture</em> in the Google Kubernetes Engine (GKE) documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
</dl>
</div>
<div id="cluster-master" class="dlist">
<dl>
<dt class="hdlist1">cluster master</dt>
<dd>
<p>A cluster master schedules, runs, scales, and upgrades the workloads on all nodes
of the cluster. The cluster master also manages network and storage resources for
workloads.</p>
<div class="paragraph">
<p>Source: <a href="https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-architecture#master">
<em>Cluster master in the Google Kubernetes Engine (GKE) docuementation</em></a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">ConfigMap</dt>
<dd>
<p>A configuration map, called <code>ConfigMap</code> in Kubernetes manifests, binds the
configuration files, command-line arguments, environment variables, port numbers,
and other configuration artifacts to the assigned containers and system
components at runtime. The configuration maps are useful for storing and sharing
non-sensitive, unencrypted configuration information.</p>
<div class="paragraph">
<p>Source: <a href="https://cloud.google.com/kubernetes-engine/docs/concepts/configmap">
<em>ConfigMap</em> in the Google Kubernetes Engine (GKE) documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
</dl>
</div>
<div id="container" class="dlist">
<dl>
<dt class="hdlist1">container</dt>
<dd>
<p>A container is an allocation of resources such as CPU, network I/O, bandwidth,
block I/O, and memory that can be "contained" together and made available to
specific processes without interference from the rest of the system. Containers
decouple applications from underlying host infrastructure.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/containers/"><em>Containers</em> in the
Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">DaemonSet</dt>
<dd>
<p>A set of daemons, called <code>DaemonSet</code> in Kubernetes manifests, manages a group of
replicated pods. Usually, the daemon set follows a one-pod-per-node model.
As you add nodes to a node pool, the daemon set automatically distributes the
pod workload to the new nodes as needed.</p>
<div class="paragraph">
<p>Source: <a href="https://cloud.google.com/kubernetes-engine/docs/concepts/daemonset">
<em>DaemonSet</em> in the Google Cloud Platform documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">deployment</dt>
<dd>
<p>A Kubernetes deployment represents a set of multiple, identical pods. Deployment
runs multiple replicas of your application and automatically replaces any
instances that fail or become unresponsive.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">
<em>Deployments</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">deployment controller</dt>
<dd>
<p>A deployment controller provides declarative updates for pods and replica sets.
You describe a desired state in a deployment object, and the deployment controller
changes the actual state to the desired state at a controlled rate. You can define
deployments to create new replica sets, or to remove existing deployments and
adopt all their resources with new deployments.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">
<em>Deployments</em> in the Google Cloud documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">Docker container</dt>
<dd>
<p>A Docker container is a runtime instance of a Docker image. The container is
isolated from other containers and its host machine. You can control how isolated
your container&#8217;s network, storage, or other underlying subsystems are from other
containers or from the host machine.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.docker.com/get-started/overview/#docker-objects">
<em>Containers section</em> in the Docker Getting Started documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">Docker daemon</dt>
<dd>
<p>The Docker daemon (<code>dockerd</code>) listens for Docker API requests and manages Docker
objects such as images, containers, networks, and volumes. A Docker daemon
can also communicate with other Docker daemons to manage Docker services.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.docker.com/get-started/overview/#the-docker-daemon">
<em>Docker daemon</em> section in the Docker Overview documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">Docker Engine</dt>
<dd>
<p>The Docker Engine is a client-server application with these components:</p>
<div class="ulist">
<ul>
<li>
<p>A server, which is a type of long-running program called a daemon process (the
<code>dockerd</code> command)</p>
</li>
<li>
<p>A REST API, which specifies interfaces that programs can use to talk to the
daemon and tell it what to do</p>
</li>
<li>
<p>A command-line interface (CLI) client (the <code>docker</code> command)</p>
<div class="paragraph">
<p>Source: <a href="https://docs.docker.com/get-started/overview/#docker-engine"><em>Docker
Engine</em> section in the Docker Overview documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Dockerfile</dt>
<dd>
<p>A Dockerfile is a text file that contains the instructions for building a
Docker image. Docker uses the Dockerfile to automate the process of building a
Docker image.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.docker.com/engine/reference/builder/">
<em>Dockerfile</em> section in the Docker Reference documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
</dl>
</div>
<div id="docker-hub" class="dlist">
<dl>
<dt class="hdlist1">Docker Hub</dt>
<dd>
<p>Docker Hub provides a place for you and your team to build and ship
<a href="#docker-image">Docker images</a>. You can create public repositories that can be
accessed by any other Docker Hub user, or you can create private repositories
you can control access to.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.docker.com/docker-hub/"><em>Docker Hub Quickstart</em> section in
the Docker Overview documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
</dl>
</div>
<div id="docker-image" class="dlist">
<dl>
<dt class="hdlist1">Docker image</dt>
<dd>
<p>A Docker image is an application you would like to run. A container is a running
instance of an image.</p>
<div class="paragraph">
<p>An image is a read-only template with instructions for creating a Docker container.
Often, an image is based on another image, with some additional customization.</p>
</div>
<div class="paragraph">
<p>An image includes the application code, a runtime engine, libraries, environment
variables, and configuration files that are required to run the application.</p>
</div>
<div class="paragraph">
<p>Source: <a href="https://docs.docker.com/get-started/overview/#docker-objects">
<em>Docker objects</em> section in the Docker Overview documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">Docker namespace</dt>
<dd>
<p>Docker namespaces provide a layer of isolation. When you run a container, Docker
creates a set of namespaces for that container. Each aspect of a container runs
in a separate namespace and its access is limited to that namespace.</p>
<div class="paragraph">
<p>The <code>PID</code> namespace is the mechanism for remapping process IDs inside the
container. Other namespaces such as net, mnt, ipc, and uts provide the isolated
environments we know as containers. The user namespace is the mechanism for
remapping user IDs inside a container.</p>
</div>
<div class="paragraph">
<p>Source: <a href="https://docs.docker.com/get-started/overview/#namespaces"><em>Namespaces</em>
section in the Docker Overview documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">Docker registry</dt>
<dd>
<p>A Docker registry stores <a href="#docker-image">Docker images</a>. Docker Hub and Docker
Cloud are public registries that anyone can use, and Docker is configured to
look for images on <a href="#docker-hub">Docker Hub</a> by default. You can also run your
own private registry.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.docker.com/get-started/overview/#docker-registries"><em>Docker
registries</em> section in the Docker Overview documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">Docker repository</dt>
<dd>
<p>A Docker repository is a public, certified repository from vendors and
contributors to Docker. It contains <a href="#docker-image">Docker images</a> that you can
use as the foundation to build your applications and services.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.docker.com/docker-hub/repos/"><em>Repositories</em> in the Docker
Overview documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">dynamic volume provisioning</dt>
<dd>
<p>The process of creating storage volumes on demand is called dynamic volume
provisioning. Dynamic volume provisioning lets you create storage volumes
on demand. It automatically provisions storage when it is requested by users.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/storage/dynamic-provisioning/">
<em>Dynamic Volume Provisioning</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
</dl>
</div>
<div id="egress" class="dlist">
<dl>
<dt class="hdlist1">egress</dt>
<dd>
<p>An egress controls access to destinations outside the network from within a
Kubernetes network. For an external destination to be accessed from a Kubernetes
environment, the destination should be listed as an allowed destination in the
whitelist configuration.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/services-networking/network-policies/">
<em>Network Policies</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">firewall rule</dt>
<dd>
<p>A firewall rule lets you allow or deny traffic to and from your virtual machine
instances based on a configuration you specify. Each Kubernetes network has a
set of firewall rules controlling access to and from instances in its subnets.
Each firewall rule is defined to apply to either incoming (<a href="#ingress">ingress</a>)
or outgoing (<a href="#egress">egress</a>) traffic, not both.</p>
<div class="paragraph">
<p>Source: <a href="https://cloud.google.com/vpc/docs/firewalls"><em>VPC firewall rules overview</em>
in the Google Cloud documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">garbage collection</dt>
<dd>
<p>Garbage collection is the process of deleting unused objects.
<a href="#kubelet">Kubelets</a> perform garbage collection for containers every minute, and
garbage collection for images every five minutes. You can adjust the high and
low threshold flags and garbage collection policy to tune image garbage
collection.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/workloads/controllers/garbage-collection/">
<em>Garbage Collection</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">Google Kubernetes Engine (GKE)</dt>
<dd>
<p>The Google Kubernetes Engine (GKE) is an environment for deploying, managing, and
scaling your containerized applications using Google infrastructure. The GKE
environment consists of multiple machine instances grouped together to form a
container cluster.</p>
<div class="paragraph">
<p>Source: <a href="https://cloud.google.com/kubernetes-engine/docs/concepts/kubernetes-engine-overview">
<em>GKE overview in the Google Cloud documentation</em></a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
</dl>
</div>
<div id="ingress" class="dlist">
<dl>
<dt class="hdlist1">ingress</dt>
<dd>
<p>An ingress is a collection of rules that allow inbound connections to reach the
cluster services.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/">
<em>Ingress</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">instance group</dt>
<dd>
<p>An instance group is a collection of instances of virtual machines. The instance
groups lets you easily monitor and control the group of virtual machines together.</p>
<div class="paragraph">
<p>Source: <a href="https://cloud.google.com/compute/docs/instance-groups/"><em>Instance groups</em>
in the Google Cloud documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">instance template</dt>
<dd>
<p>An instance template is a global API resource to create VM instances and managed
instance groups. Instance templates define the machine type, image, zone, labels,
and other instance properties. They are very helpful in replicating the environments.</p>
<div class="paragraph">
<p>Source: <a href="https://cloud.google.com/compute/docs/instance-templates/"><em>Instance
templates</em> in the Google Cloud documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">kubectl</dt>
<dd>
<p>The kubectl command-line tool supports several different ways to create and
manage Kubernetes objects.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/object-management/">
<em>Kubernetes Object Management</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">kube-controller-manager</dt>
<dd>
<p>The Kubernetes controller manager is a process that embeds core controllers
shipped with Kubernetes. Each controller is a separate process. To reduce
complexity, the controllers are compiled into a single binary and run in a
single process.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/reference/generated/kube-controller-manager/">
<em>kube-controller-manager</em> in the Kubernetes Reference documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
</dl>
</div>
<div id="kubelet" class="dlist">
<dl>
<dt class="hdlist1">kubelet</dt>
<dd>
<p>A kubelet is an agent that runs on each node in the cluster. It ensures that
containers are running in a pod.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/overview/components/#kubelet">
<em>kubelets</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">kube-scheduler</dt>
<dd>
<p>The <code>kube-scheduler</code> component is on the master node. It watches for newly created
pods that do not have a node assigned to them, and selects a node for them to
run on.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/overview/components/"><em>Kubernetes
components</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">Kubernetes</dt>
<dd>
<p>Kubernetes is an open source platform designed to automate deploying, scaling,
and operating application containers.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/"><em>What
is Kubernetes?</em> in the Kubernetes documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">Kubernetes DNS</dt>
<dd>
<p>A Kubernetes DNS pod is a pod used by the kubelets and the individual containers
to resolve DNS names in the cluster.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/">
<em>DNS for Services and Pods</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">Kubernetes namespace</dt>
<dd>
<p>Kubernetes supports multiple virtual clusters backed by the same physical cluster.
A Kubernetes namespace is a virtual cluster that provides a way to divide cluster
resources between multiple users. Kubernetes starts with three initial namespaces:</p>
<div class="ulist">
<ul>
<li>
<p><strong><code>default</code></strong>: The default namespace for user created objects which don&#8217;t have a
namespace</p>
</li>
<li>
<p><strong><code>kube-system</code></strong>: The namespace for objects created by the Kubernetes system</p>
</li>
<li>
<p><strong><code>kube-public</code></strong>: The automatically created namespace that is readable by all users</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/">
<em>Namespaces</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Let&#8217;s Encrypt</dt>
<dd>
<p>Let&#8217;s Encrypt is a free, automated, and open certificate authority.</p>
<div class="paragraph">
<p>Source: <a href="https://letsencrypt.org/"><em>Let&#8217;s Encrypt</em> web site</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">Microsoft Azure</dt>
<dd>
<p>Microsoft Azure is the Microsoft cloud platform, including infrastructure as a
service (IaaS) and platform as a service (PaaS) offerings.</p>
<div class="paragraph">
<p>Source: <a href="https://azure.microsoft.com/en-us/overview/cloud-computing-dictionary/">
<em>Cloud computing terms</em> in the Microsoft Azure documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">network policy</dt>
<dd>
<p>A Kubernetes network policy specifies how groups of pods are allowed to
communicate with each other and with other network endpoints.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/architecture/nodes/"><em>Network
policies</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">node (Kubernetes)</dt>
<dd>
<p>A Kubernetes node is a virtual or physical machine in the cluster. Each node is
managed by the master components and includes the services needed to run the pods.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/architecture/nodes/"><em>Nodes</em> in the
Kubernetes documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">node controller (Kubernetes)</dt>
<dd>
<p>A Kubernetes node controller is a Kubernetes master component that manages various
aspects of the nodes, such as: lifecycle operations, operational status, and
maintaining an internal list of nodes.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/architecture/nodes/#node-controller">
<em>Node Controller</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">node pool (Kubernetes)</dt>
<dd>
<p>A Kubernetes node pool is a collection of nodes with the same configuration.
At the time of creating a cluster, all the nodes created in the <code>default</code>
node pool. You can create your custom node pools for configuring specific nodes
that have a different resource requirements such as memory, CPU, and disk types.</p>
<div class="paragraph">
<p>Source: <a href="https://cloud.google.com/kubernetes-engine/docs/concepts/node-pools">
<em>Node pools</em> in the Google Kubernetes Engine (GKE) documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">persistent volume</dt>
<dd>
<p>A persistent volume (PV) is a piece of storage in the cluster that has been
provisioned by an administrator. It is a resource in the cluster just like a node
is a cluster resource. PVs are volume plugins that have a lifecycle independent
of any individual pod that uses the PV.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/">
<em>Persistent Volumes in the Kubernetes Concepts documentation</em></a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">persistent volume claim</dt>
<dd>
<p>A persistent volume claim (PVC) is a request for storage by a user. A PVC
specifies size, and access modes such as:</p>
<div class="ulist">
<ul>
<li>
<p>Mounted once for read and write access</p>
</li>
<li>
<p>Mounted many times for read-only access</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/">
<em>Persistent Volumes in the Kubernetes Concepts documentation</em></a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">pod anti-affinity (Kubernetes)</dt>
<dd>
<p>Kubernetes pod anti-affinity constrains which nodes can run your pod, based on
labels on the pods that are already running on the node, rather than based on
labels on nodes. Pod anti-affinity lets you control the spread of workload
across nodes and also isolate failures to nodes.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#inter-pod-affinity-and-anti-affinity-beta-feature">
<em>Assigning Pods to Nodes</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">pod (Kubernetes)</dt>
<dd>
<p>A Kubernetes pod is the smallest, most basic deployable object in Kubernetes.
A pod represents a single instance of a running process in a cluster. Containers
within a pod share an IP address and port space.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod-overview/#understanding-pods">
<em>Pods</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">region (Azure)</dt>
<dd>
<p>An Azure region, also known as a location, is an area within a geography,
containing one or more data centers.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.microsoft.com/en-us/azure/azure-glossary-cloud-terminology#region">
<em>region</em> in the Microsoft Azure glossary</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">replication controller (Kubernetes)</dt>
<dd>
<p>A replication controller ensures that a specified number of Kubernetes pod
replicas are running at any one time. The replication controller ensures that a
pod or a homogeneous set of pods is always up and available.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/workloads/controllers/replicationcontroller/">
<em>ReplicationController</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">resource group (Azure)</dt>
<dd>
<p>A resource group is a container that holds related resources for an application.
The resource group can include all of the resources for an application, or only
those resources that are logically grouped together.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.microsoft.com/en-us/azure/azure-glossary-cloud-terminology#resource-group">
<em>resource group</em> in the Microsoft Azure glossary</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">secret (Kubernetes)</dt>
<dd>
<p>A Kubernetes secret is a secure object that stores sensitive data, such as
passwords, OAuth 2.0 tokens, and SSH keys in your clusters.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/configuration/secret/">
<em>Secrets</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">security group (AWS)</dt>
<dd>
<p>A security group acts as a virtual firewall that controls the traffic for one or
more compute instances.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security-groups.html">
<em>Amazon EC2 security groups for Linux instances</em> in the AWS documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">service (Kubernetes)</dt>
<dd>
<p>A Kubernetes service is an abstraction which defines a logical set of pods and a
policy by which to access them. This is sometimes called a microservice.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/services-networking/service/">
<em>Service</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">service principal (Azure)</dt>
<dd>
<p>An Azure service principal is an identity created for use with applications,
hosted services, and automated tools to access Azure resources. Service
principals let applications access resources with the restrictions imposed
by the assigned roles instead of accessing resources as a fully privileged user.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.microsoft.com/en-us/powershell/azure/create-azure-service-principal-azureps?view=azps-2.4.0">
<em>Create an Azure service principal with Azure PowerShell</em> in the Microsoft
Azure PowerShell documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">shard</dt>
<dd>
<p>Sharding is a way of partitioning directory data so that the load can be shared
by multiple directory servers. Each data partition, also known as a shard,
exposes the same set of naming contexts, but only a subset of the data. For
example, a distribution might have two shards. The first shard contains all
users whose names begins with A-M, and the second contains all users whose names
begins with N-Z. Both have the same naming context.</p>
<div class="paragraph">
<p>Source: <a href="https://backstage.forgerock.com/docs/ds/5/server-javadoc/org/opends/server/discovery/Partition.html">
<em>Class Partition</em> in the OpenDS Javadoc</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
</dl>
</div>
<div id="stack-aws" class="dlist">
<dl>
<dt class="hdlist1">stack (AWS)</dt>
<dd>
<p>A stack is a collection of AWS resources that you can manage as a single unit.
You can create, update, or delete a collection of resources by using stacks. All
the resources in a stack are defined by the
<a href="#cloudformation-template">AWS template</a>.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacks.html">
<em>Working with stacks</em> in the AWS documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">stack set (AWS)</dt>
<dd>
<p>A stack set is a container for stacks. You can provision stacks across AWS
accounts and regions by using a single <a href="#cloudformation-template">AWS template</a>.
All the resources included in each stack of a stack set are defined by the same
template.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacksets-concepts.html">
<em>StackSets concepts</em> in the AWS documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">subscription (Azure)</dt>
<dd>
<p>An Azure subscription is used for pricing, billing, and payments for Azure
cloud services. Organizations can have multiple Azure subscriptions, and
subscriptions can span multiple regions.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.microsoft.com/en-us/azure/azure-glossary-cloud-terminology#subscription">
<em>subscription</em> in the Microsoft Azure glossary</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">volume (Kubernetes)</dt>
<dd>
<p>A Kubernetes volume is a storage volume that has the same lifetime as the
pod that encloses it. Consequently, a volume outlives any containers that
run within the pod, and data is preserved across container restarts. When a
pod ceases to exist, the Kubernetes volume also ceases to exist.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/storage/volumes/">
<em>Volumes</em> in the Kubernetes Concepts documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">VPC (AWS)</dt>
<dd>
<p>A virtual private cloud (VPC) is a virtual network dedicated to your AWS account.
It is logically isolated from other virtual networks in the AWS Cloud.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html">
<em>What Is Amazon VPC?</em> in the AWS documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">worker node (AWS)</dt>
<dd>
<p>An Amazon Elastic Container Service for Kubernetes (Amazon EKS) worker node is a
standard compute instance provisioned in Amazon EKS.</p>
<div class="paragraph">
<p>Source: <a href="https://docs.aws.amazon.com/eks/latest/userguide/worker.html">
<em>Self-managed nodes</em> in the AWS documentation</a></p>
</div>
<div class="paragraph">
<p></p>
</div>
</dd>
<dt class="hdlist1">workload (Kubernetes)</dt>
<dd>
<p>A Kubernetes workload is the collection of applications and batch jobs packaged
into a container. Before you deploy a workload on a cluster, you must first
package the workload into a <a href="#container">container</a>.</p>
<div class="paragraph">
<p>Source: <a href="https://kubernetes.io/docs/concepts/workloads"><em>Workloads</em> in the
Kubernetes Concepts documentation</a></p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. When you build the <code>am</code> Docker image, the AM configuration files are copied from the <span class="path"><code>/path/to/forgeops/docker/7.0/am/config</code></span> directory to the <span class="path"><code>/home/forgerock/openam/config</code></span> directory.
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. When you build the <code>idm</code> Docker image, the IDM configuration files are copied from the <span class="path"><code>/path/to/forgeops/docker/7.0/idm/conf</code></span> directory to the <span class="path"><code>/opt/openidm/conf</code></span> directory.
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. When you build the <code>am</code> Docker image, the AM configuration files are copied from the <span class="path"><code>/path/to/forgeops/docker/7.0/am/config</code></span> directory to the <span class="path"><code>/home/forgerock/openam/config</code></span> directory.
</div>
<div class="footnote" id="_footnotedef_4">
<a href="#_footnoteref_4">4</a>. When you build the <code>idm</code> Docker image, the IDM configuration files are copied from the <span class="path"><code>/path/to/forgeops/docker/7.0/idm/conf</code></span> directory to the <span class="path"><code>/opt/openidm/conf</code></span> directory.
</div>
<div class="footnote" id="_footnotedef_5">
<a href="#_footnoteref_5">5</a>. For the short term, follow the steps in the procedure to clone the <code>forgeops</code> repository and check out the <code>2020.10.28-AlSugoDiNoci</code> tag. For the long term, you&#8217;ll need to implement a strategy for managing updates, especially if a team of people in your organization works with the repository. For example, you might want to adopt a workflow that uses a fork as your organization&#8217;s common upstream repository. For more information, see <a href="forgeops.html" class="page">About the forgeops Repository</a>.
</div>
<div class="footnote" id="_footnotedef_6">
<a href="#_footnoteref_6">6</a>. Install Docker Desktop on macOS.  On Linux computers, install Docker CE instead.  For more information,  see <a href="https://www.docker.com/products/docker-desktop">the Docker documentation</a>.
</div>
<div class="footnote" id="_footnotedef_7">
<a href="#_footnoteref_7">7</a>. The Linux version of Homebrew does not support  installing software it maintains as casks. Because of this, if you&#8217;re  setting up an environment on Linux, you won&#8217;t be able to use Homebrew for  this package. Instead, refer to the package&#8217;s documentation for  installation instructions.
</div>
<div class="footnote" id="_footnotedef_8">
<a href="#_footnoteref_8">8</a>. If your cluster&#8217;s context is not <code>minikube</code>, replace <code>minikube</code> with the actual context name in the <span class="command"><code>skaffold config set</code></span> command.
</div>
<div class="footnote" id="_footnotedef_9">
<a href="#_footnoteref_9">9</a>. For the short term, follow the steps in the procedure to clone the <code>forgeops</code> repository and check out the <code>2020.10.28-AlSugoDiNoci</code> tag. For the long term, you&#8217;ll need to implement a strategy for managing updates, especially if a team of people in your organization works with the repository. For example, you might want to adopt a workflow that uses a fork as your organization&#8217;s common upstream repository. For more information, see <a href="forgeops.html" class="page">About the forgeops Repository</a>.
</div>
<div class="footnote" id="_footnotedef_10">
<a href="#_footnoteref_10">10</a>. Install Docker Desktop on macOS.  On Linux computers, install Docker CE instead.  For more information,  see <a href="https://www.docker.com/products/docker-desktop">the Docker documentation</a>.
</div>
<div class="footnote" id="_footnotedef_11">
<a href="#_footnoteref_11">11</a>. The Linux version of Homebrew does not support  installing software it maintains as casks. Because of this, if you&#8217;re  setting up an environment on Linux, you won&#8217;t be able to use Homebrew for  this package. Instead, refer to the package&#8217;s documentation for  installation instructions.
</div>
<div class="footnote" id="_footnotedef_12">
<a href="#_footnoteref_12">12</a>. For the short term, follow the steps in the procedure to clone the <code>forgeops</code> repository and check out the <code>2020.10.28-AlSugoDiNoci</code> tag. For the long term, you&#8217;ll need to implement a strategy for managing updates, especially if a team of people in your organization works with the repository. For example, you might want to adopt a workflow that uses a fork as your organization&#8217;s common upstream repository. For more information, see <a href="forgeops.html" class="page">About the forgeops Repository</a>.
</div>
<div class="footnote" id="_footnotedef_13">
<a href="#_footnoteref_13">13</a>. Install Docker Desktop on macOS.  On Linux computers, install Docker CE instead.  For more information,  see <a href="https://www.docker.com/products/docker-desktop">the Docker documentation</a>.
</div>
<div class="footnote" id="_footnotedef_14">
<a href="#_footnoteref_14">14</a>. The Linux version of Homebrew does not support  installing software it maintains as casks. Because of this, if you&#8217;re  setting up an environment on Linux, you won&#8217;t be able to use Homebrew for  this package. Instead, refer to the package&#8217;s documentation for  installation instructions.
</div>
<div class="footnote" id="_footnotedef_15">
<a href="#_footnoteref_15">15</a>. You can automate logging into ECR every 12 hours by using the <code>cron</code> utility.
</div>
<div class="footnote" id="_footnotedef_16">
<a href="#_footnoteref_16">16</a>. For the short term, follow the steps in the procedure to clone the <code>forgeops</code> repository and check out the <code>2020.10.28-AlSugoDiNoci</code> tag. For the long term, you&#8217;ll need to implement a strategy for managing updates, especially if a team of people in your organization works with the repository. For example, you might want to adopt a workflow that uses a fork as your organization&#8217;s common upstream repository. For more information, see <a href="forgeops.html" class="page">About the forgeops Repository</a>.
</div>
<div class="footnote" id="_footnotedef_17">
<a href="#_footnoteref_17">17</a>. Install Docker Desktop on macOS.  On Linux computers, install Docker CE instead.  For more information,  see <a href="https://www.docker.com/products/docker-desktop">the Docker documentation</a>.
</div>
<div class="footnote" id="_footnotedef_18">
<a href="#_footnoteref_18">18</a>. The Linux version of Homebrew does not support  installing software it maintains as casks. Because of this, if you&#8217;re  setting up an environment on Linux, you won&#8217;t be able to use Homebrew for  this package. Instead, refer to the package&#8217;s documentation for  installation instructions.
</div>
<div class="footnote" id="_footnotedef_19">
<a href="#_footnoteref_19">19</a>. Install Docker Desktop on macOS.  On Linux computers, install Docker CE instead.  For more information,  see <a href="https://www.docker.com/products/docker-desktop">the Docker documentation</a>.
</div>
<div class="footnote" id="_footnotedef_20">
<a href="#_footnoteref_20">20</a>. The Linux version of Homebrew does not support  installing software it maintains as casks. Because of this, if you&#8217;re  setting up an environment on Linux, you won&#8217;t be able to use Homebrew for  this package. Instead, refer to the package&#8217;s documentation for  installation instructions.
</div>
<div class="footnote" id="_footnotedef_21">
<a href="#_footnoteref_21">21</a>. For the short term, follow the steps in the procedure to clone the <code>forgeops</code> repository and check out the <code>2020.10.28-AlSugoDiNoci</code> tag. For the long term, you&#8217;ll need to implement a strategy for managing updates, especially if a team of people in your organization works with the repository. For example, you might want to adopt a workflow that uses a fork as your organization&#8217;s common upstream repository. For more information, see <a href="forgeops.html" class="page">About the forgeops Repository</a>.
</div>
<div class="footnote" id="_footnotedef_22">
<a href="#_footnoteref_22">22</a>. Install Docker Desktop on macOS.  On Linux computers, install Docker CE instead.  For more information,  see <a href="https://www.docker.com/products/docker-desktop">the Docker documentation</a>.
</div>
<div class="footnote" id="_footnotedef_23">
<a href="#_footnoteref_23">23</a>. The Linux version of Homebrew does not support  installing software it maintains as casks. Because of this, if you&#8217;re  setting up an environment on Linux, you won&#8217;t be able to use Homebrew for  this package. Instead, refer to the package&#8217;s documentation for  installation instructions.
</div>
<div class="footnote" id="_footnotedef_24">
<a href="#_footnoteref_24">24</a>. For the short term, follow the steps in the procedure to clone the <code>forgeops</code> repository and check out the <code>2020.10.28-AlSugoDiNoci</code> tag. For the long term, you&#8217;ll need to implement a strategy for managing updates, especially if a team of people in your organization works with the repository. For example, you might want to adopt a workflow that uses a fork as your organization&#8217;s common upstream repository. For more information, see <a href="forgeops.html" class="page">About the forgeops Repository</a>.
</div>
<div class="footnote" id="_footnotedef_25">
<a href="#_footnoteref_25">25</a>. You can automate logging into ECR every 12 hours by using the <span class="command"><code>cron</code></span> utility.
</div>
<div class="footnote" id="_footnotedef_26">
<a href="#_footnoteref_26">26</a>. Install Docker Desktop on macOS.  On Linux computers, install Docker CE instead.  For more information,  see <a href="https://www.docker.com/products/docker-desktop">the Docker documentation</a>.
</div>
<div class="footnote" id="_footnotedef_27">
<a href="#_footnoteref_27">27</a>. The Linux version of Homebrew does not support  installing software it maintains as casks. Because of this, if you&#8217;re  setting up an environment on Linux, you won&#8217;t be able to use Homebrew for  this package. Instead, refer to the package&#8217;s documentation for  installation instructions.
</div>
<div class="footnote" id="_footnotedef_28">
<a href="#_footnoteref_28">28</a>. For the short term, follow the steps in the procedure to clone the <code>forgeops</code> repository and check out the <code>2020.10.28-AlSugoDiNoci</code> tag. For the long term, you&#8217;ll need to implement a strategy for managing updates, especially if a team of people in your organization works with the repository. For example, you might want to adopt a workflow that uses a fork as your organization&#8217;s common upstream repository. For more information, see <a href="forgeops.html" class="page">About the forgeops Repository</a>.
</div>
<div class="footnote" id="_footnotedef_29">
<a href="#_footnoteref_29">29</a>. You can automate logging in to ACR by using the <span class="command"><code>cron</code></span> utility.
</div>
<div class="footnote" id="_footnotedef_30">
<a href="#_footnoteref_30">30</a>. The CDM and the CDK both use the CDK canonical configuration profile.
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
  <div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">ForgeOps</a></li>
    <li><a href="consolidated.html">ForgeOps Documentation</a></li>
  </ul>
</nav>
</div>
</main>
</div>
<backstage-site-footer></backstage-site-footer>
<script src="https://cdn.forgerock.com/docs-ui/adoc/dev/vendor.antora-scripts.js"></script>
<script src="https://cdn.forgerock.com/docs-ui/adoc/dev/forgerock.antora-scripts.js"></script>
  </body>
</html>
